
R version 2.15.3 (2013-03-01) -- "Security Blanket"
Copyright (C) 2013 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ####################################################
> # QUPR MODEL Autogenic x Competition x (Temp x Precip) :
> # Autogenic: Size/Age logistic scalar with Max potential growth for absolute values
> # Competition: Relative Size, Plot BA Scalars
> # Climate: 3-month means, prev Jun - current Nov
> #	-- Temp: Gaussian
> #	-- Precip: with flow Gaussian
> #
> ####################################################
> rm(list=ls())
> 
> data_directory <- "~/CARCA/Growth-Models/Seasonal/"
> #memory.size(4024)
> setwd(data_directory)
> library(likelihood)
Loading required package: nlme
> 
> # run.label <- "QUPR_Full_Season"
> # load(file=paste( run.label, "_Results.Rdata", sep=""))
> 
> run.label <- "QUPR_Full_Season"
> 
> #############
> # Reading in Test Data & some formating
> all.data <-read.csv("../RawInputs/CARCA_CoreData_Climate_Month_Wide.csv")
> all.data[,substr(names(all.data),1,4)=="Tavg"] <- all.data[,substr(names(all.data),1,4)=="Tavg"]+273.15
> all.data$BA.tree.cm2 <- all.data$BA.tree/100
> all.data$Site.Trans <- as.factor(substr(all.data$PlotID,1,4))
> summary(all.data)
      Year          PlotID           TreeID        Site       Trans     
 Min.   :1771   HNKC2  :  8505   BLDA101:   243   BLD:62694   A: 88452  
 1st Qu.:1831   FLTA1  :  7776   BLDA102:   243   FLT:49329   B: 93798  
 Median :1892   HIKA1  :  7290   BLDA103:   243   HIK:48357   C:106434  
 Mean   :1892   HNKB2  :  7290   BLDA104:   243   HNK:43983             
 3rd Qu.:1953   HNKA3  :  7047   BLDA105:   243   IRN:52245             
 Max.   :2013   BLDA2  :  6804   BLDA106:   243   MOR:32076             
                (Other):243972   (Other):287226                         
      Plot            BAI                 CoreID       Pith      
 Min.   :1.000   Min.   :    0.00   BLDA101HI:   243   N:211896  
 1st Qu.:1.000   1st Qu.:   84.36   BLDA102HI:   243   Y: 76788  
 Median :2.000   Median :  244.79   BLDA103HI:   243             
 Mean   :2.265   Mean   :  459.83   BLDA104HI:   243             
 3rd Qu.:3.000   3rd Qu.:  589.69   BLDA105HI:   243             
 Max.   :4.000   Max.   :18648.71   BLDA106HI:   243             
                 NA's   :202009     (Other)  :287226             
    Pith.Yr          Inner          Outer      Bark       Use       
 Min.   :1756    Min.   :1762   Min.   :1990   N:  6318   N:  4617  
 1st Qu.:1917    1st Qu.:1923   1st Qu.:2012   Y:282366   Y:284067  
 Median :1933    Median :1938   Median :2012                        
 Mean   :1936    Mean   :1939   Mean   :2012                        
 3rd Qu.:1953    3rd Qu.:1955   3rd Qu.:2012                        
 Max.   :2008    Max.   :2009   Max.   :2013                        
 NA's   :60021                                                      
                        Notes         Pith.offset         Tree      
 poor corr w/ master       :   972   Min.   : 0.00   Min.   : 1.00  
 poor correlation w/ master:   972   1st Qu.: 1.00   1st Qu.:10.00  
 1977 missing              :   486   Median : 2.00   Median :18.50  
 1986 missing              :   486   Mean   : 3.35   Mean   :20.86  
 1999 missing              :   486   3rd Qu.: 5.00   3rd Qu.:30.00  
 (Other)                   : 14094   Max.   :20.00   Max.   :84.00  
 NA's                      :271188   NA's   :60021                  
      Spp              Genus         Canopy         Live       
 ACRU   :71199   Quercus  :111294   C   :148230   DEAD:   243  
 QUPR   :50787   Acer     : 85779   D   :  8748   LIVE:288441  
 QURU   :43740   Nyssa    : 38880   I   : 86022                
 NYSY   :38880   Magnolia : 11421   U   : 45441                
 ACSA   :14580   Betula   :  8262   NA's:   243                
 MAAC   : 9720   Sassafras:  7776                              
 (Other):59778   (Other)  : 25272                              
      Age            BA.m2ha          BAI.filled          BA.tree      
 Min.   :  0.00   Min.   : 0.0000   Min.   :    0.00   Min.   :     0  
 1st Qu.: 19.00   1st Qu.: 0.0000   1st Qu.:    0.00   1st Qu.:     0  
 Median : 40.00   Median : 0.0000   Median :    0.00   Median :     0  
 Mean   : 44.55   Mean   : 0.1771   Mean   :  149.04   Mean   :  6106  
 3rd Qu.: 64.00   3rd Qu.: 0.0615   3rd Qu.:   74.84   3rd Qu.:  2007  
 Max.   :256.00   Max.   :11.8597   Max.   :18648.71   Max.   :462177  
 NA's   :195231   NA's   :1047      NA's   :985        NA's   :1047    
     Stems          Density.Ha     BAI.filled.plot      BA.plot       
 Min.   :0.0000   Min.   : 0.000   Min.   :    0.0   Min.   :    0.0  
 1st Qu.:0.0000   1st Qu.: 0.000   1st Qu.:    0.0   1st Qu.:    0.0  
 Median :0.0000   Median : 0.000   Median :  904.8   Median :  581.2  
 Mean   :0.3191   Mean   : 9.728   Mean   : 3899.5   Mean   : 2063.0  
 3rd Qu.:1.0000   3rd Qu.:31.831   3rd Qu.: 6247.5   3rd Qu.: 2866.9  
 Max.   :1.0000   Max.   :49.736   Max.   :38677.4   Max.   :23212.2  
                                   NA's   :1500      NA's   :1500     
  BA.m2ha.plot     Density.ha.plot     Stems.plot     BAI.m2ha.plot   
 Min.   : 0.0000   Min.   :   0.00   Min.   : 0.000   Min.   :0.0000  
 1st Qu.: 0.0000   1st Qu.:   0.00   1st Qu.: 0.000   1st Qu.:0.0000  
 Median : 0.0705   Median :  63.66   Median : 2.000   Median :0.0274  
 Mean   : 3.4704   Mean   : 268.53   Mean   : 8.898   Mean   :0.1135  
 3rd Qu.: 4.3534   3rd Qu.: 509.30   3rd Qu.:18.000   3rd Qu.:0.1935  
 Max.   :35.8804   Max.   :1432.39   Max.   :45.000   Max.   :1.0485  
 NA's   :1500      NA's   :1500      NA's   :1500     NA's   :1500    
 BA.m2ha.plot.live     RelBA          Site.Trans        Latitude     
 Min.   : 0.000    Min.   :0.00     BLDC   : 23814   Min.   :36.75   
 1st Qu.: 0.000    1st Qu.:0.05     IRNC   : 20898   1st Qu.:37.24   
 Median : 1.116    Median :0.17     HIKC   : 20169   Median :37.91   
 Mean   : 5.122    Mean   :0.30     BLDA   : 19926   Mean   :37.74   
 3rd Qu.: 6.584    3rd Qu.:0.46     BLDB   : 18954   3rd Qu.:38.32   
 Max.   :57.620    Max.   :1.00     IRNB   : 18711   Max.   :38.58   
 NA's   :985       NA's   :199115   (Other):166212   NA's   :154440  
   Longitude           elev             flow             TPI        
 Min.   :-81.31   Min.   : 666.9   Min.   :0.01     Min.   :-0.23   
 1st Qu.:-80.86   1st Qu.: 843.7   1st Qu.:0.01     1st Qu.:-0.10   
 Median :-79.85   Median : 952.4   Median :0.03     Median :-0.03   
 Mean   :-80.10   Mean   : 955.7   Mean   :0.12     Mean   : 0.01   
 3rd Qu.:-79.22   3rd Qu.:1098.3   3rd Qu.:0.06     3rd Qu.: 0.15   
 Max.   :-79.15   Max.   :1256.7   Max.   :1.42     Max.   : 0.30   
 NA's   :154440   NA's   :154440   NA's   :154440   NA's   :154440  
    Tavg.X01         Tavg.X02         Tavg.X03         Tavg.X04     
 Min.   :260.1    Min.   :262.9    Min.   :264.5    Min.   :274.6   
 1st Qu.:269.2    1st Qu.:270.3    1st Qu.:274.7    1st Qu.:280.5   
 Median :271.3    Median :272.4    Median :276.8    Median :282.4   
 Mean   :271.2    Mean   :272.2    Mean   :276.7    Mean   :282.2   
 3rd Qu.:273.2    3rd Qu.:274.2    3rd Qu.:278.8    3rd Qu.:284.0   
 Max.   :280.5    Max.   :278.5    Max.   :285.0    Max.   :287.7   
 NA's   :154440   NA's   :154440   NA's   :154440   NA's   :154440  
    Tavg.X05         Tavg.X06         Tavg.X07         Tavg.X08     
 Min.   :279.8    Min.   :284.9    Min.   :287.3    Min.   :285.8   
 1st Qu.:285.8    1st Qu.:290.0    1st Qu.:292.1    1st Qu.:291.3   
 Median :287.5    Median :291.4    Median :293.4    Median :292.7   
 Mean   :287.3    Mean   :291.1    Mean   :293.1    Mean   :292.5   
 3rd Qu.:289.0    3rd Qu.:292.5    3rd Qu.:294.3    3rd Qu.:293.8   
 Max.   :292.2    Max.   :296.2    Max.   :297.1    Max.   :297.3   
 NA's   :154440   NA's   :154440   NA's   :154440   NA's   :154440  
    Tavg.X09         Tavg.X10         Tavg.X11         Tavg.X12     
 Min.   :282.8    Min.   :276.6    Min.   :271.5    Min.   :263.8   
 1st Qu.:288.1    1st Qu.:282.2    1st Qu.:276.5    1st Qu.:271.3   
 Median :289.5    Median :283.7    Median :277.8    Median :273.1   
 Mean   :289.3    Mean   :283.5    Mean   :277.8    Mean   :273.0   
 3rd Qu.:290.7    3rd Qu.:285.0    3rd Qu.:279.1    3rd Qu.:274.8   
 Max.   :294.2    Max.   :288.6    Max.   :283.7    Max.   :279.9   
 NA's   :154440   NA's   :154440   NA's   :154440   NA's   :154440  
 Tavg.X01.prev    Tavg.X02.prev    Tavg.X03.prev    Tavg.X04.prev   
 Min.   :260.1    Min.   :262.9    Min.   :264.5    Min.   :274.6   
 1st Qu.:269.2    1st Qu.:270.3    1st Qu.:274.7    1st Qu.:280.5   
 Median :271.3    Median :272.4    Median :276.8    Median :282.4   
 Mean   :271.2    Mean   :272.1    Mean   :276.6    Mean   :282.2   
 3rd Qu.:273.2    3rd Qu.:274.2    3rd Qu.:278.7    3rd Qu.:284.0   
 Max.   :280.5    Max.   :278.5    Max.   :285.0    Max.   :287.7   
 NA's   :155628   NA's   :155628   NA's   :155628   NA's   :155628  
 Tavg.X05.prev    Tavg.X06.prev    Tavg.X07.prev    Tavg.X08.prev   
 Min.   :279.8    Min.   :284.9    Min.   :287.3    Min.   :285.8   
 1st Qu.:285.8    1st Qu.:290.0    1st Qu.:292.1    1st Qu.:291.3   
 Median :287.5    Median :291.4    Median :293.3    Median :292.7   
 Mean   :287.3    Mean   :291.1    Mean   :293.1    Mean   :292.5   
 3rd Qu.:288.9    3rd Qu.:292.5    3rd Qu.:294.2    3rd Qu.:293.8   
 Max.   :292.2    Max.   :296.2    Max.   :297.1    Max.   :297.3   
 NA's   :155628   NA's   :155628   NA's   :155628   NA's   :155628  
 Tavg.X09.prev    Tavg.X10.prev    Tavg.X11.prev    Tavg.X12.prev   
 Min.   :282.8    Min.   :276.6    Min.   :271.5    Min.   :263.8   
 1st Qu.:288.1    1st Qu.:282.2    1st Qu.:276.5    1st Qu.:271.2   
 Median :289.5    Median :283.7    Median :277.8    Median :273.1   
 Mean   :289.3    Mean   :283.5    Mean   :277.8    Mean   :272.9   
 3rd Qu.:290.7    3rd Qu.:285.0    3rd Qu.:279.1    3rd Qu.:274.8   
 Max.   :294.2    Max.   :288.6    Max.   :283.7    Max.   :279.9   
 NA's   :155628   NA's   :155628   NA's   :155628   NA's   :155628  
   Precip.X01       Precip.X02       Precip.X03       Precip.X04    
 Min.   :  9.06   Min.   :  7.21   Min.   :  0.15   Min.   : 14.74  
 1st Qu.: 56.47   1st Qu.: 49.54   1st Qu.: 70.19   1st Qu.: 61.82  
 Median : 77.95   Median : 71.53   Median : 95.96   Median : 87.82  
 Mean   : 83.89   Mean   : 75.98   Mean   : 99.47   Mean   : 91.25  
 3rd Qu.:102.79   3rd Qu.: 97.05   3rd Qu.:122.77   3rd Qu.:113.90  
 Max.   :276.20   Max.   :209.15   Max.   :272.97   Max.   :238.54  
 NA's   :154440   NA's   :154440   NA's   :154440   NA's   :154440  
   Precip.X05       Precip.X06       Precip.X07       Precip.X08    
 Min.   : 19.83   Min.   : 14.62   Min.   : 27.43   Min.   : 21.48  
 1st Qu.: 74.09   1st Qu.: 74.26   1st Qu.: 89.65   1st Qu.: 68.85  
 Median :104.65   Median :100.85   Median :112.71   Median : 95.89  
 Mean   :106.44   Mean   :107.63   Mean   :119.43   Mean   :105.77  
 3rd Qu.:135.01   3rd Qu.:131.03   3rd Qu.:142.94   3rd Qu.:129.40  
 Max.   :266.04   Max.   :296.69   Max.   :423.43   Max.   :421.09  
 NA's   :154440   NA's   :154440   NA's   :154440   NA's   :154440  
   Precip.X09       Precip.X10       Precip.X11       Precip.X12    
 Min.   :  2.37   Min.   :  1.06   Min.   :  9.25   Min.   :  2.49  
 1st Qu.: 52.19   1st Qu.: 44.08   1st Qu.: 45.03   1st Qu.: 56.20  
 Median : 79.54   Median : 73.11   Median : 71.98   Median : 75.57  
 Mean   : 90.54   Mean   : 82.99   Mean   : 76.45   Mean   : 82.37  
 3rd Qu.:117.18   3rd Qu.:114.42   3rd Qu.:100.25   3rd Qu.:103.91  
 Max.   :324.42   Max.   :319.10   Max.   :354.36   Max.   :252.11  
 NA's   :154440   NA's   :154440   NA's   :154440   NA's   :154440  
 Precip.X01.prev  Precip.X02.prev  Precip.X03.prev  Precip.X04.prev 
 Min.   :  9.06   Min.   :  7.21   Min.   :  0.15   Min.   : 14.74  
 1st Qu.: 56.43   1st Qu.: 49.65   1st Qu.: 70.01   1st Qu.: 62.00  
 Median : 77.95   Median : 71.83   Median : 95.76   Median : 87.89  
 Mean   : 83.96   Mean   : 76.17   Mean   : 99.26   Mean   : 91.32  
 3rd Qu.:103.33   3rd Qu.: 97.59   3rd Qu.:122.69   3rd Qu.:114.66  
 Max.   :276.20   Max.   :209.15   Max.   :272.97   Max.   :238.54  
 NA's   :155628   NA's   :155628   NA's   :155628   NA's   :155628  
 Precip.X05.prev  Precip.X06.prev  Precip.X07.prev  Precip.X08.prev 
 Min.   : 19.83   Min.   : 14.62   Min.   : 27.43   Min.   : 21.48  
 1st Qu.: 73.88   1st Qu.: 74.67   1st Qu.: 89.53   1st Qu.: 68.67  
 Median :104.37   Median :101.25   Median :112.71   Median : 95.82  
 Mean   :106.28   Mean   :108.04   Mean   :119.47   Mean   :105.70  
 3rd Qu.:134.94   3rd Qu.:131.58   3rd Qu.:143.14   3rd Qu.:129.38  
 Max.   :266.04   Max.   :296.69   Max.   :423.43   Max.   :421.09  
 NA's   :155628   NA's   :155628   NA's   :155628   NA's   :155628  
 Precip.X09.prev  Precip.X10.prev  Precip.X11.prev  Precip.X12.prev 
 Min.   :  2.37   Min.   :  1.06   Min.   :  9.25   Min.   :  2.49  
 1st Qu.: 51.94   1st Qu.: 43.92   1st Qu.: 45.68   1st Qu.: 56.30  
 Median : 79.03   Median : 73.60   Median : 72.17   Median : 76.78  
 Mean   : 90.18   Mean   : 83.27   Mean   : 76.91   Mean   : 82.60  
 3rd Qu.:115.57   3rd Qu.:114.60   3rd Qu.:100.41   3rd Qu.:104.91  
 Max.   :324.42   Max.   :319.10   Max.   :354.36   Max.   :252.11  
 NA's   :155628   NA's   :155628   NA's   :155628   NA's   :155628  
  BA.tree.cm2     
 Min.   :   0.00  
 1st Qu.:   0.00  
 Median :   0.00  
 Mean   :  61.06  
 3rd Qu.:  20.07  
 Max.   :4621.77  
 NA's   :1047     
> dim(all.data)
[1] 288684     90
> 
> #############
> # Subsetting just QUPR data
> qupr.all <- all.data[all.data$Spp=="QUPR", ]
> summary(qupr.all)
      Year          PlotID          TreeID       Site       Trans    
 Min.   :1771   MORA2  : 3159   BLDA303:  243   BLD: 9963   A:10692  
 1st Qu.:1831   BLDC4  : 2916   BLDA335:  243   FLT:11178   B:20169  
 Median :1892   FLTB4  : 2430   BLDA337:  243   HIK: 1215   C:19926  
 Mean   :1892   MORC1  : 2187   BLDA424:  243   HNK: 8019            
 3rd Qu.:1953   FLTC2  : 1944   BLDA430:  243   IRN: 8505            
 Max.   :2013   HNKA1  : 1944   BLDB136:  243   MOR:11907            
                (Other):36207   (Other):49329                        
      Plot            BAI                CoreID      Pith         Pith.Yr     
 Min.   :1.000   Min.   :    3.4   BLDA303HI:  243   N:43740   Min.   :1756   
 1st Qu.:1.000   1st Qu.:  241.2   BLDA335HI:  243   Y: 7047   1st Qu.:1910   
 Median :2.000   Median :  454.2   BLDA337HI:  243             Median :1926   
 Mean   :2.177   Mean   :  639.6   BLDA424HI:  243             Mean   :1919   
 3rd Qu.:3.000   3rd Qu.:  825.7   BLDA430HI:  243             3rd Qu.:1933   
 Max.   :4.000   Max.   :18648.7   BLDB136HI:  243             Max.   :1961   
                 NA's   :32590     (Other)  :49329             NA's   :10935  
     Inner          Outer      Bark      Use      
 Min.   :1762   Min.   :2009   N:  729   N:  486  
 1st Qu.:1914   1st Qu.:2012   Y:50058   Y:50301  
 Median :1933   Median :2012                      
 Mean   :1925   Mean   :2012                      
 3rd Qu.:1942   3rd Qu.:2012                      
 Max.   :1976   Max.   :2013                      
                                                  
                               Notes        Pith.offset          Tree      
 poor correlation w/ master       :  486   Min.   : 0.000   Min.   : 1.00  
 2009/2010 tiny                   :  243   1st Qu.: 2.000   1st Qu.:12.00  
 B side is clearer in supression  :  243   Median : 3.000   Median :21.00  
 actually lower; this one measured:  243   Mean   : 4.482   Mean   :22.71  
 break at 1927                    :  243   3rd Qu.: 6.000   3rd Qu.:34.00  
 (Other)                          : 1215   Max.   :20.000   Max.   :65.00  
 NA's                             :48114   NA's   :10935                   
      Spp             Genus        Canopy        Live            Age       
 QUPR   :50787   Quercus :50787   C   :37422   DEAD:    0   Min.   :  0.0  
 ACRU   :    0   Acer    :    0   D   : 3645   LIVE:50787   1st Qu.: 24.0  
 ACSA   :    0   Betula  :    0   I   : 7776                Median : 48.0  
 BELE   :    0   Carya   :    0   U   : 1701                Mean   : 53.1  
 BEPA   :    0   Castanea:    0   NA's:  243                3rd Qu.: 73.0  
 CADE   :    0   Cornus  :    0                             Max.   :256.0  
 (Other):    0   (Other) :    0                             NA's   :30765  
    BA.m2ha          BAI.filled         BA.tree           Stems      
 Min.   : 0.0000   Min.   :    0.0   Min.   :     0   Min.   :0.000  
 1st Qu.: 0.0000   1st Qu.:    0.0   1st Qu.:     0   1st Qu.:0.000  
 Median : 0.0000   Median :    0.0   Median :     0   Median :0.000  
 Mean   : 0.3782   Mean   :  252.8   Mean   : 12156   Mean   :0.392  
 3rd Qu.: 0.3774   3rd Qu.:  335.1   3rd Qu.: 12000   3rd Qu.:1.000  
 Max.   :11.8597   Max.   :18648.7   Max.   :372594   Max.   :1.000  
 NA's   :188       NA's   :163       NA's   :188                     
   Density.Ha    BAI.filled.plot      BA.plot         BA.m2ha.plot   
 Min.   : 0.00   Min.   :    0.0   Min.   :    0.0   Min.   : 0.000  
 1st Qu.: 0.00   1st Qu.:    0.0   1st Qu.:    0.0   1st Qu.: 0.000  
 Median : 0.00   Median :  933.5   Median :  596.5   Median : 0.102  
 Mean   :12.35   Mean   : 3632.0   Mean   : 1923.5   Mean   : 3.704  
 3rd Qu.:31.83   3rd Qu.: 6467.8   3rd Qu.: 2833.2   3rd Qu.: 5.088  
 Max.   :49.74   Max.   :38677.4   Max.   :23212.2   Max.   :35.880  
                 NA's   :420       NA's   :420       NA's   :420     
 Density.ha.plot     Stems.plot    BAI.m2ha.plot    BA.m2ha.plot.live
 Min.   :   0.00   Min.   : 0.00   Min.   :0.0000   Min.   : 0.0000  
 1st Qu.:   0.00   1st Qu.: 0.00   1st Qu.:0.0000   1st Qu.: 0.2116  
 Median :  63.66   Median : 2.00   Median :0.0299   Median : 1.4892  
 Mean   : 267.98   Mean   : 8.57   Mean   :0.1118   Mean   : 5.3008  
 3rd Qu.: 523.44   3rd Qu.:17.00   3rd Qu.:0.2056   3rd Qu.: 7.3824  
 Max.   :1432.39   Max.   :45.00   Max.   :0.8590   Max.   :46.2800  
 NA's   :420       NA's   :420     NA's   :420      NA's   :163      
     RelBA         Site.Trans       Latitude       Longitude     
 Min.   :0.000   BLDC   : 5589   Min.   :36.76   Min.   :-81.31  
 1st Qu.:0.178   FLTB   : 5346   1st Qu.:37.24   1st Qu.:-80.86  
 Median :0.412   IRNB   : 4860   Median :37.72   Median :-80.11  
 Mean   :0.484   MORA   : 4617   Mean   :37.61   Mean   :-80.26  
 3rd Qu.:0.788   FLTC   : 4131   3rd Qu.:37.92   3rd Qu.:-79.84  
 Max.   :1.000   MORC   : 3888   Max.   :38.57   Max.   :-79.15  
 NA's   :31181   (Other):22356   NA's   :27170   NA's   :27170   
      elev             flow            TPI            Tavg.X01    
 Min.   : 666.9   Min.   :0.006   Min.   :-0.234   Min.   :260.1  
 1st Qu.: 843.7   1st Qu.:0.013   1st Qu.:-0.097   1st Qu.:269.0  
 Median : 885.9   Median :0.034   Median :-0.053   Median :271.1  
 Mean   : 915.6   Mean   :0.133   Mean   :-0.015   Mean   :271.0  
 3rd Qu.:1005.1   3rd Qu.:0.064   3rd Qu.: 0.070   3rd Qu.:273.1  
 Max.   :1173.5   Max.   :1.419   Max.   : 0.300   Max.   :280.5  
 NA's   :27170    NA's   :27170   NA's   :27170    NA's   :27170  
    Tavg.X02        Tavg.X03        Tavg.X04        Tavg.X05    
 Min.   :262.9   Min.   :264.5   Min.   :274.6   Min.   :279.8  
 1st Qu.:270.1   1st Qu.:274.4   1st Qu.:280.3   1st Qu.:285.7  
 Median :272.3   Median :276.6   Median :282.3   Median :287.5  
 Mean   :272.0   Mean   :276.5   Mean   :282.2   Mean   :287.3  
 3rd Qu.:274.1   3rd Qu.:278.7   3rd Qu.:284.0   3rd Qu.:289.0  
 Max.   :278.3   Max.   :285.0   Max.   :287.7   Max.   :292.2  
 NA's   :27170   NA's   :27170   NA's   :27170   NA's   :27170  
    Tavg.X06        Tavg.X07        Tavg.X08        Tavg.X09    
 Min.   :285.0   Min.   :287.3   Min.   :285.8   Min.   :282.8  
 1st Qu.:290.0   1st Qu.:292.2   1st Qu.:291.3   1st Qu.:287.9  
 Median :291.3   Median :293.4   Median :292.8   Median :289.5  
 Mean   :291.2   Mean   :293.2   Mean   :292.5   Mean   :289.3  
 3rd Qu.:292.6   3rd Qu.:294.4   3rd Qu.:293.9   3rd Qu.:290.8  
 Max.   :296.2   Max.   :297.1   Max.   :297.3   Max.   :294.2  
 NA's   :27170   NA's   :27170   NA's   :27170   NA's   :27170  
    Tavg.X10        Tavg.X11        Tavg.X12     Tavg.X01.prev  
 Min.   :276.7   Min.   :271.5   Min.   :263.8   Min.   :260.1  
 1st Qu.:282.1   1st Qu.:276.4   1st Qu.:271.2   1st Qu.:269.0  
 Median :283.6   Median :277.7   Median :273.0   Median :271.1  
 Mean   :283.5   Mean   :277.7   Mean   :272.9   Mean   :271.0  
 3rd Qu.:284.9   3rd Qu.:279.1   3rd Qu.:274.7   3rd Qu.:273.1  
 Max.   :288.6   Max.   :283.6   Max.   :279.9   Max.   :280.5  
 NA's   :27170   NA's   :27170   NA's   :27170   NA's   :27379  
 Tavg.X02.prev   Tavg.X03.prev   Tavg.X04.prev   Tavg.X05.prev  
 Min.   :262.9   Min.   :264.5   Min.   :274.6   Min.   :279.8  
 1st Qu.:270.1   1st Qu.:274.4   1st Qu.:280.3   1st Qu.:285.7  
 Median :272.2   Median :276.6   Median :282.3   Median :287.5  
 Mean   :272.0   Mean   :276.5   Mean   :282.1   Mean   :287.3  
 3rd Qu.:274.1   3rd Qu.:278.6   3rd Qu.:284.0   3rd Qu.:289.0  
 Max.   :278.3   Max.   :285.0   Max.   :287.7   Max.   :292.2  
 NA's   :27379   NA's   :27379   NA's   :27379   NA's   :27379  
 Tavg.X06.prev   Tavg.X07.prev   Tavg.X08.prev   Tavg.X09.prev  
 Min.   :285.0   Min.   :287.3   Min.   :285.8   Min.   :282.8  
 1st Qu.:290.0   1st Qu.:292.1   1st Qu.:291.3   1st Qu.:288.0  
 Median :291.3   Median :293.4   Median :292.8   Median :289.5  
 Mean   :291.2   Mean   :293.1   Mean   :292.5   Mean   :289.3  
 3rd Qu.:292.6   3rd Qu.:294.4   3rd Qu.:293.9   3rd Qu.:290.8  
 Max.   :296.2   Max.   :297.1   Max.   :297.3   Max.   :294.2  
 NA's   :27379   NA's   :27379   NA's   :27379   NA's   :27379  
 Tavg.X10.prev   Tavg.X11.prev   Tavg.X12.prev     Precip.X01    
 Min.   :276.7   Min.   :271.5   Min.   :263.8   Min.   :  9.06  
 1st Qu.:282.1   1st Qu.:276.5   1st Qu.:271.1   1st Qu.: 56.47  
 Median :283.6   Median :277.8   Median :273.0   Median : 79.12  
 Mean   :283.5   Mean   :277.7   Mean   :272.8   Mean   : 84.41  
 3rd Qu.:285.0   3rd Qu.:279.1   3rd Qu.:274.6   3rd Qu.:103.36  
 Max.   :288.6   Max.   :283.6   Max.   :279.9   Max.   :276.20  
 NA's   :27379   NA's   :27379   NA's   :27379   NA's   :27170   
   Precip.X02       Precip.X03        Precip.X04       Precip.X05    
 Min.   :  7.21   Min.   :  0.154   Min.   : 14.74   Min.   : 19.83  
 1st Qu.: 50.22   1st Qu.: 71.090   1st Qu.: 64.25   1st Qu.: 73.21  
 Median : 72.76   Median : 97.300   Median : 88.11   Median :104.83  
 Mean   : 76.92   Mean   :100.305   Mean   : 91.64   Mean   :106.43  
 3rd Qu.: 99.08   3rd Qu.:124.960   3rd Qu.:114.79   3rd Qu.:136.47  
 Max.   :209.15   Max.   :272.970   Max.   :238.54   Max.   :266.04  
 NA's   :27170    NA's   :27170     NA's   :27170    NA's   :27170   
   Precip.X06       Precip.X07       Precip.X08       Precip.X09    
 Min.   : 14.62   Min.   : 27.43   Min.   : 21.48   Min.   :  2.37  
 1st Qu.: 73.00   1st Qu.: 91.51   1st Qu.: 68.42   1st Qu.: 52.48  
 Median :100.31   Median :113.70   Median : 95.23   Median : 81.32  
 Mean   :106.91   Mean   :119.59   Mean   :105.29   Mean   : 90.46  
 3rd Qu.:130.46   3rd Qu.:142.55   3rd Qu.:128.99   3rd Qu.:116.27  
 Max.   :296.69   Max.   :423.43   Max.   :421.09   Max.   :324.42  
 NA's   :27170    NA's   :27170    NA's   :27170    NA's   :27170   
   Precip.X10       Precip.X11       Precip.X12     Precip.X01.prev 
 Min.   :  1.06   Min.   :  9.25   Min.   :  2.49   Min.   :  9.06  
 1st Qu.: 44.81   1st Qu.: 46.56   1st Qu.: 56.53   1st Qu.: 56.46  
 Median : 73.60   Median : 71.69   Median : 76.31   Median : 79.58  
 Mean   : 83.25   Mean   : 76.90   Mean   : 82.73   Mean   : 84.49  
 3rd Qu.:113.92   3rd Qu.:100.72   3rd Qu.:105.80   3rd Qu.:103.41  
 Max.   :319.10   Max.   :354.36   Max.   :252.11   Max.   :276.20  
 NA's   :27170    NA's   :27170    NA's   :27170    NA's   :27379   
 Precip.X02.prev  Precip.X03.prev   Precip.X04.prev  Precip.X05.prev 
 Min.   :  7.21   Min.   :  0.154   Min.   : 14.74   Min.   : 19.83  
 1st Qu.: 50.50   1st Qu.: 70.930   1st Qu.: 64.25   1st Qu.: 73.14  
 Median : 73.21   Median : 96.525   Median : 87.93   Median :103.04  
 Mean   : 77.10   Mean   :100.069   Mean   : 91.67   Mean   :106.21  
 3rd Qu.: 99.27   3rd Qu.:124.540   3rd Qu.:114.80   3rd Qu.:136.47  
 Max.   :209.15   Max.   :272.970   Max.   :238.54   Max.   :266.04  
 NA's   :27379    NA's   :27379     NA's   :27379    NA's   :27379   
 Precip.X06.prev  Precip.X07.prev  Precip.X08.prev  Precip.X09.prev 
 Min.   : 14.62   Min.   : 27.43   Min.   : 21.48   Min.   :  2.37  
 1st Qu.: 73.33   1st Qu.: 91.51   1st Qu.: 68.36   1st Qu.: 52.41  
 Median :100.85   Median :113.77   Median : 94.93   Median : 81.13  
 Mean   :107.32   Mean   :119.68   Mean   :105.29   Mean   : 90.12  
 3rd Qu.:130.67   3rd Qu.:142.84   3rd Qu.:128.75   3rd Qu.:114.96  
 Max.   :296.69   Max.   :423.43   Max.   :421.09   Max.   :324.42  
 NA's   :27379    NA's   :27379    NA's   :27379    NA's   :27379   
 Precip.X10.prev  Precip.X11.prev  Precip.X12.prev   BA.tree.cm2    
 Min.   :  1.06   Min.   :  9.25   Min.   :  2.49   Min.   :   0.0  
 1st Qu.: 44.81   1st Qu.: 47.43   1st Qu.: 56.41   1st Qu.:   0.0  
 Median : 73.89   Median : 72.17   Median : 76.95   Median :   0.0  
 Mean   : 83.54   Mean   : 77.37   Mean   : 82.93   Mean   : 121.6  
 3rd Qu.:114.42   3rd Qu.:100.84   3rd Qu.:105.83   3rd Qu.: 120.0  
 Max.   :319.10   Max.   :354.36   Max.   :252.11   Max.   :3725.9  
 NA's   :27379    NA's   :27379    NA's   :27379    NA's   :188     
> dim(qupr.all)
[1] 50787    90
> 
> # Subsetting only complete cases & a small range of years
> qupr.run <- qupr.all[complete.cases(qupr.all) & qupr.all$Year>=1990 & qupr.all$Year<=2011,]
> summary(qupr.run)
      Year          PlotID       TreeID    Site    Trans       Plot      
 Min.   :1990   MORB2  :44   BLDB237:22   BLD:41   A:44   Min.   :1.000  
 1st Qu.:1995   BLDB2  :22   HNKA113:22   FLT: 0   B:88   1st Qu.:1.000  
 Median :2000   HNKA1  :22   IRNB131:22   HIK: 0   C:41   Median :1.000  
 Mean   :2000   IRNB1  :22   IRNC125:22   HNK:22          Mean   :1.711  
 3rd Qu.:2006   IRNC1  :22   MORA118:22   IRN:44          3rd Qu.:2.000  
 Max.   :2011   MORA1  :22   MORB206:22   MOR:66          Max.   :4.000  
                (Other):19   (Other):41                                  
      BAI                CoreID   Pith       Pith.Yr         Inner     
 Min.   :  17.23   BLDB237HI:22   N:129   Min.   :1845   Min.   :1865  
 1st Qu.:  65.44   HNKA113HI:22   Y: 44   1st Qu.:1908   1st Qu.:1911  
 Median : 282.27   IRNB131HI:22           Median :1910   Median :1912  
 Mean   : 636.26   IRNC125HI:22           Mean   :1915   Mean   :1920  
 3rd Qu.:1103.34   MORA118HI:22           3rd Qu.:1953   3rd Qu.:1954  
 Max.   :2904.04   MORB206HI:22           Max.   :1955   Max.   :1958  
                   (Other)  :41                                        
     Outer      Bark    Use                                   Notes   
 Min.   :2009   N:  0   N: 44   poor correlation w/ master       :44  
 1st Qu.:2012   Y:173   Y:129   B side is clearer in supression  :22  
 Median :2012                   actually lower; this one measured:22  
 Mean   :2012                   break at 1927                    :22  
 3rd Qu.:2012                   false rings (2) in 1953          :22  
 Max.   :2012                   lots of error on pith est        :22  
                                (Other)                          :19  
  Pith.offset          Tree            Spp           Genus     Canopy
 Min.   : 1.000   Min.   : 6.00   QUPR   :173   Quercus :173   C:88  
 1st Qu.: 1.000   1st Qu.:13.00   ACRU   :  0   Acer    :  0   D:22  
 Median : 3.000   Median :18.00   ACSA   :  0   Betula  :  0   I:19  
 Mean   : 4.543   Mean   :22.38   BELE   :  0   Carya   :  0   U:44  
 3rd Qu.: 4.000   3rd Qu.:31.00   BEPA   :  0   Castanea:  0         
 Max.   :20.000   Max.   :37.00   CADE   :  0   Cornus  :  0         
                                  (Other):  0   (Other) :  0         
   Live          Age            BA.m2ha          BAI.filled     
 DEAD:  0   Min.   : 35.00   Min.   :0.07544   Min.   :  17.23  
 LIVE:173   1st Qu.: 58.00   1st Qu.:0.17669   1st Qu.:  65.44  
            Median : 86.00   Median :0.41480   Median : 282.27  
            Mean   : 85.12   Mean   :1.15313   Mean   : 636.26  
            3rd Qu.: 96.00   3rd Qu.:1.90412   3rd Qu.:1103.34  
            Max.   :166.00   Max.   :4.58842   Max.   :2904.04  
                                                                
    BA.tree           Stems     Density.Ha    BAI.filled.plot    BA.plot     
 Min.   :  2370   Min.   :1   Min.   :31.83   Min.   : 5584   Min.   : 4765  
 1st Qu.:  5551   1st Qu.:1   1st Qu.:31.83   1st Qu.: 8354   1st Qu.: 6852  
 Median : 13032   Median :1   Median :31.83   Median :10503   Median : 8343  
 Mean   : 36228   Mean   :1   Mean   :31.83   Mean   :11885   Mean   : 8739  
 3rd Qu.: 59822   3rd Qu.:1   3rd Qu.:31.83   3rd Qu.:15071   3rd Qu.: 9955  
 Max.   :144154   Max.   :1   Max.   :31.83   Max.   :26987   Max.   :16266  
                                                                             
  BA.m2ha.plot    Density.ha.plot    Stems.plot    BAI.m2ha.plot   
 Min.   : 7.755   Min.   : 509.3   Min.   :16.00   Min.   :0.1777  
 1st Qu.:10.746   1st Qu.: 732.1   1st Qu.:23.00   1st Qu.:0.2659  
 Median :16.464   Median : 795.8   Median :25.00   Median :0.3343  
 Mean   :16.640   Mean   : 904.9   Mean   :28.43   Mean   :0.3783  
 3rd Qu.:21.215   3rd Qu.:1145.9   3rd Qu.:36.00   3rd Qu.:0.4797  
 Max.   :30.972   Max.   :1336.9   Max.   :42.00   Max.   :0.8590  
                                                                   
 BA.m2ha.plot.live     RelBA           Site.Trans    Latitude    
 Min.   :14.51     Min.   :0.01094   MORB   :44   Min.   :36.76  
 1st Qu.:17.86     1st Qu.:0.06445   BLDB   :22   1st Qu.:36.76  
 Median :21.79     Median :0.17326   HNKA   :22   Median :37.72  
 Mean   :23.04     Mean   :0.34755   IRNB   :22   Mean   :37.60  
 3rd Qu.:28.01     3rd Qu.:0.71314   IRNC   :22   3rd Qu.:37.92  
 Max.   :35.43     Max.   :1.00000   MORA   :22   Max.   :38.32  
                                     (Other):19                  
   Longitude           elev             flow               TPI          
 Min.   :-81.31   Min.   : 744.2   Min.   :0.007794   Min.   :-0.19670  
 1st Qu.:-81.31   1st Qu.: 744.2   1st Qu.:0.008083   1st Qu.:-0.11032  
 Median :-80.11   Median : 941.8   Median :0.034883   Median :-0.09616  
 Mean   :-80.24   Mean   : 911.8   Mean   :0.081560   Mean   :-0.03782  
 3rd Qu.:-79.84   3rd Qu.:1000.5   3rd Qu.:0.224870   3rd Qu.: 0.18194  
 Max.   :-79.24   Max.   :1114.8   Max.   :0.224870   Max.   : 0.19766  
                                                                        
    Tavg.X01        Tavg.X02        Tavg.X03        Tavg.X04    
 Min.   :263.8   Min.   :264.6   Min.   :269.1   Min.   :275.9  
 1st Qu.:268.6   1st Qu.:270.2   1st Qu.:273.6   1st Qu.:280.0  
 Median :270.8   Median :272.1   Median :275.4   Median :281.4  
 Mean   :270.7   Mean   :271.9   Mean   :275.6   Mean   :281.5  
 3rd Qu.:273.0   3rd Qu.:273.9   3rd Qu.:277.6   3rd Qu.:283.2  
 Max.   :276.3   Max.   :277.7   Max.   :281.1   Max.   :286.2  
                                                                
    Tavg.X05        Tavg.X06        Tavg.X07        Tavg.X08    
 Min.   :280.6   Min.   :286.2   Min.   :287.9   Min.   :287.8  
 1st Qu.:284.7   1st Qu.:289.8   1st Qu.:291.5   1st Qu.:290.9  
 Median :286.2   Median :290.7   Median :292.7   Median :292.3  
 Mean   :286.3   Mean   :290.6   Mean   :292.6   Mean   :292.1  
 3rd Qu.:287.8   3rd Qu.:291.7   3rd Qu.:293.9   3rd Qu.:293.2  
 Max.   :291.6   Max.   :294.3   Max.   :295.9   Max.   :295.7  
                                                                
    Tavg.X09        Tavg.X10        Tavg.X11        Tavg.X12    
 Min.   :284.4   Min.   :278.8   Min.   :272.3   Min.   :265.4  
 1st Qu.:287.4   1st Qu.:281.2   1st Qu.:276.1   1st Qu.:271.2  
 Median :288.3   Median :282.6   Median :277.7   Median :273.1  
 Mean   :288.5   Mean   :282.7   Mean   :277.6   Mean   :272.9  
 3rd Qu.:289.7   3rd Qu.:283.8   3rd Qu.:279.1   3rd Qu.:274.8  
 Max.   :292.7   Max.   :287.8   Max.   :281.8   Max.   :277.3  
                                                                
 Tavg.X01.prev   Tavg.X02.prev   Tavg.X03.prev   Tavg.X04.prev  
 Min.   :263.8   Min.   :264.6   Min.   :269.1   Min.   :275.9  
 1st Qu.:268.9   1st Qu.:269.9   1st Qu.:273.6   1st Qu.:279.9  
 Median :271.0   Median :272.1   Median :275.4   Median :281.2  
 Mean   :270.9   Mean   :271.9   Mean   :275.6   Mean   :281.4  
 3rd Qu.:273.1   3rd Qu.:273.9   3rd Qu.:277.7   3rd Qu.:282.9  
 Max.   :276.3   Max.   :277.7   Max.   :281.1   Max.   :286.2  
                                                                
 Tavg.X05.prev   Tavg.X06.prev   Tavg.X07.prev   Tavg.X08.prev  
 Min.   :280.6   Min.   :286.2   Min.   :287.9   Min.   :287.8  
 1st Qu.:284.4   1st Qu.:289.8   1st Qu.:291.5   1st Qu.:290.9  
 Median :286.0   Median :290.7   Median :292.6   Median :292.2  
 Mean   :286.1   Mean   :290.6   Mean   :292.5   Mean   :292.1  
 3rd Qu.:287.7   3rd Qu.:291.7   3rd Qu.:293.8   3rd Qu.:293.2  
 Max.   :291.6   Max.   :294.3   Max.   :295.9   Max.   :295.7  
                                                                
 Tavg.X09.prev   Tavg.X10.prev   Tavg.X11.prev   Tavg.X12.prev  
 Min.   :284.4   Min.   :278.8   Min.   :272.3   Min.   :263.8  
 1st Qu.:287.4   1st Qu.:281.3   1st Qu.:275.9   1st Qu.:270.6  
 Median :288.3   Median :282.6   Median :277.6   Median :272.8  
 Mean   :288.4   Mean   :282.7   Mean   :277.5   Mean   :272.4  
 3rd Qu.:289.7   3rd Qu.:283.9   3rd Qu.:278.9   3rd Qu.:274.7  
 Max.   :292.7   Max.   :287.8   Max.   :281.8   Max.   :277.3  
                                                                
   Precip.X01       Precip.X02       Precip.X03       Precip.X04    
 Min.   : 22.78   Min.   : 16.16   Min.   : 27.81   Min.   : 22.65  
 1st Qu.: 57.40   1st Qu.: 45.91   1st Qu.: 85.79   1st Qu.: 68.67  
 Median : 80.78   Median : 66.78   Median :105.28   Median : 98.98  
 Mean   : 91.22   Mean   : 72.78   Mean   :109.75   Mean   : 97.07  
 3rd Qu.:105.25   3rd Qu.: 95.29   3rd Qu.:128.03   3rd Qu.:121.63  
 Max.   :276.20   Max.   :170.66   Max.   :210.02   Max.   :202.21  
                                                                    
   Precip.X05      Precip.X06       Precip.X07       Precip.X08    
 Min.   : 32.4   Min.   : 25.00   Min.   : 35.88   Min.   : 32.19  
 1st Qu.: 76.4   1st Qu.: 66.31   1st Qu.: 84.78   1st Qu.: 68.21  
 Median :105.0   Median : 95.81   Median :107.55   Median : 87.18  
 Mean   :115.0   Mean   :106.79   Mean   :114.82   Mean   : 89.38  
 3rd Qu.:153.2   3rd Qu.:121.81   3rd Qu.:139.12   3rd Qu.:108.90  
 Max.   :219.1   Max.   :291.28   Max.   :292.53   Max.   :208.60  
                                                                   
   Precip.X09       Precip.X10       Precip.X11       Precip.X12    
 Min.   :  4.60   Min.   :  2.42   Min.   : 10.18   Min.   : 34.97  
 1st Qu.: 61.18   1st Qu.: 46.06   1st Qu.: 52.82   1st Qu.: 61.03  
 Median : 85.80   Median : 57.70   Median : 86.36   Median : 82.47  
 Mean   :102.68   Mean   : 76.63   Mean   : 85.24   Mean   : 87.29  
 3rd Qu.:130.12   3rd Qu.:105.44   3rd Qu.:117.29   3rd Qu.:105.92  
 Max.   :294.62   Max.   :302.71   Max.   :206.61   Max.   :180.88  
                                                                    
 Precip.X01.prev  Precip.X02.prev  Precip.X03.prev  Precip.X04.prev 
 Min.   : 33.62   Min.   : 16.16   Min.   : 27.81   Min.   : 22.65  
 1st Qu.: 58.82   1st Qu.: 48.91   1st Qu.: 79.52   1st Qu.: 68.67  
 Median : 80.78   Median : 68.41   Median :104.33   Median : 98.33  
 Mean   : 92.83   Mean   : 74.30   Mean   :107.08   Mean   : 94.60  
 3rd Qu.:105.25   3rd Qu.: 96.34   3rd Qu.:119.60   3rd Qu.:116.94  
 Max.   :276.20   Max.   :170.66   Max.   :210.02   Max.   :202.21  
                                                                    
 Precip.X05.prev Precip.X06.prev  Precip.X07.prev  Precip.X08.prev 
 Min.   : 32.4   Min.   : 25.00   Min.   : 35.88   Min.   : 32.19  
 1st Qu.: 76.4   1st Qu.: 68.95   1st Qu.: 85.32   1st Qu.: 69.81  
 Median :105.6   Median :103.66   Median :120.10   Median : 89.15  
 Mean   :115.6   Mean   :112.11   Mean   :119.16   Mean   : 92.29  
 3rd Qu.:153.2   3rd Qu.:131.62   3rd Qu.:144.01   3rd Qu.:110.73  
 Max.   :219.1   Max.   :291.28   Max.   :292.53   Max.   :208.60  
                                                                   
 Precip.X09.prev  Precip.X10.prev  Precip.X11.prev  Precip.X12.prev 
 Min.   :  4.60   Min.   :  2.42   Min.   : 10.18   Min.   : 34.97  
 1st Qu.: 61.18   1st Qu.: 46.06   1st Qu.: 52.82   1st Qu.: 60.06  
 Median : 87.49   Median : 57.70   Median : 84.36   Median : 78.46  
 Mean   :106.49   Mean   : 78.30   Mean   : 84.38   Mean   : 84.93  
 3rd Qu.:136.02   3rd Qu.:110.45   3rd Qu.:107.90   3rd Qu.:103.91  
 Max.   :294.62   Max.   :302.71   Max.   :206.61   Max.   :180.88  
                                                                    
  BA.tree.cm2     
 Min.   :  23.70  
 1st Qu.:  55.51  
 Median : 130.32  
 Mean   : 362.28  
 3rd Qu.: 598.22  
 Max.   :1441.54  
                  
> dim(qupr.run)
[1] 173  90
> 
> #############
> # Vector with names of Months of the year
> months <- c("X01", "X02", "X03", "X04", "X05", "X06", "X07", "X08", "X09", "X10", "X11", "X12")
> 
> # Selecting which previous and current year months to include in model
> months.prev <- paste(months[6:12], "prev", sep=".") # Previous June through December
> months.curr <- paste(months[1:10], sep=".") # Current Junuary through October
> months.use <- c(months.prev, months.curr)
> 
> seasons <- c("pX06.pX08", "pX09.pX11", "pX12.X02", "X03.X05", "X06.X08", "X09.X11")
> seasons
[1] "pX06.pX08" "pX09.pX11" "pX12.X02"  "X03.X05"   "X06.X08"   "X09.X11"  
> 
> qupr.run$Tavg.pX06.pX08 <- rowMeans(qupr.run[,c("Tavg.X06.prev", "Tavg.X07.prev", "Tavg.X08.prev")])
> qupr.run$Tavg.pX09.pX11 <- rowMeans(qupr.run[,c("Tavg.X09.prev", "Tavg.X10.prev", "Tavg.X11.prev")])
> qupr.run$Tavg.pX12.X02 <- rowMeans(qupr.run[,c("Tavg.X12.prev", "Tavg.X01", "Tavg.X02")])
> qupr.run$Tavg.X03.X05 <- rowMeans(qupr.run[,c("Tavg.X03", "Tavg.X04", "Tavg.X05")])
> qupr.run$Tavg.X06.X08 <- rowMeans(qupr.run[,c("Tavg.X06", "Tavg.X07", "Tavg.X08")])
> qupr.run$Tavg.X09.X11 <- rowMeans(qupr.run[,c("Tavg.X09", "Tavg.X10", "Tavg.X11")])
> 
> qupr.run$Precip.pX06.pX08 <- rowMeans(qupr.run[,c("Precip.X06.prev", "Precip.X07.prev", "Precip.X08.prev")])
> qupr.run$Precip.pX09.pX11 <- rowMeans(qupr.run[,c("Precip.X09.prev", "Precip.X10.prev", "Precip.X11.prev")])
> qupr.run$Precip.pX12.X02 <- rowMeans(qupr.run[,c("Precip.X12.prev", "Precip.X01", "Precip.X02")])
> qupr.run$Precip.X03.X05 <- rowMeans(qupr.run[,c("Precip.X03", "Precip.X04", "Precip.X05")])
> qupr.run$Precip.X06.X08 <- rowMeans(qupr.run[,c("Precip.X06", "Precip.X07", "Precip.X08")])
> qupr.run$Precip.X09.X11 <- rowMeans(qupr.run[,c("Precip.X09", "Precip.X10", "Precip.X11")])
> 
> 
> # Making vectors with the column names of the temp & precip months of interest
> temp.col <- paste("Tavg", seasons, sep=".")
> precip.col <- paste("Precip", seasons, sep=".")
> 
> # Column numbers of temp & precip months of interest
> temp.col.ind <- which(names(qupr.run) %in% c(temp.col))
> precip.col.ind <- which(names(qupr.run) %in% c(precip.col))
> summary(qupr.run[,temp.col.ind])
 Tavg.pX06.pX08  Tavg.pX09.pX11  Tavg.pX12.X02    Tavg.X03.X05  
 Min.   :288.1   Min.   :279.3   Min.   :266.7   Min.   :276.6  
 1st Qu.:290.9   1st Qu.:281.8   1st Qu.:270.4   1st Qu.:279.6  
 Median :291.7   Median :282.8   Median :271.6   Median :280.9  
 Mean   :291.7   Mean   :282.9   Mean   :271.7   Mean   :281.1  
 3rd Qu.:292.8   3rd Qu.:284.0   3rd Qu.:273.5   3rd Qu.:282.6  
 Max.   :294.7   Max.   :286.0   Max.   :275.7   Max.   :285.7  
  Tavg.X06.X08    Tavg.X09.X11  
 Min.   :288.1   Min.   :279.3  
 1st Qu.:290.9   1st Qu.:281.8  
 Median :291.8   Median :282.8  
 Mean   :291.8   Mean   :282.9  
 3rd Qu.:292.8   3rd Qu.:284.0  
 Max.   :294.7   Max.   :286.0  
> summary(qupr.run[,precip.col.ind])
 Precip.pX06.pX08 Precip.pX09.pX11 Precip.pX12.X02  Precip.X03.X05  
 Min.   : 56.77   Min.   : 27.34   Min.   : 32.96   Min.   : 56.19  
 1st Qu.: 88.62   1st Qu.: 61.39   1st Qu.: 64.17   1st Qu.: 89.24  
 Median :103.43   Median : 89.15   Median : 80.60   Median :105.75  
 Mean   :107.85   Mean   : 89.72   Mean   : 82.98   Mean   :107.27  
 3rd Qu.:123.55   3rd Qu.:119.62   3rd Qu.:102.46   3rd Qu.:122.36  
 Max.   :210.60   Max.   :160.03   Max.   :152.56   Max.   :172.95  
 Precip.X06.X08   Precip.X09.X11  
 Min.   : 56.77   Min.   : 27.34  
 1st Qu.: 86.56   1st Qu.: 61.39  
 Median : 99.27   Median : 89.15  
 Mean   :103.66   Mean   : 88.18  
 3rd Qu.:120.32   3rd Qu.:117.15  
 Max.   :183.68   Max.   :153.74  
> length(temp.col.ind)
[1] 6
> 
> # qupr.run$Tavg.yr <- rowMeans(qupr.run[,temp.col.ind])
> # qupr.run$Precip.yr <- rowSums(qupr.run[,precip.col.ind])
> 
> write.csv(qupr.run, "Inputs/QUPR_AllSites_1990-2011.csv", row.names=F)
> 
> #############
> # Reading in Data
> qupr.run <- read.csv("Inputs/QUPR_AllSites_1990-2011.csv")
> summary(qupr.run)
      Year        PlotID       TreeID    Site    Trans       Plot      
 Min.   :1990   BLDB2:22   BLDB237:22   BLD:41   A:44   Min.   :1.000  
 1st Qu.:1995   BLDC4:19   HNKA113:22   HNK:22   B:88   1st Qu.:1.000  
 Median :2000   HNKA1:22   IRNB131:22   IRN:44   C:41   Median :1.000  
 Mean   :2000   IRNB1:22   IRNC125:22   MOR:66          Mean   :1.711  
 3rd Qu.:2006   IRNC1:22   MORA118:22                   3rd Qu.:2.000  
 Max.   :2011   MORA1:22   MORB206:22                   Max.   :4.000  
                MORB2:44   (Other):41                                  
      BAI                CoreID   Pith       Pith.Yr         Inner     
 Min.   :  17.23   BLDB237HI:22   N:129   Min.   :1845   Min.   :1865  
 1st Qu.:  65.44   HNKA113HI:22   Y: 44   1st Qu.:1908   1st Qu.:1911  
 Median : 282.27   IRNB131HI:22           Median :1910   Median :1912  
 Mean   : 636.26   IRNC125HI:22           Mean   :1915   Mean   :1920  
 3rd Qu.:1103.34   MORA118HI:22           3rd Qu.:1953   3rd Qu.:1954  
 Max.   :2904.04   MORB206HI:22           Max.   :1955   Max.   :1958  
                   (Other)  :41                                        
     Outer      Bark    Use                                   Notes   
 Min.   :2009   Y:173   N: 44   B side is clearer in supression  :22  
 1st Qu.:2012           Y:129   actually lower; this one measured:22  
 Median :2012                   break at 1927                    :22  
 Mean   :2012                   dead or broken outside           :19  
 3rd Qu.:2012                   false rings (2) in 1953          :22  
 Max.   :2012                   lots of error on pith est        :22  
                                poor correlation w/ master       :44  
  Pith.offset          Tree         Spp          Genus     Canopy   Live    
 Min.   : 1.000   Min.   : 6.00   QUPR:173   Quercus:173   C:88   LIVE:173  
 1st Qu.: 1.000   1st Qu.:13.00                            D:22             
 Median : 3.000   Median :18.00                            I:19             
 Mean   : 4.543   Mean   :22.38                            U:44             
 3rd Qu.: 4.000   3rd Qu.:31.00                                             
 Max.   :20.000   Max.   :37.00                                             
                                                                            
      Age            BA.m2ha          BAI.filled         BA.tree      
 Min.   : 35.00   Min.   :0.07544   Min.   :  17.23   Min.   :  2370  
 1st Qu.: 58.00   1st Qu.:0.17669   1st Qu.:  65.44   1st Qu.:  5551  
 Median : 86.00   Median :0.41480   Median : 282.27   Median : 13032  
 Mean   : 85.12   Mean   :1.15313   Mean   : 636.26   Mean   : 36228  
 3rd Qu.: 96.00   3rd Qu.:1.90412   3rd Qu.:1103.34   3rd Qu.: 59822  
 Max.   :166.00   Max.   :4.58842   Max.   :2904.04   Max.   :144154  
                                                                      
     Stems     Density.Ha    BAI.filled.plot    BA.plot       BA.m2ha.plot   
 Min.   :1   Min.   :31.83   Min.   : 5584   Min.   : 4765   Min.   : 7.755  
 1st Qu.:1   1st Qu.:31.83   1st Qu.: 8354   1st Qu.: 6852   1st Qu.:10.746  
 Median :1   Median :31.83   Median :10503   Median : 8343   Median :16.464  
 Mean   :1   Mean   :31.83   Mean   :11885   Mean   : 8739   Mean   :16.640  
 3rd Qu.:1   3rd Qu.:31.83   3rd Qu.:15071   3rd Qu.: 9955   3rd Qu.:21.215  
 Max.   :1   Max.   :31.83   Max.   :26987   Max.   :16266   Max.   :30.972  
                                                                             
 Density.ha.plot    Stems.plot    BAI.m2ha.plot    BA.m2ha.plot.live
 Min.   : 509.3   Min.   :16.00   Min.   :0.1777   Min.   :14.51    
 1st Qu.: 732.1   1st Qu.:23.00   1st Qu.:0.2659   1st Qu.:17.86    
 Median : 795.8   Median :25.00   Median :0.3343   Median :21.79    
 Mean   : 904.9   Mean   :28.43   Mean   :0.3783   Mean   :23.04    
 3rd Qu.:1145.9   3rd Qu.:36.00   3rd Qu.:0.4797   3rd Qu.:28.01    
 Max.   :1336.9   Max.   :42.00   Max.   :0.8590   Max.   :35.43    
                                                                    
     RelBA         Site.Trans    Latitude       Longitude           elev       
 Min.   :0.01094   BLDB:22    Min.   :36.76   Min.   :-81.31   Min.   : 744.2  
 1st Qu.:0.06445   BLDC:19    1st Qu.:36.76   1st Qu.:-81.31   1st Qu.: 744.2  
 Median :0.17326   HNKA:22    Median :37.72   Median :-80.11   Median : 941.8  
 Mean   :0.34755   IRNB:22    Mean   :37.60   Mean   :-80.24   Mean   : 911.8  
 3rd Qu.:0.71314   IRNC:22    3rd Qu.:37.92   3rd Qu.:-79.84   3rd Qu.:1000.5  
 Max.   :1.00000   MORA:22    Max.   :38.32   Max.   :-79.24   Max.   :1114.8  
                   MORB:44                                                     
      flow               TPI              Tavg.X01        Tavg.X02    
 Min.   :0.007794   Min.   :-0.19670   Min.   :263.8   Min.   :264.6  
 1st Qu.:0.008083   1st Qu.:-0.11032   1st Qu.:268.6   1st Qu.:270.2  
 Median :0.034883   Median :-0.09616   Median :270.8   Median :272.1  
 Mean   :0.081560   Mean   :-0.03782   Mean   :270.7   Mean   :271.9  
 3rd Qu.:0.224870   3rd Qu.: 0.18194   3rd Qu.:273.0   3rd Qu.:273.9  
 Max.   :0.224870   Max.   : 0.19766   Max.   :276.3   Max.   :277.7  
                                                                      
    Tavg.X03        Tavg.X04        Tavg.X05        Tavg.X06    
 Min.   :269.1   Min.   :275.9   Min.   :280.6   Min.   :286.2  
 1st Qu.:273.6   1st Qu.:280.0   1st Qu.:284.7   1st Qu.:289.8  
 Median :275.4   Median :281.4   Median :286.2   Median :290.7  
 Mean   :275.6   Mean   :281.5   Mean   :286.3   Mean   :290.6  
 3rd Qu.:277.6   3rd Qu.:283.2   3rd Qu.:287.8   3rd Qu.:291.7  
 Max.   :281.1   Max.   :286.2   Max.   :291.6   Max.   :294.3  
                                                                
    Tavg.X07        Tavg.X08        Tavg.X09        Tavg.X10    
 Min.   :287.9   Min.   :287.8   Min.   :284.4   Min.   :278.8  
 1st Qu.:291.5   1st Qu.:290.9   1st Qu.:287.4   1st Qu.:281.2  
 Median :292.7   Median :292.3   Median :288.3   Median :282.6  
 Mean   :292.6   Mean   :292.1   Mean   :288.5   Mean   :282.7  
 3rd Qu.:293.9   3rd Qu.:293.2   3rd Qu.:289.7   3rd Qu.:283.8  
 Max.   :295.9   Max.   :295.7   Max.   :292.7   Max.   :287.8  
                                                                
    Tavg.X11        Tavg.X12     Tavg.X01.prev   Tavg.X02.prev  
 Min.   :272.3   Min.   :265.4   Min.   :263.8   Min.   :264.6  
 1st Qu.:276.1   1st Qu.:271.2   1st Qu.:268.9   1st Qu.:269.9  
 Median :277.7   Median :273.1   Median :271.0   Median :272.1  
 Mean   :277.6   Mean   :272.9   Mean   :270.9   Mean   :271.9  
 3rd Qu.:279.1   3rd Qu.:274.8   3rd Qu.:273.1   3rd Qu.:273.9  
 Max.   :281.8   Max.   :277.3   Max.   :276.3   Max.   :277.7  
                                                                
 Tavg.X03.prev   Tavg.X04.prev   Tavg.X05.prev   Tavg.X06.prev  
 Min.   :269.1   Min.   :275.9   Min.   :280.6   Min.   :286.2  
 1st Qu.:273.6   1st Qu.:279.9   1st Qu.:284.4   1st Qu.:289.8  
 Median :275.4   Median :281.2   Median :286.0   Median :290.7  
 Mean   :275.6   Mean   :281.4   Mean   :286.1   Mean   :290.6  
 3rd Qu.:277.7   3rd Qu.:282.9   3rd Qu.:287.7   3rd Qu.:291.7  
 Max.   :281.1   Max.   :286.2   Max.   :291.6   Max.   :294.3  
                                                                
 Tavg.X07.prev   Tavg.X08.prev   Tavg.X09.prev   Tavg.X10.prev  
 Min.   :287.9   Min.   :287.8   Min.   :284.4   Min.   :278.8  
 1st Qu.:291.5   1st Qu.:290.9   1st Qu.:287.4   1st Qu.:281.3  
 Median :292.6   Median :292.2   Median :288.3   Median :282.6  
 Mean   :292.5   Mean   :292.1   Mean   :288.4   Mean   :282.7  
 3rd Qu.:293.8   3rd Qu.:293.2   3rd Qu.:289.7   3rd Qu.:283.9  
 Max.   :295.9   Max.   :295.7   Max.   :292.7   Max.   :287.8  
                                                                
 Tavg.X11.prev   Tavg.X12.prev     Precip.X01       Precip.X02    
 Min.   :272.3   Min.   :263.8   Min.   : 22.78   Min.   : 16.16  
 1st Qu.:275.9   1st Qu.:270.6   1st Qu.: 57.40   1st Qu.: 45.91  
 Median :277.6   Median :272.8   Median : 80.78   Median : 66.78  
 Mean   :277.5   Mean   :272.4   Mean   : 91.22   Mean   : 72.78  
 3rd Qu.:278.9   3rd Qu.:274.7   3rd Qu.:105.25   3rd Qu.: 95.29  
 Max.   :281.8   Max.   :277.3   Max.   :276.20   Max.   :170.66  
                                                                  
   Precip.X03       Precip.X04       Precip.X05      Precip.X06    
 Min.   : 27.81   Min.   : 22.65   Min.   : 32.4   Min.   : 25.00  
 1st Qu.: 85.79   1st Qu.: 68.67   1st Qu.: 76.4   1st Qu.: 66.31  
 Median :105.28   Median : 98.98   Median :105.0   Median : 95.81  
 Mean   :109.75   Mean   : 97.07   Mean   :115.0   Mean   :106.79  
 3rd Qu.:128.03   3rd Qu.:121.63   3rd Qu.:153.2   3rd Qu.:121.81  
 Max.   :210.02   Max.   :202.21   Max.   :219.1   Max.   :291.28  
                                                                   
   Precip.X07       Precip.X08       Precip.X09       Precip.X10    
 Min.   : 35.88   Min.   : 32.19   Min.   :  4.60   Min.   :  2.42  
 1st Qu.: 84.78   1st Qu.: 68.21   1st Qu.: 61.18   1st Qu.: 46.06  
 Median :107.55   Median : 87.18   Median : 85.80   Median : 57.70  
 Mean   :114.82   Mean   : 89.38   Mean   :102.68   Mean   : 76.63  
 3rd Qu.:139.12   3rd Qu.:108.90   3rd Qu.:130.12   3rd Qu.:105.44  
 Max.   :292.53   Max.   :208.60   Max.   :294.62   Max.   :302.71  
                                                                    
   Precip.X11       Precip.X12     Precip.X01.prev  Precip.X02.prev 
 Min.   : 10.18   Min.   : 34.97   Min.   : 33.62   Min.   : 16.16  
 1st Qu.: 52.82   1st Qu.: 61.03   1st Qu.: 58.82   1st Qu.: 48.91  
 Median : 86.36   Median : 82.47   Median : 80.78   Median : 68.41  
 Mean   : 85.24   Mean   : 87.29   Mean   : 92.83   Mean   : 74.30  
 3rd Qu.:117.29   3rd Qu.:105.92   3rd Qu.:105.25   3rd Qu.: 96.34  
 Max.   :206.61   Max.   :180.88   Max.   :276.20   Max.   :170.66  
                                                                    
 Precip.X03.prev  Precip.X04.prev  Precip.X05.prev Precip.X06.prev 
 Min.   : 27.81   Min.   : 22.65   Min.   : 32.4   Min.   : 25.00  
 1st Qu.: 79.52   1st Qu.: 68.67   1st Qu.: 76.4   1st Qu.: 68.95  
 Median :104.33   Median : 98.33   Median :105.6   Median :103.66  
 Mean   :107.08   Mean   : 94.60   Mean   :115.6   Mean   :112.11  
 3rd Qu.:119.60   3rd Qu.:116.94   3rd Qu.:153.2   3rd Qu.:131.62  
 Max.   :210.02   Max.   :202.21   Max.   :219.1   Max.   :291.28  
                                                                   
 Precip.X07.prev  Precip.X08.prev  Precip.X09.prev  Precip.X10.prev 
 Min.   : 35.88   Min.   : 32.19   Min.   :  4.60   Min.   :  2.42  
 1st Qu.: 85.32   1st Qu.: 69.81   1st Qu.: 61.18   1st Qu.: 46.06  
 Median :120.10   Median : 89.15   Median : 87.49   Median : 57.70  
 Mean   :119.16   Mean   : 92.29   Mean   :106.49   Mean   : 78.30  
 3rd Qu.:144.01   3rd Qu.:110.73   3rd Qu.:136.02   3rd Qu.:110.45  
 Max.   :292.53   Max.   :208.60   Max.   :294.62   Max.   :302.71  
                                                                    
 Precip.X11.prev  Precip.X12.prev   BA.tree.cm2      Tavg.pX06.pX08 
 Min.   : 10.18   Min.   : 34.97   Min.   :  23.70   Min.   :288.1  
 1st Qu.: 52.82   1st Qu.: 60.06   1st Qu.:  55.51   1st Qu.:290.9  
 Median : 84.36   Median : 78.46   Median : 130.32   Median :291.7  
 Mean   : 84.38   Mean   : 84.93   Mean   : 362.28   Mean   :291.7  
 3rd Qu.:107.90   3rd Qu.:103.91   3rd Qu.: 598.22   3rd Qu.:292.8  
 Max.   :206.61   Max.   :180.88   Max.   :1441.54   Max.   :294.7  
                                                                    
 Tavg.pX09.pX11  Tavg.pX12.X02    Tavg.X03.X05    Tavg.X06.X08  
 Min.   :279.3   Min.   :266.7   Min.   :276.6   Min.   :288.1  
 1st Qu.:281.8   1st Qu.:270.4   1st Qu.:279.6   1st Qu.:290.9  
 Median :282.8   Median :271.6   Median :280.9   Median :291.8  
 Mean   :282.9   Mean   :271.7   Mean   :281.1   Mean   :291.8  
 3rd Qu.:284.0   3rd Qu.:273.5   3rd Qu.:282.6   3rd Qu.:292.8  
 Max.   :286.0   Max.   :275.7   Max.   :285.7   Max.   :294.7  
                                                                
  Tavg.X09.X11   Precip.pX06.pX08 Precip.pX09.pX11 Precip.pX12.X02 
 Min.   :279.3   Min.   : 56.77   Min.   : 27.34   Min.   : 32.96  
 1st Qu.:281.8   1st Qu.: 88.62   1st Qu.: 61.39   1st Qu.: 64.17  
 Median :282.8   Median :103.43   Median : 89.15   Median : 80.60  
 Mean   :282.9   Mean   :107.85   Mean   : 89.72   Mean   : 82.98  
 3rd Qu.:284.0   3rd Qu.:123.55   3rd Qu.:119.62   3rd Qu.:102.46  
 Max.   :286.0   Max.   :210.60   Max.   :160.03   Max.   :152.56  
                                                                   
 Precip.X03.X05   Precip.X06.X08   Precip.X09.X11  
 Min.   : 56.19   Min.   : 56.77   Min.   : 27.34  
 1st Qu.: 89.24   1st Qu.: 86.56   1st Qu.: 61.39  
 Median :105.75   Median : 99.27   Median : 89.15  
 Mean   :107.27   Mean   :103.66   Mean   : 88.18  
 3rd Qu.:122.36   3rd Qu.:120.32   3rd Qu.:117.15  
 Max.   :172.95   Max.   :183.68   Max.   :153.74  
                                                   
> 
> # Loading previous runs
> #load(file="Test results for QUPR 4 - All Sites 1990-2011.Rdata")
> 
> 
> ####################################################################################################################
> overall.model <- function(
+ 							   SIZE,aa,ab, gmax,             # Autogenic (a) -- ABSOLUTE UNITS (from gmax)
+                             BA.PLOT,RS,ca,cb,cc,cd,ce,cf,cg, # Competition (c) -- scalar
+                             # # BA.PLOT,RS,ca,cb,cc,cd,cf,cg, # Competition (c) -- scalar, removed intercept
+                             TEMP,ta1,tb1,					 # Temperature (t) -- scalar
+                             PRECIP,FLOW,pa1,pb1,pc1         		 # Preciptiation (p) -- scalar
+                             # TRANS, ha		             	 # Habitat (h) -- scalar
+                             )
+ 	{
+ 	################
+ 	# Autogenic Growth: 0-1 * gmax (max possible growth, absolute units)
+ 	################
+ 	autogenic.effect <- gmax*(1 - aa*exp(-ab*SIZE))   
+ 	# autogenic.effect <- gmax*(1-aa*exp(-ab*SIZE))   
+ 
+ 
+ 	################
+ 	# Competition Effect: 0-1 
+ 	################
+ 	size.effect <- ca*exp(-cb*(RS^cc))
+ 	comp.effect <- (ce/1000 + ( (1-ce/1000)/(1+(BA.PLOT/cf)^cg)))
+ 	# comp.effect <- (1/(1+(BA.PLOT/cf)^cg))
+ 	comp.response <- exp(-size.effect*(comp.effect^cd))
+ 
+  	################
+ 	# Climate Effect: Now Scalar
+ 	################
+ 	
+ 	#Temp on scale 0-1
+     temp.effect <- t(exp(-0.5*((t(TEMP)-ta1)/tb1)^2))
+ 
+     # Precip on scale 0-1
+     # precip.effect <- t(1/(1+(t(PRECIP)/pa1)^pb1))
+ 	precip.effect <- t(exp(-0.5*((t(PRECIP+pc1*FLOW*PRECIP)-pa1)/pb1)^2)) # Gaussian Data Frame
+ 
+ 	# Multiplying temp & precip together
+     climate.effect <- temp.effect * precip.effect
+ 	 
+ 	 ### LEM: do row sums
+ 	 ##### CRR note: I think this should be on a scale from 0-1; 
+      # climate.effect <- colSums(climate.effect) 
+ 	 climate.effect2 <- apply(climate.effect, 1, FUN=prod)
+ 	
+ 
+ 	################
+ 	# Habitat Effect: 0-1
+ 	# Note: removed from model for the moment, may add Topographic position or upslope area later
+ 	################
+ 	# habitat.effect <- ha[TRANS]
+ 
+ 	# comp.response <- 1
+ 	habitat.effect <- 1
+ 	# climate.effect2 <- precip.effect
+ 
+ 	autogenic.effect*comp.response*habitat.effect*climate.effect2
+ 	
+ 
+ 	}
> 
> 
> ####################################################################################################################
> ####################################################################################################################
> ### setting up annealing
> 
> # par <- results$best_par
> 
> # need a list that gives initial values for all of the "parameters"
> par<-list(
+ 		  aa=0.9, ab=0.0003, gmax=9500,  	# Autogenic
+           ca=987.3, cb=64.9, cc=1.2, cd=1.05, ce=625.94, cf=902.03, cg=-292.7,  # Competition
+           ta1=c(304.7,	294.1,	321.12,	324.86,	267.88,	297.18), 
+           tb1=c(216.63,	16.84,	291.93,	464.16,	315.28,	422.35),
+           pa1=c(260.73,	178.76,	72.62,	0.00,	2.08,	393.24), 
+           pb1=c(460.36,	210.83,	760.55,	191.68,	199.6,	1648.7), 
+           pc1=0.0001, 
+           # # ha=rep(0.5,3),  # Habitat
+           sd=256)
> 
> # also need a list that identifies the independent variables
> var <- list(SIZE = "BA.tree.cm2",  # Autogenic
+             BA.PLOT="BA.m2ha.plot.live", RS="RelBA",  # Competition
+             TEMP = qupr.run[,temp.col.ind], # hard-coded above
+             PRECIP = qupr.run[,precip.col.ind], FLOW="flow"
+             # TRANS="Site.Trans" # Habitat
+             )
> 
> ## Set bounds and initial search ranges within which to search for parameters
> ##   NOTE:  the s and sd parameters have to be greater than zero (algebraically)
> par_lo <-list(
+ 			  aa=0, ab=0, gmax=0,  # Autogenic
+               ca=0, cb=0, cc=0, cd=0, ce=0, cf=-100, cg=-1000, # Competition
+               # # ca=0, cb=0, cc=0, cd=0, cf=-100, cg=-200, # Competition
+               ta1=rep(250, length=length(temp.col.ind)), tb1=rep(0, length=length(temp.col.ind)),
+               pa1=rep(0, length=length(precip.col.ind)), pb1=rep(0, length=length(precip.col.ind)), pc1=0,
+ 			# ha=rep(0,3), # Habitat
+               sd=0.1)
> 
> 
> par_hi <-list(
+ 			  aa=1, ab=1000, gmax=10000, # Autogenic
+               ca=2000, cb=1000, cc=5, cd=5, ce=1000, cf=1000, cg=1000,	# Competition
+               # # ca=1000, cb=1000, cc=50, cd=5, cf=500, cg=1000,	# Competition
+               ta1=rep(325, length=length(temp.col.ind)), tb1=rep(500, length=length(temp.col.ind)),
+               pa1=rep(500, length=length(precip.col.ind)), pb1=rep(2000, length=length(precip.col.ind)), pc1=1,
+               # ha=rep(1,3), # Habitat
+               sd=1000)
> 
> ## Specify the dependent variable, and name it using whatever
> ##    argument name is used in the pdf ("x" in the normal.pdf function above)
> var$x<-"BAI"
> 
> ## predicted value in your PDF should be given the reserved name "predicted"
> ##   Anneal will use your scientific model and your data and calculate the
> ##   predicted value for each observation and store it internally in an object
> ##   called "predicted"
> var$mean<-"predicted"
> 
> ## Have it calculate log likelihood
> var$log<-TRUE
> 
> ##  now call the annealing algorithm, choosing which model to use
> #  "data" should be whatever the name of your dataframe is...
> results <- anneal(overall.model, par, var, qupr.run, par_lo, par_hi, dnorm, "BAI", hessian = T, slimit=1.92, max_iter=100000)
> 
> save(results,file=file.path("Outputs", paste( run.label, "_Results.Rdata", sep="")))
> 
> write_results(results,file.path("Outputs", paste( run.label, "_Results.txt", sep="")))
> 
> ## display some of the results in the console
> results$best_pars;
$aa
[1] 0.8497564

$ab
[1] 0.0002740531

$gmax
[1] 10000

$ca
[1] 4.543114

$cb
[1] 968.5343

$cc
[1] 3.520531

$cd
[1] 3.521843

$ce
[1] 514.0753

$cf
[1] 664.4583

$cg
[1] 479.4889

$ta1
[1] 320.1506 297.6703 275.0360 295.5920 301.7786 324.7977

$tb1
[1] 456.34086  17.11399  11.58487 335.75057 385.52673 375.96246

$pa1
[1] 3.038039e+02 1.161672e+02 3.624864e-03 3.326751e+00 1.080660e-08
[6] 2.778489e-02

$pb1
[1]  294.7175  116.6703 1343.2683  304.5876  249.1002 1310.1423

$pc1
[1] 0.5697274

$sd
[1] 246.7496

> results$max_likeli;
[1] -1196.454
> results$aic_corr ;
[1] 2484.496
> results$slope;
[1] 1.007466
> results$R2
[1] 0.8774524
> 
> ####################################################################################################################
> ####################################################################################################################
> load(file=file.path("Outputs", paste( run.label, "_Results.Rdata", sep="")))
> 
> 
> # Looking at Residuals and Parameters
> #windows()
> plot(results$source_data$predicted,results$source_data$BAI,xlab="Predicted",ylab="Observed")
> abline(0,1,lwd=2,col="red")
> 
> results$source_data$residual <- results$source_data$BAI - results$source_data$predicted
> #windows()
> hist(results$source_data$residual)
> 
> 
> ##################################
> autogenic.effect <- function(SIZE,aa,ab) { (1 - aa*exp(-ab*SIZE))  }
> ##################################
> plot(BAI ~ BA.tree.cm2, data=results$source_data)
> plot(BAI ~ Age, data=results$source_data)
> plot(BA.tree.cm2 ~ Age, data=results$source_data)
> 
> summary(results$source_data$BA.tree.cm2)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  23.70   55.51  130.30  362.30  598.20 1442.00 
> summary(results$source_data$Age)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  35.00   58.00   86.00   85.12   96.00  166.00 
> 
> # Effect of Tree Basal Area
> #windows()
> par(mar=c(5,5,4,2), mfrow=c(1,1))
> x <- seq(0,max(ceiling(results$source_data$BA.tree.cm2)),1)
> y <- autogenic.effect(x,results$best_pars$aa,results$best_pars$ab)
> 
> pdf(file.path("Figures", paste(run.label, " - Autogenic Scalar.pdf", sep="")))
> plot(x,y,ylim=c(0,1),xlab="Tree Basal Area (cm2)",ylab="Effect of Size on Growth",
+      cex.axis=1.25,cex.lab=1.5,type="l",lwd=2,main=run.label)
> dev.off()
pdf 
  2 
> 
> 
> #################################
> size.effect <- function(SIZE,ca,cb,cc) {ca*exp(-cb*(SIZE^cc))}
> comp.effect <- function(BA.PLOT,ce,cf,cg) {ce/1000 + ( (1-ce/1000)/(1+(BA.PLOT/cf)^cg))}
> comp.response <- function(SIZE,BA.PLOT,ca,cb,cc,cd,ce,cf,cg)
+   { size.effect <- ca*exp(-cb*(SIZE^cc))
+     comp.effect <- (ce/1000 + ( (1-ce/1000)/(1+(BA.PLOT/cf)^cg)))
+     comp.response <- exp(-size.effect*(comp.effect^cd)) }
> ##################################
> # Size Effect
> plot(BAI ~ RelBA, data=results$source_data)
> 
> par(mar=c(5,5,4,2))
> x <- seq(0,1,0.01)
> y <- size.effect(x,results$best_pars$ca, results$best_pars$cb,results$best_pars$cc)
> summary(y)
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.000000 0.000000 0.000000 0.596700 0.002907 4.543000 
> 
> pdf(file.path("Figures", paste(run.label, " - Competition Size Effect.pdf", sep="")))
> plot(x,y,xlab="Relative Size",ylab="Size Effect",type="l",lwd=2,
+       cex.lab=1.5,cex.axis=1.25,main=run.label)
> #savePlot(file=paste("Competition Plot 1 ",run.label,".png",sep=""),type="png")
> dev.off()
pdf 
  2 
> 
> #####################
> # Plot BA effect
> plot(BAI ~ BA.m2ha.plot, data=results$source_data)
> 
> par(mar=c(5,5,4,2))
> x <- seq(0,60,0.1)
> y <- comp.effect(x, results$best_pars$ce, results$best_pars$cf,results$best_pars$cg)
> summary(y)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      1       1       1       1       1       1 
> 
> pdf(file.path("Figures", paste(run.label, " - Competition Competitive Effect.pdf", sep="")))
> plot(x,y,ylim=c(0,1),xlab="Plot BA",ylab="Competitive Effect",type="l",lwd=2,
+        cex.lab=1.5,cex.axis=1.25,main=run.label)
> dev.off()
pdf 
  2 
> #savePlot(file=paste("Competition Plot 2 ",run.label,".png",sep=""),type="png")
> 
> #####################
> # Competition Response: Size vs. Response with different plot BA levels
> plot(BA.m2ha.plot~ RelBA, data=results$source_data)
> 
> 
> pdf(file.path("Figures", paste(run.label, " - Competition Response Scalar.pdf", sep="")))
> par(mar=c(5,5,4,2))
> colors <- c("red","orange","blue","cyan","green")
> x <- seq(0,1,0.01)
> y <- comp.response(SIZE=x, BA.PLOT=50, results$best_pars$ca, results$best_pars$cb, results$best_pars$cc, results$best_pars$cd, results$best_pars$ce, results$best_pars$cf, results$best_pars$cg)
> plot(x,y,ylim=c(0,1),xlab="Relative Size",ylab="Competition Scalar",type="l",col=colors[1],lwd=2,
+      cex.lab=1.5,cex.axis=1.25,main=run.label)
> y <- comp.response(SIZE=x, BA.PLOT=40, results$best_pars$ca, results$best_pars$cb, results$best_pars$cc, results$best_pars$cd, results$best_pars$ce, results$best_pars$cf, results$best_pars$cg)
> lines(x,y,col=colors[2],lwd=2)
> y <- comp.response(SIZE=x, BA.PLOT=30, results$best_pars$ca, results$best_pars$cb, results$best_pars$cc, results$best_pars$cd, results$best_pars$ce, results$best_pars$cf, results$best_pars$cg)
> lines(x,y,col=colors[3],lwd=2)
> y <- comp.response(SIZE=x, BA.PLOT=20, results$best_pars$ca, results$best_pars$cb, results$best_pars$cc, results$best_pars$cd, results$best_pars$ce, results$best_pars$cf, results$best_pars$cg)
> lines(x,y,col=colors[4],lwd=2)
> y <- comp.response(SIZE=x, BA.PLOT=10, results$best_pars$ca, results$best_pars$cb, results$best_pars$cc, results$best_pars$cd, results$best_pars$ce, results$best_pars$cf, results$best_pars$cg)
> lines(x,y,col=colors[5],lwd=2)
> lines(x,y,col=colors[6],lwd=2)
> legend("bottomright",legend=c(50,40,30,20,10),col=colors,bty="n",lwd=2,title="Plot\nBasal\nArea",cex=1.25)
> dev.off()
pdf 
  2 
> #savePlot(file=paste("Competition Plot 3 ",run.label,".png",sep=""),type="png")
> 
> 
> ##################################
> temp.effect <- function(TEMP,ta1,tb1)
+        { t(exp(-0.5*((t(TEMP)-ta1)/tb1)^2))  }
> 
> precip.effect <- function(PRECIP,FLOW,pa1,pb1,pc1)
+        { exp(-0.5*((t(PRECIP+pc1*FLOW*PRECIP)-pa1)/pb1)^2)) }
Error: unexpected ')' in:
"precip.effect <- function(PRECIP,FLOW,pa1,pb1,pc1)
       { exp(-0.5*((t(PRECIP+pc1*FLOW*PRECIP)-pa1)/pb1)^2))"
Execution halted
