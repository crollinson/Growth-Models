
R version 2.15.3 (2013-03-01) -- "Security Blanket"
Copyright (C) 2013 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ####################################################
> # NYSY MODEL Autogenic x Competition x (Temp x Precip) :
> # Autogenic: Size/Age logistic scalar with Max potential growth for absolute values
> # Competition: Relative Size, Plot BA Scalars
> # Climate: 3-month means, prev Jun - current Nov
> #	-- Temp: Gaussian
> #	-- Precip: with flow Gaussian
> #
> ####################################################
> rm(list=ls())
> 
> data_directory <- "~/CARCA/Growth-Models/Seasonal/"
> #memory.size(4024)
> setwd(data_directory)
> library(likelihood)
Loading required package: nlme
> 
> # run.label <- "NYSY_Full_Season"
> # load(file=paste( run.label, "_Results.Rdata", sep=""))
> 
> run.label <- "NYSY_Full_Season"
> 
> #############
> # Reading in Test Data & some formating
> all.data <-read.csv("../RawInputs/CARCA_CoreData_Climate_Month_Wide.csv")
> all.data[,substr(names(all.data),1,4)=="Tavg"] <- all.data[,substr(names(all.data),1,4)=="Tavg"]+273.15
> all.data$BA.tree.cm2 <- all.data$BA.tree/100
> all.data$Site.Trans <- as.factor(substr(all.data$PlotID,1,4))
> summary(all.data)
      Year          PlotID           TreeID        Site       Trans     
 Min.   :1771   HNKC2  :  8505   BLDA101:   243   BLD:62694   A: 88452  
 1st Qu.:1831   FLTA1  :  7776   BLDA102:   243   FLT:49329   B: 93798  
 Median :1892   HIKA1  :  7290   BLDA103:   243   HIK:48357   C:106434  
 Mean   :1892   HNKB2  :  7290   BLDA104:   243   HNK:43983             
 3rd Qu.:1953   HNKA3  :  7047   BLDA105:   243   IRN:52245             
 Max.   :2013   BLDA2  :  6804   BLDA106:   243   MOR:32076             
                (Other):243972   (Other):287226                         
      Plot            BAI                 CoreID       Pith      
 Min.   :1.000   Min.   :    0.00   BLDA101HI:   243   N:211896  
 1st Qu.:1.000   1st Qu.:   84.36   BLDA102HI:   243   Y: 76788  
 Median :2.000   Median :  244.79   BLDA103HI:   243             
 Mean   :2.265   Mean   :  459.83   BLDA104HI:   243             
 3rd Qu.:3.000   3rd Qu.:  589.69   BLDA105HI:   243             
 Max.   :4.000   Max.   :18648.71   BLDA106HI:   243             
                 NA's   :202009     (Other)  :287226             
    Pith.Yr          Inner          Outer      Bark       Use       
 Min.   :1756    Min.   :1762   Min.   :1990   N:  6318   N:  4617  
 1st Qu.:1917    1st Qu.:1923   1st Qu.:2012   Y:282366   Y:284067  
 Median :1933    Median :1938   Median :2012                        
 Mean   :1936    Mean   :1939   Mean   :2012                        
 3rd Qu.:1953    3rd Qu.:1955   3rd Qu.:2012                        
 Max.   :2008    Max.   :2009   Max.   :2013                        
 NA's   :60021                                                      
                        Notes         Pith.offset         Tree      
 poor corr w/ master       :   972   Min.   : 0.00   Min.   : 1.00  
 poor correlation w/ master:   972   1st Qu.: 1.00   1st Qu.:10.00  
 1977 missing              :   486   Median : 2.00   Median :18.50  
 1986 missing              :   486   Mean   : 3.35   Mean   :20.86  
 1999 missing              :   486   3rd Qu.: 5.00   3rd Qu.:30.00  
 (Other)                   : 14094   Max.   :20.00   Max.   :84.00  
 NA's                      :271188   NA's   :60021                  
      Spp              Genus         Canopy         Live       
 ACRU   :71199   Quercus  :111294   C   :148230   DEAD:   243  
 QUPR   :50787   Acer     : 85779   D   :  8748   LIVE:288441  
 QURU   :43740   Nyssa    : 38880   I   : 86022                
 NYSY   :38880   Magnolia : 11421   U   : 45441                
 ACSA   :14580   Betula   :  8262   NA's:   243                
 MAAC   : 9720   Sassafras:  7776                              
 (Other):59778   (Other)  : 25272                              
      Age            BA.m2ha          BAI.filled          BA.tree      
 Min.   :  0.00   Min.   : 0.0000   Min.   :    0.00   Min.   :     0  
 1st Qu.: 19.00   1st Qu.: 0.0000   1st Qu.:    0.00   1st Qu.:     0  
 Median : 40.00   Median : 0.0000   Median :    0.00   Median :     0  
 Mean   : 44.55   Mean   : 0.1771   Mean   :  149.04   Mean   :  6106  
 3rd Qu.: 64.00   3rd Qu.: 0.0615   3rd Qu.:   74.84   3rd Qu.:  2007  
 Max.   :256.00   Max.   :11.8597   Max.   :18648.71   Max.   :462177  
 NA's   :195231   NA's   :1047      NA's   :985        NA's   :1047    
     Stems          Density.Ha     BAI.filled.plot      BA.plot       
 Min.   :0.0000   Min.   : 0.000   Min.   :    0.0   Min.   :    0.0  
 1st Qu.:0.0000   1st Qu.: 0.000   1st Qu.:    0.0   1st Qu.:    0.0  
 Median :0.0000   Median : 0.000   Median :  904.8   Median :  581.2  
 Mean   :0.3191   Mean   : 9.728   Mean   : 3899.5   Mean   : 2063.0  
 3rd Qu.:1.0000   3rd Qu.:31.831   3rd Qu.: 6247.5   3rd Qu.: 2866.9  
 Max.   :1.0000   Max.   :49.736   Max.   :38677.4   Max.   :23212.2  
                                   NA's   :1500      NA's   :1500     
  BA.m2ha.plot     Density.ha.plot     Stems.plot     BAI.m2ha.plot   
 Min.   : 0.0000   Min.   :   0.00   Min.   : 0.000   Min.   :0.0000  
 1st Qu.: 0.0000   1st Qu.:   0.00   1st Qu.: 0.000   1st Qu.:0.0000  
 Median : 0.0705   Median :  63.66   Median : 2.000   Median :0.0274  
 Mean   : 3.4704   Mean   : 268.53   Mean   : 8.898   Mean   :0.1135  
 3rd Qu.: 4.3534   3rd Qu.: 509.30   3rd Qu.:18.000   3rd Qu.:0.1935  
 Max.   :35.8804   Max.   :1432.39   Max.   :45.000   Max.   :1.0485  
 NA's   :1500      NA's   :1500      NA's   :1500     NA's   :1500    
 BA.m2ha.plot.live     RelBA          Site.Trans        Latitude     
 Min.   : 0.000    Min.   :0.00     BLDC   : 23814   Min.   :36.75   
 1st Qu.: 0.000    1st Qu.:0.05     IRNC   : 20898   1st Qu.:37.24   
 Median : 1.116    Median :0.17     HIKC   : 20169   Median :37.91   
 Mean   : 5.122    Mean   :0.30     BLDA   : 19926   Mean   :37.74   
 3rd Qu.: 6.584    3rd Qu.:0.46     BLDB   : 18954   3rd Qu.:38.32   
 Max.   :57.620    Max.   :1.00     IRNB   : 18711   Max.   :38.58   
 NA's   :985       NA's   :199115   (Other):166212   NA's   :154440  
   Longitude           elev             flow             TPI        
 Min.   :-81.31   Min.   : 666.9   Min.   :0.01     Min.   :-0.23   
 1st Qu.:-80.86   1st Qu.: 843.7   1st Qu.:0.01     1st Qu.:-0.10   
 Median :-79.85   Median : 952.4   Median :0.03     Median :-0.03   
 Mean   :-80.10   Mean   : 955.7   Mean   :0.12     Mean   : 0.01   
 3rd Qu.:-79.22   3rd Qu.:1098.3   3rd Qu.:0.06     3rd Qu.: 0.15   
 Max.   :-79.15   Max.   :1256.7   Max.   :1.42     Max.   : 0.30   
 NA's   :154440   NA's   :154440   NA's   :154440   NA's   :154440  
    Tavg.X01         Tavg.X02         Tavg.X03         Tavg.X04     
 Min.   :260.1    Min.   :262.9    Min.   :264.5    Min.   :274.6   
 1st Qu.:269.2    1st Qu.:270.3    1st Qu.:274.7    1st Qu.:280.5   
 Median :271.3    Median :272.4    Median :276.8    Median :282.4   
 Mean   :271.2    Mean   :272.2    Mean   :276.7    Mean   :282.2   
 3rd Qu.:273.2    3rd Qu.:274.2    3rd Qu.:278.8    3rd Qu.:284.0   
 Max.   :280.5    Max.   :278.5    Max.   :285.0    Max.   :287.7   
 NA's   :154440   NA's   :154440   NA's   :154440   NA's   :154440  
    Tavg.X05         Tavg.X06         Tavg.X07         Tavg.X08     
 Min.   :279.8    Min.   :284.9    Min.   :287.3    Min.   :285.8   
 1st Qu.:285.8    1st Qu.:290.0    1st Qu.:292.1    1st Qu.:291.3   
 Median :287.5    Median :291.4    Median :293.4    Median :292.7   
 Mean   :287.3    Mean   :291.1    Mean   :293.1    Mean   :292.5   
 3rd Qu.:289.0    3rd Qu.:292.5    3rd Qu.:294.3    3rd Qu.:293.8   
 Max.   :292.2    Max.   :296.2    Max.   :297.1    Max.   :297.3   
 NA's   :154440   NA's   :154440   NA's   :154440   NA's   :154440  
    Tavg.X09         Tavg.X10         Tavg.X11         Tavg.X12     
 Min.   :282.8    Min.   :276.6    Min.   :271.5    Min.   :263.8   
 1st Qu.:288.1    1st Qu.:282.2    1st Qu.:276.5    1st Qu.:271.3   
 Median :289.5    Median :283.7    Median :277.8    Median :273.1   
 Mean   :289.3    Mean   :283.5    Mean   :277.8    Mean   :273.0   
 3rd Qu.:290.7    3rd Qu.:285.0    3rd Qu.:279.1    3rd Qu.:274.8   
 Max.   :294.2    Max.   :288.6    Max.   :283.7    Max.   :279.9   
 NA's   :154440   NA's   :154440   NA's   :154440   NA's   :154440  
 Tavg.X01.prev    Tavg.X02.prev    Tavg.X03.prev    Tavg.X04.prev   
 Min.   :260.1    Min.   :262.9    Min.   :264.5    Min.   :274.6   
 1st Qu.:269.2    1st Qu.:270.3    1st Qu.:274.7    1st Qu.:280.5   
 Median :271.3    Median :272.4    Median :276.8    Median :282.4   
 Mean   :271.2    Mean   :272.1    Mean   :276.6    Mean   :282.2   
 3rd Qu.:273.2    3rd Qu.:274.2    3rd Qu.:278.7    3rd Qu.:284.0   
 Max.   :280.5    Max.   :278.5    Max.   :285.0    Max.   :287.7   
 NA's   :155628   NA's   :155628   NA's   :155628   NA's   :155628  
 Tavg.X05.prev    Tavg.X06.prev    Tavg.X07.prev    Tavg.X08.prev   
 Min.   :279.8    Min.   :284.9    Min.   :287.3    Min.   :285.8   
 1st Qu.:285.8    1st Qu.:290.0    1st Qu.:292.1    1st Qu.:291.3   
 Median :287.5    Median :291.4    Median :293.3    Median :292.7   
 Mean   :287.3    Mean   :291.1    Mean   :293.1    Mean   :292.5   
 3rd Qu.:288.9    3rd Qu.:292.5    3rd Qu.:294.2    3rd Qu.:293.8   
 Max.   :292.2    Max.   :296.2    Max.   :297.1    Max.   :297.3   
 NA's   :155628   NA's   :155628   NA's   :155628   NA's   :155628  
 Tavg.X09.prev    Tavg.X10.prev    Tavg.X11.prev    Tavg.X12.prev   
 Min.   :282.8    Min.   :276.6    Min.   :271.5    Min.   :263.8   
 1st Qu.:288.1    1st Qu.:282.2    1st Qu.:276.5    1st Qu.:271.2   
 Median :289.5    Median :283.7    Median :277.8    Median :273.1   
 Mean   :289.3    Mean   :283.5    Mean   :277.8    Mean   :272.9   
 3rd Qu.:290.7    3rd Qu.:285.0    3rd Qu.:279.1    3rd Qu.:274.8   
 Max.   :294.2    Max.   :288.6    Max.   :283.7    Max.   :279.9   
 NA's   :155628   NA's   :155628   NA's   :155628   NA's   :155628  
   Precip.X01       Precip.X02       Precip.X03       Precip.X04    
 Min.   :  9.06   Min.   :  7.21   Min.   :  0.15   Min.   : 14.74  
 1st Qu.: 56.47   1st Qu.: 49.54   1st Qu.: 70.19   1st Qu.: 61.82  
 Median : 77.95   Median : 71.53   Median : 95.96   Median : 87.82  
 Mean   : 83.89   Mean   : 75.98   Mean   : 99.47   Mean   : 91.25  
 3rd Qu.:102.79   3rd Qu.: 97.05   3rd Qu.:122.77   3rd Qu.:113.90  
 Max.   :276.20   Max.   :209.15   Max.   :272.97   Max.   :238.54  
 NA's   :154440   NA's   :154440   NA's   :154440   NA's   :154440  
   Precip.X05       Precip.X06       Precip.X07       Precip.X08    
 Min.   : 19.83   Min.   : 14.62   Min.   : 27.43   Min.   : 21.48  
 1st Qu.: 74.09   1st Qu.: 74.26   1st Qu.: 89.65   1st Qu.: 68.85  
 Median :104.65   Median :100.85   Median :112.71   Median : 95.89  
 Mean   :106.44   Mean   :107.63   Mean   :119.43   Mean   :105.77  
 3rd Qu.:135.01   3rd Qu.:131.03   3rd Qu.:142.94   3rd Qu.:129.40  
 Max.   :266.04   Max.   :296.69   Max.   :423.43   Max.   :421.09  
 NA's   :154440   NA's   :154440   NA's   :154440   NA's   :154440  
   Precip.X09       Precip.X10       Precip.X11       Precip.X12    
 Min.   :  2.37   Min.   :  1.06   Min.   :  9.25   Min.   :  2.49  
 1st Qu.: 52.19   1st Qu.: 44.08   1st Qu.: 45.03   1st Qu.: 56.20  
 Median : 79.54   Median : 73.11   Median : 71.98   Median : 75.57  
 Mean   : 90.54   Mean   : 82.99   Mean   : 76.45   Mean   : 82.37  
 3rd Qu.:117.18   3rd Qu.:114.42   3rd Qu.:100.25   3rd Qu.:103.91  
 Max.   :324.42   Max.   :319.10   Max.   :354.36   Max.   :252.11  
 NA's   :154440   NA's   :154440   NA's   :154440   NA's   :154440  
 Precip.X01.prev  Precip.X02.prev  Precip.X03.prev  Precip.X04.prev 
 Min.   :  9.06   Min.   :  7.21   Min.   :  0.15   Min.   : 14.74  
 1st Qu.: 56.43   1st Qu.: 49.65   1st Qu.: 70.01   1st Qu.: 62.00  
 Median : 77.95   Median : 71.83   Median : 95.76   Median : 87.89  
 Mean   : 83.96   Mean   : 76.17   Mean   : 99.26   Mean   : 91.32  
 3rd Qu.:103.33   3rd Qu.: 97.59   3rd Qu.:122.69   3rd Qu.:114.66  
 Max.   :276.20   Max.   :209.15   Max.   :272.97   Max.   :238.54  
 NA's   :155628   NA's   :155628   NA's   :155628   NA's   :155628  
 Precip.X05.prev  Precip.X06.prev  Precip.X07.prev  Precip.X08.prev 
 Min.   : 19.83   Min.   : 14.62   Min.   : 27.43   Min.   : 21.48  
 1st Qu.: 73.88   1st Qu.: 74.67   1st Qu.: 89.53   1st Qu.: 68.67  
 Median :104.37   Median :101.25   Median :112.71   Median : 95.82  
 Mean   :106.28   Mean   :108.04   Mean   :119.47   Mean   :105.70  
 3rd Qu.:134.94   3rd Qu.:131.58   3rd Qu.:143.14   3rd Qu.:129.38  
 Max.   :266.04   Max.   :296.69   Max.   :423.43   Max.   :421.09  
 NA's   :155628   NA's   :155628   NA's   :155628   NA's   :155628  
 Precip.X09.prev  Precip.X10.prev  Precip.X11.prev  Precip.X12.prev 
 Min.   :  2.37   Min.   :  1.06   Min.   :  9.25   Min.   :  2.49  
 1st Qu.: 51.94   1st Qu.: 43.92   1st Qu.: 45.68   1st Qu.: 56.30  
 Median : 79.03   Median : 73.60   Median : 72.17   Median : 76.78  
 Mean   : 90.18   Mean   : 83.27   Mean   : 76.91   Mean   : 82.60  
 3rd Qu.:115.57   3rd Qu.:114.60   3rd Qu.:100.41   3rd Qu.:104.91  
 Max.   :324.42   Max.   :319.10   Max.   :354.36   Max.   :252.11  
 NA's   :155628   NA's   :155628   NA's   :155628   NA's   :155628  
  BA.tree.cm2     
 Min.   :   0.00  
 1st Qu.:   0.00  
 Median :   0.00  
 Mean   :  61.06  
 3rd Qu.:  20.07  
 Max.   :4621.77  
 NA's   :1047     
> dim(all.data)
[1] 288684     90
> 
> #############
> # Subsetting just NYSY data
> nysy.all <- all.data[all.data$Spp=="NYSY", ]
> summary(nysy.all)
      Year          PlotID          TreeID       Site       Trans    
 Min.   :1771   FLTC2  : 3645   BLDA305:  243   BLD: 6075   A: 7290  
 1st Qu.:1831   HNKA3  : 3645   BLDA339:  243   FLT: 8019   B:15552  
 Median :1892   HNKB2  : 3645   BLDA340:  243   HIK:  729   C:16038  
 Mean   :1892   HNKC2  : 2673   BLDA421:  243   HNK:16281            
 3rd Qu.:1953   HNKB3  : 2430   BLDB102:  243   IRN: 4617            
 Max.   :2013   HNKC3  : 2187   BLDB137:  243   MOR: 3159            
                (Other):20655   (Other):37422                        
      Plot            BAI                 CoreID      Pith         Pith.Yr    
 Min.   :1.000   Min.   :   0.817   BLDA305HI:  243   N:22599   Min.   :1890  
 1st Qu.:2.000   1st Qu.:  41.107   BLDA339HI:  243   Y:16281   1st Qu.:1915  
 Median :2.000   Median :  79.597   BLDA340HI:  243             Median :1932  
 Mean   :2.256   Mean   : 150.794   BLDA421HI:  243             Mean   :1933  
 3rd Qu.:3.000   3rd Qu.: 165.406   BLDB102HI:  243             3rd Qu.:1947  
 Max.   :4.000   Max.   :2551.839   BLDB137HI:  243             Max.   :1982  
                 NA's   :26905      (Other)  :37422             NA's   :9234  
     Inner          Outer      Bark      Use      
 Min.   :1844   Min.   :2007   N:  486   N: 1701  
 1st Qu.:1920   1st Qu.:2012   Y:38394   Y:37179  
 Median :1937   Median :2012                      
 Mean   :1938   Mean   :2012                      
 3rd Qu.:1953   3rd Qu.:2012                      
 Max.   :1988   Max.   :2013                      
                                                  
                    Notes        Pith.offset          Tree      
 poor corr             :  486   Min.   : 1.000   Min.   : 1.00  
 1999 missing          :  243   1st Qu.: 1.000   1st Qu.: 8.00  
 2010 & 2011 very small:  243   Median : 1.000   Median :21.00  
 b side measured       :  243   Mean   : 2.311   Mean   :22.46  
 can't measure to pith :  243   3rd Qu.: 3.000   3rd Qu.:34.00  
 (Other)               : 1701   Max.   :12.000   Max.   :76.00  
 NA's                  :35721   NA's   :9234                    
      Spp             Genus       Canopy      Live            Age        
 NYSY   :38880   Nyssa   :38880   C: 5103   DEAD:    0   Min.   :  0.00  
 ACRU   :    0   Acer    :    0   D:    0   LIVE:38880   1st Qu.: 19.00  
 ACSA   :    0   Betula  :    0   I:17253                Median : 39.00  
 BELE   :    0   Carya   :    0   U:16524                Mean   : 42.15  
 BEPA   :    0   Castanea:    0                          3rd Qu.: 61.00  
 CADE   :    0   Cornus  :    0                          Max.   :208.00  
 (Other):    0   (Other) :    0                          NA's   :26313   
    BA.m2ha          BAI.filled         BA.tree           Stems      
 Min.   :0.00000   Min.   :   0.00   Min.   :     0   Min.   :0.000  
 1st Qu.:0.00000   1st Qu.:   0.00   1st Qu.:     0   1st Qu.:0.000  
 Median :0.00000   Median :   0.00   Median :     0   Median :0.000  
 Mean   :0.05550   Mean   :  48.82   Mean   :  2085   Mean   :0.315  
 3rd Qu.:0.03602   3rd Qu.:  35.93   3rd Qu.:  1169   3rd Qu.:1.000  
 Max.   :4.96674   Max.   :2551.84   Max.   :224739   Max.   :1.000  
 NA's   :132       NA's   :127       NA's   :132                     
   Density.Ha    BAI.filled.plot      BA.plot         BA.m2ha.plot     
 Min.   : 0.00   Min.   :    0.0   Min.   :    0.0   Min.   : 0.00000  
 1st Qu.: 0.00   1st Qu.:    0.0   1st Qu.:    0.0   1st Qu.: 0.00000  
 Median : 0.00   Median :  637.1   Median :  439.7   Median : 0.03769  
 Mean   : 9.62   Mean   : 3871.4   Mean   : 1835.4   Mean   : 3.39984  
 3rd Qu.:22.10   3rd Qu.: 6320.0   3rd Qu.: 2556.3   3rd Qu.: 4.60905  
 Max.   :49.74   Max.   :35506.8   Max.   :16442.7   Max.   :35.88040  
                                                                       
 Density.ha.plot     Stems.plot     BAI.m2ha.plot    BA.m2ha.plot.live
 Min.   :   0.00   Min.   : 0.000   Min.   :0.0000   Min.   : 0.000   
 1st Qu.:   0.00   1st Qu.: 0.000   1st Qu.:0.0000   1st Qu.: 0.000   
 Median :  37.67   Median : 2.000   Median :0.0200   Median : 1.116   
 Mean   : 275.47   Mean   : 9.226   Mean   :0.1095   Mean   : 4.301   
 3rd Qu.: 552.62   3rd Qu.:19.000   3rd Qu.:0.1982   3rd Qu.: 5.433   
 Max.   :1432.39   Max.   :45.000   Max.   :0.8590   Max.   :37.310   
                                                     NA's   :127      
     RelBA         Site.Trans      Latitude       Longitude     
 Min.   :0.000   HNKB   :6318   Min.   :36.76   Min.   :-81.31  
 1st Qu.:0.027   FLTC   :5346   1st Qu.:37.23   1st Qu.:-80.86  
 Median :0.051   HNKC   :5346   Median :37.91   Median :-79.84  
 Mean   :0.115   HNKA   :4617   Mean   :37.80   Mean   :-79.98  
 3rd Qu.:0.120   BLDC   :4374   3rd Qu.:38.32   3rd Qu.:-79.22  
 Max.   :1.000   IRNB   :4131   Max.   :38.57   Max.   :-79.16  
 NA's   :26806   (Other):8748   NA's   :20800   NA's   :20800   
      elev             flow            TPI            Tavg.X01    
 Min.   : 666.9   Min.   :0.006   Min.   :-0.234   Min.   :260.1  
 1st Qu.: 837.3   1st Qu.:0.013   1st Qu.:-0.099   1st Qu.:269.3  
 Median : 856.5   Median :0.028   Median :-0.025   Median :271.3  
 Mean   : 896.2   Mean   :0.220   Mean   : 0.022   Mean   :271.3  
 3rd Qu.: 952.4   3rd Qu.:0.061   3rd Qu.: 0.131   3rd Qu.:273.3  
 Max.   :1173.5   Max.   :1.419   Max.   : 0.300   Max.   :280.3  
 NA's   :20800    NA's   :20800   NA's   :20800    NA's   :20800  
    Tavg.X02        Tavg.X03        Tavg.X04        Tavg.X05    
 Min.   :263.0   Min.   :264.5   Min.   :274.6   Min.   :279.8  
 1st Qu.:270.1   1st Qu.:274.2   1st Qu.:280.2   1st Qu.:285.5  
 Median :272.2   Median :276.4   Median :282.0   Median :287.3  
 Mean   :272.0   Mean   :276.4   Mean   :282.0   Mean   :287.1  
 3rd Qu.:274.1   3rd Qu.:278.5   3rd Qu.:283.8   3rd Qu.:288.8  
 Max.   :278.0   Max.   :285.0   Max.   :287.7   Max.   :292.2  
 NA's   :20800   NA's   :20800   NA's   :20800   NA's   :20800  
    Tavg.X06        Tavg.X07        Tavg.X08        Tavg.X09    
 Min.   :285.0   Min.   :287.3   Min.   :285.8   Min.   :282.8  
 1st Qu.:289.9   1st Qu.:292.1   1st Qu.:291.2   1st Qu.:287.8  
 Median :291.1   Median :293.1   Median :292.5   Median :289.3  
 Mean   :291.1   Mean   :293.1   Mean   :292.4   Mean   :289.2  
 3rd Qu.:292.4   3rd Qu.:294.4   3rd Qu.:293.7   3rd Qu.:290.6  
 Max.   :296.2   Max.   :297.1   Max.   :297.3   Max.   :294.2  
 NA's   :20800   NA's   :20800   NA's   :20800   NA's   :20800  
    Tavg.X10        Tavg.X11        Tavg.X12     Tavg.X01.prev  
 Min.   :276.7   Min.   :271.5   Min.   :263.8   Min.   :260.1  
 1st Qu.:282.0   1st Qu.:276.4   1st Qu.:271.3   1st Qu.:269.3  
 Median :283.6   Median :277.8   Median :273.1   Median :271.3  
 Mean   :283.4   Mean   :277.7   Mean   :273.0   Mean   :271.3  
 3rd Qu.:284.8   3rd Qu.:279.1   3rd Qu.:274.8   3rd Qu.:273.3  
 Max.   :288.6   Max.   :283.4   Max.   :279.7   Max.   :280.3  
 NA's   :20800   NA's   :20800   NA's   :20800   NA's   :20960  
 Tavg.X02.prev   Tavg.X03.prev   Tavg.X04.prev   Tavg.X05.prev  
 Min.   :263.0   Min.   :264.5   Min.   :274.6   Min.   :279.8  
 1st Qu.:270.1   1st Qu.:274.2   1st Qu.:280.2   1st Qu.:285.5  
 Median :272.2   Median :276.4   Median :282.0   Median :287.3  
 Mean   :272.0   Mean   :276.3   Mean   :282.0   Mean   :287.1  
 3rd Qu.:274.1   3rd Qu.:278.5   3rd Qu.:283.7   3rd Qu.:288.8  
 Max.   :278.0   Max.   :285.0   Max.   :287.7   Max.   :292.2  
 NA's   :20960   NA's   :20960   NA's   :20960   NA's   :20960  
 Tavg.X06.prev   Tavg.X07.prev   Tavg.X08.prev   Tavg.X09.prev  
 Min.   :285.0   Min.   :287.3   Min.   :285.8   Min.   :282.8  
 1st Qu.:289.9   1st Qu.:292.1   1st Qu.:291.2   1st Qu.:287.8  
 Median :291.1   Median :293.1   Median :292.5   Median :289.3  
 Mean   :291.1   Mean   :293.1   Mean   :292.4   Mean   :289.2  
 3rd Qu.:292.4   3rd Qu.:294.3   3rd Qu.:293.7   3rd Qu.:290.6  
 Max.   :296.2   Max.   :297.1   Max.   :297.3   Max.   :294.2  
 NA's   :20960   NA's   :20960   NA's   :20960   NA's   :20960  
 Tavg.X10.prev   Tavg.X11.prev   Tavg.X12.prev     Precip.X01    
 Min.   :276.7   Min.   :271.5   Min.   :263.8   Min.   :  9.06  
 1st Qu.:282.0   1st Qu.:276.5   1st Qu.:271.2   1st Qu.: 54.02  
 Median :283.6   Median :277.8   Median :273.1   Median : 73.61  
 Mean   :283.4   Mean   :277.8   Mean   :272.9   Mean   : 80.17  
 3rd Qu.:284.8   3rd Qu.:279.1   3rd Qu.:274.7   3rd Qu.: 98.49  
 Max.   :288.6   Max.   :283.4   Max.   :279.7   Max.   :276.20  
 NA's   :20960   NA's   :20960   NA's   :20960   NA's   :20800   
   Precip.X02       Precip.X03        Precip.X04       Precip.X05    
 Min.   :  7.21   Min.   :  0.154   Min.   : 14.74   Min.   : 19.83  
 1st Qu.: 47.54   1st Qu.: 66.630   1st Qu.: 58.31   1st Qu.: 69.71  
 Median : 69.09   Median : 91.070   Median : 82.97   Median : 97.33  
 Mean   : 72.21   Mean   : 94.704   Mean   : 86.82   Mean   :101.94  
 3rd Qu.: 92.98   3rd Qu.:118.610   3rd Qu.:110.16   3rd Qu.:128.88  
 Max.   :209.15   Max.   :272.970   Max.   :238.54   Max.   :266.04  
 NA's   :20800    NA's   :20800     NA's   :20800    NA's   :20800   
   Precip.X06       Precip.X07       Precip.X08       Precip.X09    
 Min.   : 14.62   Min.   : 27.43   Min.   : 21.48   Min.   :  2.37  
 1st Qu.: 68.72   1st Qu.: 86.96   1st Qu.: 65.51   1st Qu.: 49.76  
 Median : 95.50   Median :108.06   Median : 90.53   Median : 77.29  
 Mean   :102.33   Mean   :114.52   Mean   : 99.99   Mean   : 87.34  
 3rd Qu.:127.47   3rd Qu.:136.16   3rd Qu.:126.23   3rd Qu.:111.74  
 Max.   :296.69   Max.   :423.43   Max.   :421.09   Max.   :324.42  
 NA's   :20800    NA's   :20800    NA's   :20800    NA's   :20800   
   Precip.X10       Precip.X11       Precip.X12     Precip.X01.prev 
 Min.   :  1.06   Min.   :  9.25   Min.   :  2.49   Min.   :  9.06  
 1st Qu.: 40.09   1st Qu.: 42.72   1st Qu.: 54.28   1st Qu.: 53.96  
 Median : 69.57   Median : 67.78   Median : 72.04   Median : 73.65  
 Mean   : 79.23   Mean   : 73.38   Mean   : 79.03   Mean   : 80.24  
 3rd Qu.:110.56   3rd Qu.: 97.92   3rd Qu.: 99.90   3rd Qu.: 98.71  
 Max.   :319.10   Max.   :354.36   Max.   :252.11   Max.   :276.20  
 NA's   :20800    NA's   :20800    NA's   :20800    NA's   :20960   
 Precip.X02.prev  Precip.X03.prev   Precip.X04.prev  Precip.X05.prev 
 Min.   :  7.21   Min.   :  0.154   Min.   : 14.74   Min.   : 19.83  
 1st Qu.: 47.70   1st Qu.: 66.130   1st Qu.: 57.77   1st Qu.: 69.51  
 Median : 69.09   Median : 90.510   Median : 82.94   Median : 96.90  
 Mean   : 72.38   Mean   : 94.440   Mean   : 86.88   Mean   :101.78  
 3rd Qu.: 93.08   3rd Qu.:116.950   3rd Qu.:110.42   3rd Qu.:128.88  
 Max.   :209.15   Max.   :272.970   Max.   :238.54   Max.   :266.04  
 NA's   :20960    NA's   :20960     NA's   :20960    NA's   :20960   
 Precip.X06.prev  Precip.X07.prev  Precip.X08.prev  Precip.X09.prev 
 Min.   : 14.62   Min.   : 27.43   Min.   : 21.48   Min.   :  2.37  
 1st Qu.: 68.72   1st Qu.: 86.92   1st Qu.: 65.37   1st Qu.: 49.62  
 Median : 95.96   Median :107.87   Median : 89.88   Median : 76.70  
 Mean   :102.67   Mean   :114.48   Mean   : 99.82   Mean   : 86.92  
 3rd Qu.:127.84   3rd Qu.:136.29   3rd Qu.:125.87   3rd Qu.:109.96  
 Max.   :296.69   Max.   :423.43   Max.   :421.09   Max.   :324.42  
 NA's   :20960    NA's   :20960    NA's   :20960    NA's   :20960   
 Precip.X10.prev  Precip.X11.prev  Precip.X12.prev   BA.tree.cm2     
 Min.   :  1.06   Min.   :  9.25   Min.   :  2.49   Min.   :   0.00  
 1st Qu.: 38.39   1st Qu.: 43.36   1st Qu.: 54.37   1st Qu.:   0.00  
 Median : 69.77   Median : 68.88   Median : 72.59   Median :   0.00  
 Mean   : 79.48   Mean   : 73.84   Mean   : 79.23   Mean   :  20.85  
 3rd Qu.:110.95   3rd Qu.: 98.25   3rd Qu.:100.53   3rd Qu.:  11.69  
 Max.   :319.10   Max.   :354.36   Max.   :252.11   Max.   :2247.39  
 NA's   :20960    NA's   :20960    NA's   :20960    NA's   :132      
> dim(nysy.all)
[1] 38880    90
> 
> # Subsetting only complete cases & a small range of years
> nysy.run <- nysy.all[complete.cases(nysy.all) & nysy.all$Year>=1990 & nysy.all$Year<=2011,]
> summary(nysy.run)
      Year          PlotID       TreeID     Site     Trans       Plot      
 Min.   :1990   HNKA3  :44   BLDB137: 22   BLD: 66   A:66   Min.   :1.000  
 1st Qu.:1995   BLDB1  :22   BLDC232: 22   FLT:  0   B:88   1st Qu.:2.000  
 Median :2000   BLDC2  :22   BLDC303: 22   HIK:  0   C:88   Median :3.000  
 Mean   :2000   BLDC3  :22   HNKA321: 22   HNK:110          Mean   :2.364  
 3rd Qu.:2006   HNKB2  :22   HNKA323: 22   IRN: 22          3rd Qu.:3.000  
 Max.   :2011   HNKB3  :22   HNKB228: 22   MOR: 44          Max.   :3.000  
                (Other):88   (Other):110                                   
      BAI                 CoreID    Pith       Pith.Yr         Inner     
 Min.   :   4.396   BLDB137HI: 22   N: 88   Min.   :1911   Min.   :1912  
 1st Qu.:  41.258   BLDC232HI: 22   Y:154   1st Qu.:1927   1st Qu.:1929  
 Median : 100.288   BLDC303HI: 22           Median :1934   Median :1935  
 Mean   : 187.372   HNKA321HI: 22           Mean   :1934   Mean   :1935  
 3rd Qu.: 276.456   HNKA323HI: 22           3rd Qu.:1941   3rd Qu.:1943  
 Max.   :1161.134   HNKB228HI: 22           Max.   :1953   Max.   :1954  
                    (Other)  :110                                        
     Outer      Bark    Use                        Notes     Pith.offset   
 Min.   :2011   N: 22   N:132   poor corr             :44   Min.   :1.000  
 1st Qu.:2012   Y:220   Y:110   1999 missing          :22   1st Qu.:1.000  
 Median :2012                   2010 & 2011 very small:22   Median :1.000  
 Mean   :2012                   b side measured       :22   Mean   :1.636  
 3rd Qu.:2012                   can't measure to pith :22   3rd Qu.:2.000  
 Max.   :2012                   cored twice           :22   Max.   :4.000  
                                (Other)               :88                  
      Tree            Spp           Genus     Canopy    Live    
 Min.   : 1.00   NYSY   :242   Nyssa   :242   C: 22   DEAD:  0  
 1st Qu.: 3.00   ACRU   :  0   Acer    :  0   D:  0   LIVE:242  
 Median :28.00   ACSA   :  0   Betula  :  0   I: 88             
 Mean   :23.91   BELE   :  0   Carya   :  0   U:132             
 3rd Qu.:36.00   BEPA   :  0   Castanea:  0                     
 Max.   :48.00   CADE   :  0   Cornus  :  0                     
                 (Other):  0   (Other) :  0                     
      Age            BA.m2ha          BAI.filled          BA.tree     
 Min.   : 37.00   Min.   :0.03480   Min.   :   4.396   Min.   : 1501  
 1st Qu.: 57.25   1st Qu.:0.08632   1st Qu.:  41.258   1st Qu.: 2468  
 Median : 66.00   Median :0.12319   Median : 100.288   Median : 4189  
 Mean   : 66.86   Mean   :0.17168   Mean   : 187.372   Mean   : 6509  
 3rd Qu.: 75.75   3rd Qu.:0.21674   3rd Qu.: 276.456   3rd Qu.: 7211  
 Max.   :100.00   Max.   :0.58586   Max.   :1161.134   Max.   :31113  
                                                                      
     Stems     Density.Ha    BAI.filled.plot    BA.plot       BA.m2ha.plot   
 Min.   :1   Min.   :18.83   Min.   : 3534   Min.   : 2340   Min.   : 2.887  
 1st Qu.:1   1st Qu.:22.10   1st Qu.: 8084   1st Qu.: 5378   1st Qu.:10.767  
 Median :1   Median :31.83   Median :11593   Median : 7521   Median :16.695  
 Mean   :1   Mean   :30.21   Mean   :14233   Mean   : 7863   Mean   :15.406  
 3rd Qu.:1   3rd Qu.:31.83   3rd Qu.:20426   3rd Qu.: 9825   3rd Qu.:19.907  
 Max.   :1   Max.   :49.74   Max.   :35507   Max.   :16174   Max.   :25.129  
                                                                             
 Density.ha.plot    Stems.plot   BAI.m2ha.plot    BA.m2ha.plot.live
 Min.   : 541.1   Min.   :17.0   Min.   :0.1125   Min.   : 4.816   
 1st Qu.: 640.4   1st Qu.:26.0   1st Qu.:0.2900   1st Qu.:15.000   
 Median : 891.3   Median :30.0   Median :0.3643   Median :18.545   
 Mean   : 841.2   Mean   :28.7   Mean   :0.3774   Mean   :18.462   
 3rd Qu.: 986.8   3rd Qu.:32.0   3rd Qu.:0.4767   3rd Qu.:23.275   
 Max.   :1094.2   Max.   :34.0   Max.   :0.8061   Max.   :30.940   
                                                                   
     RelBA            Site.Trans    Latitude       Longitude     
 Min.   :0.009991   BLDC   :44   Min.   :36.76   Min.   :-81.31  
 1st Qu.:0.024264   HNKA   :44   1st Qu.:37.73   1st Qu.:-80.11  
 Median :0.049496   HNKB   :44   Median :37.92   Median :-79.84  
 Mean   :0.069043   BLDB   :22   Mean   :37.96   Mean   :-79.75  
 3rd Qu.:0.102703   HNKC   :22   3rd Qu.:38.32   3rd Qu.:-79.23  
 Max.   :0.228873   IRNB   :22   Max.   :38.32   Max.   :-79.22  
                    (Other):44                                   
      elev             flow               TPI              Tavg.X01    
 Min.   : 666.9   Min.   :0.006178   Min.   :-0.21457   Min.   :264.6  
 1st Qu.: 837.3   1st Qu.:0.007416   1st Qu.:-0.11899   1st Qu.:269.8  
 Median : 880.1   Median :0.022656   Median : 0.02124   Median :271.5  
 Mean   : 886.2   Mean   :0.160070   Mean   : 0.03922   Mean   :271.6  
 3rd Qu.: 952.4   3rd Qu.:0.038805   3rd Qu.: 0.23650   3rd Qu.:273.6  
 Max.   :1151.5   Max.   :1.240813   Max.   : 0.28718   Max.   :276.7  
                                                                       
    Tavg.X02        Tavg.X03        Tavg.X04        Tavg.X05    
 Min.   :264.6   Min.   :268.6   Min.   :275.5   Min.   :280.2  
 1st Qu.:271.0   1st Qu.:274.9   1st Qu.:280.6   1st Qu.:285.1  
 Median :273.0   Median :276.4   Median :282.1   Median :286.6  
 Mean   :272.7   Mean   :276.3   Mean   :282.0   Mean   :286.6  
 3rd Qu.:274.6   3rd Qu.:278.1   3rd Qu.:283.4   3rd Qu.:288.2  
 Max.   :277.7   Max.   :281.2   Max.   :286.4   Max.   :291.7  
                                                                
    Tavg.X06        Tavg.X07        Tavg.X08        Tavg.X09    
 Min.   :285.8   Min.   :287.5   Min.   :287.4   Min.   :284.1  
 1st Qu.:290.2   1st Qu.:291.9   1st Qu.:291.4   1st Qu.:287.8  
 Median :291.0   Median :293.1   Median :292.6   Median :288.8  
 Mean   :291.0   Mean   :292.9   Mean   :292.4   Mean   :288.8  
 3rd Qu.:292.2   3rd Qu.:294.2   3rd Qu.:293.6   3rd Qu.:290.0  
 Max.   :294.8   Max.   :296.0   Max.   :295.8   Max.   :292.8  
                                                                
    Tavg.X10        Tavg.X11        Tavg.X12     Tavg.X01.prev  
 Min.   :278.5   Min.   :272.3   Min.   :265.8   Min.   :264.6  
 1st Qu.:282.1   1st Qu.:276.6   1st Qu.:271.7   1st Qu.:270.0  
 Median :283.4   Median :278.2   Median :273.7   Median :271.9  
 Mean   :283.1   Mean   :278.2   Mean   :273.4   Mean   :271.8  
 3rd Qu.:284.0   3rd Qu.:280.0   3rd Qu.:275.5   3rd Qu.:273.8  
 Max.   :287.8   Max.   :281.8   Max.   :277.6   Max.   :276.7  
                                                                
 Tavg.X02.prev   Tavg.X03.prev   Tavg.X04.prev   Tavg.X05.prev  
 Min.   :264.6   Min.   :268.6   Min.   :275.5   Min.   :280.2  
 1st Qu.:271.0   1st Qu.:274.9   1st Qu.:280.6   1st Qu.:284.8  
 Median :272.9   Median :276.4   Median :281.9   Median :286.4  
 Mean   :272.6   Mean   :276.3   Mean   :281.9   Mean   :286.5  
 3rd Qu.:274.5   3rd Qu.:278.1   3rd Qu.:283.2   3rd Qu.:288.0  
 Max.   :277.7   Max.   :281.2   Max.   :286.4   Max.   :291.7  
                                                                
 Tavg.X06.prev   Tavg.X07.prev   Tavg.X08.prev   Tavg.X09.prev  
 Min.   :285.8   Min.   :287.5   Min.   :287.4   Min.   :284.1  
 1st Qu.:290.2   1st Qu.:291.9   1st Qu.:291.2   1st Qu.:287.8  
 Median :290.9   Median :293.0   Median :292.5   Median :288.8  
 Mean   :291.0   Mean   :292.9   Mean   :292.4   Mean   :288.8  
 3rd Qu.:292.2   3rd Qu.:294.0   3rd Qu.:293.5   3rd Qu.:290.0  
 Max.   :294.8   Max.   :296.0   Max.   :295.8   Max.   :292.8  
                                                                
 Tavg.X10.prev   Tavg.X11.prev   Tavg.X12.prev     Precip.X01    
 Min.   :278.5   Min.   :272.3   Min.   :264.2   Min.   : 22.35  
 1st Qu.:282.1   1st Qu.:276.5   1st Qu.:271.5   1st Qu.: 56.04  
 Median :283.4   Median :278.0   Median :273.3   Median : 70.79  
 Mean   :283.2   Mean   :278.1   Mean   :273.0   Mean   : 85.98  
 3rd Qu.:284.0   3rd Qu.:279.8   3rd Qu.:275.4   3rd Qu.: 99.26  
 Max.   :287.8   Max.   :281.8   Max.   :277.6   Max.   :276.20  
                                                                 
   Precip.X02       Precip.X03       Precip.X04       Precip.X05    
 Min.   : 14.86   Min.   : 23.73   Min.   : 21.37   Min.   : 32.40  
 1st Qu.: 42.13   1st Qu.: 79.18   1st Qu.: 64.38   1st Qu.: 75.67  
 Median : 62.39   Median :100.09   Median : 97.89   Median :105.01  
 Mean   : 67.41   Mean   :104.89   Mean   : 92.46   Mean   :111.56  
 3rd Qu.: 76.66   3rd Qu.:122.38   3rd Qu.:116.94   3rd Qu.:142.05  
 Max.   :170.66   Max.   :210.02   Max.   :202.21   Max.   :219.08  
                                                                    
   Precip.X06       Precip.X07       Precip.X08       Precip.X09    
 Min.   : 25.00   Min.   : 34.97   Min.   : 32.19   Min.   :  4.60  
 1st Qu.: 62.99   1st Qu.: 75.56   1st Qu.: 67.86   1st Qu.: 57.23  
 Median : 88.39   Median :105.25   Median : 86.06   Median : 82.19  
 Mean   :100.65   Mean   :111.01   Mean   : 87.17   Mean   :104.49  
 3rd Qu.:118.78   3rd Qu.:133.33   3rd Qu.:107.25   3rd Qu.:135.34  
 Max.   :291.28   Max.   :292.53   Max.   :208.60   Max.   :294.62  
                                                                    
   Precip.X10       Precip.X11       Precip.X12     Precip.X01.prev 
 Min.   :  2.42   Min.   : 10.18   Min.   : 32.42   Min.   : 30.70  
 1st Qu.: 43.55   1st Qu.: 53.03   1st Qu.: 58.10   1st Qu.: 56.97  
 Median : 57.19   Median : 85.74   Median : 80.16   Median : 71.11  
 Mean   : 74.92   Mean   : 83.71   Mean   : 85.39   Mean   : 87.67  
 3rd Qu.:104.52   3rd Qu.:109.41   3rd Qu.:103.66   3rd Qu.: 99.26  
 Max.   :302.71   Max.   :206.61   Max.   :180.88   Max.   :276.20  
                                                                    
 Precip.X02.prev  Precip.X03.prev  Precip.X04.prev  Precip.X05.prev 
 Min.   : 14.86   Min.   : 23.73   Min.   : 21.37   Min.   : 32.40  
 1st Qu.: 45.81   1st Qu.: 76.78   1st Qu.: 64.38   1st Qu.: 75.67  
 Median : 65.89   Median : 97.64   Median : 94.30   Median :105.01  
 Mean   : 68.93   Mean   :103.00   Mean   : 89.70   Mean   :112.54  
 3rd Qu.: 77.62   3rd Qu.:118.86   3rd Qu.:113.35   3rd Qu.:146.63  
 Max.   :170.66   Max.   :210.02   Max.   :202.21   Max.   :219.08  
                                                                    
 Precip.X06.prev  Precip.X07.prev  Precip.X08.prev  Precip.X09.prev 
 Min.   : 25.00   Min.   : 34.97   Min.   : 32.19   Min.   :  4.60  
 1st Qu.: 63.67   1st Qu.: 78.82   1st Qu.: 68.21   1st Qu.: 57.23  
 Median : 93.25   Median :107.36   Median : 86.84   Median : 82.19  
 Mean   :105.02   Mean   :114.84   Mean   : 90.03   Mean   :106.04  
 3rd Qu.:131.33   3rd Qu.:135.72   3rd Qu.:110.59   3rd Qu.:135.34  
 Max.   :291.28   Max.   :292.53   Max.   :208.60   Max.   :294.62  
                                                                    
 Precip.X10.prev  Precip.X11.prev  Precip.X12.prev   BA.tree.cm2    
 Min.   :  2.42   Min.   : 10.18   Min.   : 32.42   Min.   : 15.01  
 1st Qu.: 43.55   1st Qu.: 53.03   1st Qu.: 56.54   1st Qu.: 24.68  
 Median : 57.19   Median : 83.51   Median : 77.38   Median : 41.89  
 Mean   : 76.52   Mean   : 82.72   Mean   : 82.92   Mean   : 65.09  
 3rd Qu.:110.28   3rd Qu.:108.75   3rd Qu.: 99.80   3rd Qu.: 72.11  
 Max.   :302.71   Max.   :206.61   Max.   :180.88   Max.   :311.13  
                                                                    
> dim(nysy.run)
[1] 242  90
> 
> #############
> # Vector with names of Months of the year
> months <- c("X01", "X02", "X03", "X04", "X05", "X06", "X07", "X08", "X09", "X10", "X11", "X12")
> 
> # Selecting which previous and current year months to include in model
> months.prev <- paste(months[6:12], "prev", sep=".") # Previous June through December
> months.curr <- paste(months[1:10], sep=".") # Current Junuary through October
> months.use <- c(months.prev, months.curr)
> 
> seasons <- c("pX06.pX08", "pX09.pX11", "pX12.X02", "X03.X05", "X06.X08", "X09.X11")
> seasons
[1] "pX06.pX08" "pX09.pX11" "pX12.X02"  "X03.X05"   "X06.X08"   "X09.X11"  
> 
> nysy.run$Tavg.pX06.pX08 <- rowMeans(nysy.run[,c("Tavg.X06.prev", "Tavg.X07.prev", "Tavg.X08.prev")])
> nysy.run$Tavg.pX09.pX11 <- rowMeans(nysy.run[,c("Tavg.X09.prev", "Tavg.X10.prev", "Tavg.X11.prev")])
> nysy.run$Tavg.pX12.X02 <- rowMeans(nysy.run[,c("Tavg.X12.prev", "Tavg.X01", "Tavg.X02")])
> nysy.run$Tavg.X03.X05 <- rowMeans(nysy.run[,c("Tavg.X03", "Tavg.X04", "Tavg.X05")])
> nysy.run$Tavg.X06.X08 <- rowMeans(nysy.run[,c("Tavg.X06", "Tavg.X07", "Tavg.X08")])
> nysy.run$Tavg.X09.X11 <- rowMeans(nysy.run[,c("Tavg.X09", "Tavg.X10", "Tavg.X11")])
> 
> nysy.run$Precip.pX06.pX08 <- rowMeans(nysy.run[,c("Precip.X06.prev", "Precip.X07.prev", "Precip.X08.prev")])
> nysy.run$Precip.pX09.pX11 <- rowMeans(nysy.run[,c("Precip.X09.prev", "Precip.X10.prev", "Precip.X11.prev")])
> nysy.run$Precip.pX12.X02 <- rowMeans(nysy.run[,c("Precip.X12.prev", "Precip.X01", "Precip.X02")])
> nysy.run$Precip.X03.X05 <- rowMeans(nysy.run[,c("Precip.X03", "Precip.X04", "Precip.X05")])
> nysy.run$Precip.X06.X08 <- rowMeans(nysy.run[,c("Precip.X06", "Precip.X07", "Precip.X08")])
> nysy.run$Precip.X09.X11 <- rowMeans(nysy.run[,c("Precip.X09", "Precip.X10", "Precip.X11")])
> 
> 
> # Making vectors with the column names of the temp & precip months of interest
> temp.col <- paste("Tavg", seasons, sep=".")
> precip.col <- paste("Precip", seasons, sep=".")
> 
> # Column numbers of temp & precip months of interest
> temp.col.ind <- which(names(nysy.run) %in% c(temp.col))
> precip.col.ind <- which(names(nysy.run) %in% c(precip.col))
> summary(nysy.run[,temp.col.ind])
 Tavg.pX06.pX08  Tavg.pX09.pX11  Tavg.pX12.X02    Tavg.X03.X05  
 Min.   :287.7   Min.   :279.0   Min.   :267.1   Min.   :276.1  
 1st Qu.:291.2   1st Qu.:282.6   1st Qu.:271.2   1st Qu.:280.5  
 Median :292.2   Median :283.5   Median :272.5   Median :281.5  
 Mean   :292.1   Mean   :283.4   Mean   :272.4   Mean   :281.6  
 3rd Qu.:293.1   3rd Qu.:284.3   3rd Qu.:273.9   3rd Qu.:282.9  
 Max.   :295.2   Max.   :286.0   Max.   :275.7   Max.   :285.8  
  Tavg.X06.X08    Tavg.X09.X11  
 Min.   :287.7   Min.   :279.0  
 1st Qu.:291.2   1st Qu.:282.6  
 Median :292.3   Median :283.5  
 Mean   :292.1   Mean   :283.4  
 3rd Qu.:293.1   3rd Qu.:284.3  
 Max.   :295.2   Max.   :286.0  
> summary(nysy.run[,precip.col.ind])
 Precip.pX06.pX08 Precip.pX09.pX11 Precip.pX12.X02  Precip.X03.X05  
 Min.   : 55.85   Min.   : 27.34   Min.   : 31.29   Min.   : 54.93  
 1st Qu.: 84.30   1st Qu.: 60.85   1st Qu.: 61.06   1st Qu.: 87.18  
 Median : 98.22   Median : 89.45   Median : 74.35   Median :103.63  
 Mean   :103.30   Mean   : 88.43   Mean   : 78.77   Mean   :102.97  
 3rd Qu.:119.72   3rd Qu.:116.94   3rd Qu.: 99.59   3rd Qu.:116.60  
 Max.   :210.60   Max.   :160.03   Max.   :152.56   Max.   :172.95  
 Precip.X06.X08   Precip.X09.X11  
 Min.   : 55.85   Min.   : 27.34  
 1st Qu.: 80.16   1st Qu.: 60.85  
 Median : 96.44   Median : 89.45  
 Mean   : 99.61   Mean   : 87.71  
 3rd Qu.:114.97   3rd Qu.:110.46  
 Max.   :183.68   Max.   :153.74  
> length(temp.col.ind)
[1] 6
> 
> # nysy.run$Tavg.yr <- rowMeans(nysy.run[,temp.col.ind])
> # nysy.run$Precip.yr <- rowSums(nysy.run[,precip.col.ind])
> 
> write.csv(nysy.run, "Inputs/NYSY_AllSites_1990-2011.csv", row.names=F)
> 
> #############
> # Reading in Data
> nysy.run <- read.csv("Inputs/NYSY_AllSites_1990-2011.csv")
> summary(nysy.run)
      Year          PlotID       TreeID     Site     Trans       Plot      
 Min.   :1990   HNKA3  :44   BLDB137: 22   BLD: 66   A:66   Min.   :1.000  
 1st Qu.:1995   BLDB1  :22   BLDC232: 22   HNK:110   B:88   1st Qu.:2.000  
 Median :2000   BLDC2  :22   BLDC303: 22   IRN: 22   C:88   Median :3.000  
 Mean   :2000   BLDC3  :22   HNKA321: 22   MOR: 44          Mean   :2.364  
 3rd Qu.:2006   HNKB2  :22   HNKA323: 22                    3rd Qu.:3.000  
 Max.   :2011   HNKB3  :22   HNKB228: 22                    Max.   :3.000  
                (Other):88   (Other):110                                   
      BAI                 CoreID    Pith       Pith.Yr         Inner     
 Min.   :   4.396   BLDB137HI: 22   N: 88   Min.   :1911   Min.   :1912  
 1st Qu.:  41.258   BLDC232HI: 22   Y:154   1st Qu.:1927   1st Qu.:1929  
 Median : 100.288   BLDC303HI: 22           Median :1934   Median :1935  
 Mean   : 187.372   HNKA321HI: 22           Mean   :1934   Mean   :1935  
 3rd Qu.: 276.456   HNKA323HI: 22           3rd Qu.:1941   3rd Qu.:1943  
 Max.   :1161.134   HNKB228HI: 22           Max.   :1953   Max.   :1954  
                    (Other)  :110                                        
     Outer      Bark    Use                        Notes     Pith.offset   
 Min.   :2011   N: 22   N:132   poor corr             :44   Min.   :1.000  
 1st Qu.:2012   Y:220   Y:110   1999 missing          :22   1st Qu.:1.000  
 Median :2012                   2010 & 2011 very small:22   Median :1.000  
 Mean   :2012                   b side measured       :22   Mean   :1.636  
 3rd Qu.:2012                   can't measure to pith :22   3rd Qu.:2.000  
 Max.   :2012                   cored twice           :22   Max.   :4.000  
                                (Other)               :88                  
      Tree         Spp        Genus     Canopy    Live          Age        
 Min.   : 1.00   NYSY:242   Nyssa:242   C: 22   LIVE:242   Min.   : 37.00  
 1st Qu.: 3.00                          I: 88              1st Qu.: 57.25  
 Median :28.00                          U:132              Median : 66.00  
 Mean   :23.91                                             Mean   : 66.86  
 3rd Qu.:36.00                                             3rd Qu.: 75.75  
 Max.   :48.00                                             Max.   :100.00  
                                                                           
    BA.m2ha          BAI.filled          BA.tree          Stems  
 Min.   :0.03480   Min.   :   4.396   Min.   : 1501   Min.   :1  
 1st Qu.:0.08632   1st Qu.:  41.258   1st Qu.: 2468   1st Qu.:1  
 Median :0.12319   Median : 100.288   Median : 4189   Median :1  
 Mean   :0.17168   Mean   : 187.372   Mean   : 6509   Mean   :1  
 3rd Qu.:0.21674   3rd Qu.: 276.456   3rd Qu.: 7211   3rd Qu.:1  
 Max.   :0.58586   Max.   :1161.134   Max.   :31113   Max.   :1  
                                                                 
   Density.Ha    BAI.filled.plot    BA.plot       BA.m2ha.plot   
 Min.   :18.83   Min.   : 3534   Min.   : 2340   Min.   : 2.887  
 1st Qu.:22.10   1st Qu.: 8084   1st Qu.: 5378   1st Qu.:10.767  
 Median :31.83   Median :11593   Median : 7521   Median :16.695  
 Mean   :30.21   Mean   :14233   Mean   : 7863   Mean   :15.406  
 3rd Qu.:31.83   3rd Qu.:20426   3rd Qu.: 9825   3rd Qu.:19.907  
 Max.   :49.74   Max.   :35507   Max.   :16174   Max.   :25.129  
                                                                 
 Density.ha.plot    Stems.plot   BAI.m2ha.plot    BA.m2ha.plot.live
 Min.   : 541.1   Min.   :17.0   Min.   :0.1125   Min.   : 4.816   
 1st Qu.: 640.4   1st Qu.:26.0   1st Qu.:0.2900   1st Qu.:15.000   
 Median : 891.3   Median :30.0   Median :0.3643   Median :18.545   
 Mean   : 841.2   Mean   :28.7   Mean   :0.3774   Mean   :18.462   
 3rd Qu.: 986.8   3rd Qu.:32.0   3rd Qu.:0.4767   3rd Qu.:23.275   
 Max.   :1094.2   Max.   :34.0   Max.   :0.8061   Max.   :30.940   
                                                                   
     RelBA            Site.Trans    Latitude       Longitude     
 Min.   :0.009991   BLDC   :44   Min.   :36.76   Min.   :-81.31  
 1st Qu.:0.024264   HNKA   :44   1st Qu.:37.73   1st Qu.:-80.11  
 Median :0.049496   HNKB   :44   Median :37.92   Median :-79.84  
 Mean   :0.069043   BLDB   :22   Mean   :37.96   Mean   :-79.75  
 3rd Qu.:0.102703   HNKC   :22   3rd Qu.:38.32   3rd Qu.:-79.23  
 Max.   :0.228873   IRNB   :22   Max.   :38.32   Max.   :-79.22  
                    (Other):44                                   
      elev             flow               TPI              Tavg.X01    
 Min.   : 666.9   Min.   :0.006178   Min.   :-0.21457   Min.   :264.6  
 1st Qu.: 837.3   1st Qu.:0.007416   1st Qu.:-0.11899   1st Qu.:269.8  
 Median : 880.1   Median :0.022656   Median : 0.02124   Median :271.5  
 Mean   : 886.2   Mean   :0.160070   Mean   : 0.03922   Mean   :271.6  
 3rd Qu.: 952.4   3rd Qu.:0.038805   3rd Qu.: 0.23650   3rd Qu.:273.6  
 Max.   :1151.5   Max.   :1.240813   Max.   : 0.28718   Max.   :276.7  
                                                                       
    Tavg.X02        Tavg.X03        Tavg.X04        Tavg.X05    
 Min.   :264.6   Min.   :268.6   Min.   :275.5   Min.   :280.2  
 1st Qu.:271.0   1st Qu.:274.9   1st Qu.:280.6   1st Qu.:285.1  
 Median :273.0   Median :276.4   Median :282.1   Median :286.6  
 Mean   :272.7   Mean   :276.3   Mean   :282.0   Mean   :286.6  
 3rd Qu.:274.6   3rd Qu.:278.1   3rd Qu.:283.4   3rd Qu.:288.2  
 Max.   :277.7   Max.   :281.2   Max.   :286.4   Max.   :291.7  
                                                                
    Tavg.X06        Tavg.X07        Tavg.X08        Tavg.X09    
 Min.   :285.8   Min.   :287.5   Min.   :287.4   Min.   :284.1  
 1st Qu.:290.2   1st Qu.:291.9   1st Qu.:291.4   1st Qu.:287.8  
 Median :291.0   Median :293.1   Median :292.6   Median :288.8  
 Mean   :291.0   Mean   :292.9   Mean   :292.4   Mean   :288.8  
 3rd Qu.:292.2   3rd Qu.:294.2   3rd Qu.:293.6   3rd Qu.:290.0  
 Max.   :294.8   Max.   :296.0   Max.   :295.8   Max.   :292.8  
                                                                
    Tavg.X10        Tavg.X11        Tavg.X12     Tavg.X01.prev  
 Min.   :278.5   Min.   :272.3   Min.   :265.8   Min.   :264.6  
 1st Qu.:282.1   1st Qu.:276.6   1st Qu.:271.7   1st Qu.:270.0  
 Median :283.4   Median :278.2   Median :273.7   Median :271.9  
 Mean   :283.1   Mean   :278.2   Mean   :273.4   Mean   :271.8  
 3rd Qu.:284.0   3rd Qu.:280.0   3rd Qu.:275.5   3rd Qu.:273.8  
 Max.   :287.8   Max.   :281.8   Max.   :277.6   Max.   :276.7  
                                                                
 Tavg.X02.prev   Tavg.X03.prev   Tavg.X04.prev   Tavg.X05.prev  
 Min.   :264.6   Min.   :268.6   Min.   :275.5   Min.   :280.2  
 1st Qu.:271.0   1st Qu.:274.9   1st Qu.:280.6   1st Qu.:284.8  
 Median :272.9   Median :276.4   Median :281.9   Median :286.4  
 Mean   :272.6   Mean   :276.3   Mean   :281.9   Mean   :286.5  
 3rd Qu.:274.5   3rd Qu.:278.1   3rd Qu.:283.2   3rd Qu.:288.0  
 Max.   :277.7   Max.   :281.2   Max.   :286.4   Max.   :291.7  
                                                                
 Tavg.X06.prev   Tavg.X07.prev   Tavg.X08.prev   Tavg.X09.prev  
 Min.   :285.8   Min.   :287.5   Min.   :287.4   Min.   :284.1  
 1st Qu.:290.2   1st Qu.:291.9   1st Qu.:291.2   1st Qu.:287.8  
 Median :290.9   Median :293.0   Median :292.5   Median :288.8  
 Mean   :291.0   Mean   :292.9   Mean   :292.4   Mean   :288.8  
 3rd Qu.:292.2   3rd Qu.:294.0   3rd Qu.:293.5   3rd Qu.:290.0  
 Max.   :294.8   Max.   :296.0   Max.   :295.8   Max.   :292.8  
                                                                
 Tavg.X10.prev   Tavg.X11.prev   Tavg.X12.prev     Precip.X01    
 Min.   :278.5   Min.   :272.3   Min.   :264.2   Min.   : 22.35  
 1st Qu.:282.1   1st Qu.:276.5   1st Qu.:271.5   1st Qu.: 56.04  
 Median :283.4   Median :278.0   Median :273.3   Median : 70.79  
 Mean   :283.2   Mean   :278.1   Mean   :273.0   Mean   : 85.98  
 3rd Qu.:284.0   3rd Qu.:279.8   3rd Qu.:275.4   3rd Qu.: 99.26  
 Max.   :287.8   Max.   :281.8   Max.   :277.6   Max.   :276.20  
                                                                 
   Precip.X02       Precip.X03       Precip.X04       Precip.X05    
 Min.   : 14.86   Min.   : 23.73   Min.   : 21.37   Min.   : 32.40  
 1st Qu.: 42.13   1st Qu.: 79.18   1st Qu.: 64.38   1st Qu.: 75.67  
 Median : 62.39   Median :100.09   Median : 97.89   Median :105.01  
 Mean   : 67.41   Mean   :104.89   Mean   : 92.46   Mean   :111.56  
 3rd Qu.: 76.66   3rd Qu.:122.38   3rd Qu.:116.94   3rd Qu.:142.05  
 Max.   :170.66   Max.   :210.02   Max.   :202.21   Max.   :219.08  
                                                                    
   Precip.X06       Precip.X07       Precip.X08       Precip.X09    
 Min.   : 25.00   Min.   : 34.97   Min.   : 32.19   Min.   :  4.60  
 1st Qu.: 62.99   1st Qu.: 75.56   1st Qu.: 67.86   1st Qu.: 57.23  
 Median : 88.39   Median :105.25   Median : 86.06   Median : 82.19  
 Mean   :100.65   Mean   :111.01   Mean   : 87.17   Mean   :104.49  
 3rd Qu.:118.78   3rd Qu.:133.33   3rd Qu.:107.25   3rd Qu.:135.34  
 Max.   :291.28   Max.   :292.53   Max.   :208.60   Max.   :294.62  
                                                                    
   Precip.X10       Precip.X11       Precip.X12     Precip.X01.prev 
 Min.   :  2.42   Min.   : 10.18   Min.   : 32.42   Min.   : 30.70  
 1st Qu.: 43.55   1st Qu.: 53.03   1st Qu.: 58.10   1st Qu.: 56.97  
 Median : 57.19   Median : 85.74   Median : 80.16   Median : 71.11  
 Mean   : 74.92   Mean   : 83.71   Mean   : 85.39   Mean   : 87.67  
 3rd Qu.:104.52   3rd Qu.:109.41   3rd Qu.:103.66   3rd Qu.: 99.26  
 Max.   :302.71   Max.   :206.61   Max.   :180.88   Max.   :276.20  
                                                                    
 Precip.X02.prev  Precip.X03.prev  Precip.X04.prev  Precip.X05.prev 
 Min.   : 14.86   Min.   : 23.73   Min.   : 21.37   Min.   : 32.40  
 1st Qu.: 45.81   1st Qu.: 76.78   1st Qu.: 64.38   1st Qu.: 75.67  
 Median : 65.89   Median : 97.64   Median : 94.30   Median :105.01  
 Mean   : 68.93   Mean   :103.00   Mean   : 89.70   Mean   :112.54  
 3rd Qu.: 77.62   3rd Qu.:118.86   3rd Qu.:113.35   3rd Qu.:146.63  
 Max.   :170.66   Max.   :210.02   Max.   :202.21   Max.   :219.08  
                                                                    
 Precip.X06.prev  Precip.X07.prev  Precip.X08.prev  Precip.X09.prev 
 Min.   : 25.00   Min.   : 34.97   Min.   : 32.19   Min.   :  4.60  
 1st Qu.: 63.67   1st Qu.: 78.82   1st Qu.: 68.21   1st Qu.: 57.23  
 Median : 93.25   Median :107.36   Median : 86.84   Median : 82.19  
 Mean   :105.02   Mean   :114.84   Mean   : 90.03   Mean   :106.04  
 3rd Qu.:131.33   3rd Qu.:135.72   3rd Qu.:110.59   3rd Qu.:135.34  
 Max.   :291.28   Max.   :292.53   Max.   :208.60   Max.   :294.62  
                                                                    
 Precip.X10.prev  Precip.X11.prev  Precip.X12.prev   BA.tree.cm2    
 Min.   :  2.42   Min.   : 10.18   Min.   : 32.42   Min.   : 15.01  
 1st Qu.: 43.55   1st Qu.: 53.03   1st Qu.: 56.54   1st Qu.: 24.68  
 Median : 57.19   Median : 83.51   Median : 77.38   Median : 41.89  
 Mean   : 76.52   Mean   : 82.72   Mean   : 82.92   Mean   : 65.09  
 3rd Qu.:110.28   3rd Qu.:108.75   3rd Qu.: 99.80   3rd Qu.: 72.11  
 Max.   :302.71   Max.   :206.61   Max.   :180.88   Max.   :311.13  
                                                                    
 Tavg.pX06.pX08  Tavg.pX09.pX11  Tavg.pX12.X02    Tavg.X03.X05  
 Min.   :287.7   Min.   :279.0   Min.   :267.1   Min.   :276.1  
 1st Qu.:291.2   1st Qu.:282.6   1st Qu.:271.2   1st Qu.:280.5  
 Median :292.2   Median :283.5   Median :272.5   Median :281.5  
 Mean   :292.1   Mean   :283.4   Mean   :272.4   Mean   :281.6  
 3rd Qu.:293.1   3rd Qu.:284.3   3rd Qu.:273.9   3rd Qu.:282.9  
 Max.   :295.2   Max.   :286.0   Max.   :275.7   Max.   :285.8  
                                                                
  Tavg.X06.X08    Tavg.X09.X11   Precip.pX06.pX08 Precip.pX09.pX11
 Min.   :287.7   Min.   :279.0   Min.   : 55.85   Min.   : 27.34  
 1st Qu.:291.2   1st Qu.:282.6   1st Qu.: 84.30   1st Qu.: 60.85  
 Median :292.3   Median :283.5   Median : 98.22   Median : 89.45  
 Mean   :292.1   Mean   :283.4   Mean   :103.30   Mean   : 88.43  
 3rd Qu.:293.1   3rd Qu.:284.3   3rd Qu.:119.72   3rd Qu.:116.94  
 Max.   :295.2   Max.   :286.0   Max.   :210.60   Max.   :160.03  
                                                                  
 Precip.pX12.X02  Precip.X03.X05   Precip.X06.X08   Precip.X09.X11  
 Min.   : 31.29   Min.   : 54.93   Min.   : 55.85   Min.   : 27.34  
 1st Qu.: 61.06   1st Qu.: 87.18   1st Qu.: 80.16   1st Qu.: 60.85  
 Median : 74.35   Median :103.63   Median : 96.44   Median : 89.45  
 Mean   : 78.77   Mean   :102.97   Mean   : 99.61   Mean   : 87.71  
 3rd Qu.: 99.59   3rd Qu.:116.60   3rd Qu.:114.97   3rd Qu.:110.46  
 Max.   :152.56   Max.   :172.95   Max.   :183.68   Max.   :153.74  
                                                                    
> 
> # Loading previous runs
> #load(file="Test results for NYSY 4 - All Sites 1990-2011.Rdata")
> 
> 
> ####################################################################################################################
> overall.model <- function(
+ 							   SIZE,aa,ab, gmax,             # Autogenic (a) -- ABSOLUTE UNITS (from gmax)
+                             BA.PLOT,RS,ca,cb,cc,cd,ce,cf,cg, # Competition (c) -- scalar
+                             # # BA.PLOT,RS,ca,cb,cc,cd,cf,cg, # Competition (c) -- scalar, removed intercept
+                             TEMP,ta1,tb1,					 # Temperature (t) -- scalar
+                             PRECIP,FLOW,pa1,pb1,pc1         		 # Preciptiation (p) -- scalar
+                             # TRANS, ha		             	 # Habitat (h) -- scalar
+                             )
+ 	{
+ 	################
+ 	# Autogenic Growth: 0-1 * gmax (max possible growth, absolute units)
+ 	################
+ 	autogenic.effect <- gmax*(1 - aa*exp(-ab*SIZE))   
+ 	# autogenic.effect <- gmax*(1-aa*exp(-ab*SIZE))   
+ 
+ 
+ 	################
+ 	# Competition Effect: 0-1 
+ 	################
+ 	size.effect <- ca*exp(-cb*(RS^cc))
+ 	comp.effect <- (ce/1000 + ( (1-ce/1000)/(1+(BA.PLOT/cf)^cg)))
+ 	# comp.effect <- (1/(1+(BA.PLOT/cf)^cg))
+ 	comp.response <- exp(-size.effect*(comp.effect^cd))
+ 
+  	################
+ 	# Climate Effect: Now Scalar
+ 	################
+ 	
+ 	#Temp on scale 0-1
+     temp.effect <- t(exp(-0.5*((t(TEMP)-ta1)/tb1)^2))
+ 
+     # Precip on scale 0-1
+     # precip.effect <- t(1/(1+(t(PRECIP)/pa1)^pb1))
+ 	precip.effect <- t(exp(-0.5*((t(PRECIP+pc1*FLOW*PRECIP)-pa1)/pb1)^2)) # Gaussian Data Frame
+ 
+ 	# Multiplying temp & precip together
+     climate.effect <- temp.effect * precip.effect
+ 	 
+ 	 ### LEM: do row sums
+ 	 ##### CRR note: I think this should be on a scale from 0-1; 
+      # climate.effect <- colSums(climate.effect) 
+ 	 climate.effect2 <- apply(climate.effect, 1, FUN=prod)
+ 	
+ 
+ 	################
+ 	# Habitat Effect: 0-1
+ 	# Note: removed from model for the moment, may add Topographic position or upslope area later
+ 	################
+ 	# habitat.effect <- ha[TRANS]
+ 
+ 	# comp.response <- 1
+ 	habitat.effect <- 1
+ 	# climate.effect2 <- precip.effect
+ 
+ 	autogenic.effect*comp.response*habitat.effect*climate.effect2
+ 	
+ 
+ 	}
> 
> 
> ####################################################################################################################
> ####################################################################################################################
> ### setting up annealing
> 
> # par <- results$best_par
> 
> # need a list that gives initial values for all of the "parameters"
> par<-list(
+ 		  aa=1, ab=0.00383, gmax=5500,  	# Autogenic
+           ca=1.562, cb=871.4, cc=2.04, cd=0.617, ce=217.5, cf=139.6, cg=680.374,  # Competition
+           ta1=c(296.96,	283.84,	279.82,	291.35,	325,		291.66), 
+           tb1=c(31.55,	3.42,	10.4,	17.82,	47.40,	11.58),
+           pa1=c(500,	1.16,	466.64,	121.31,	113.99,	335.36), 
+           pb1=c(570.22,	1302.86,655.72,	1749.49,55.56,	731.587), 
+           pc1=0.18368, 
+           # # ha=rep(0.5,3),  # Habitat
+           sd=86.108)
> 
> # also need a list that identifies the independent variables
> var <- list(SIZE = "BA.tree.cm2",  # Autogenic
+             BA.PLOT="BA.m2ha.plot.live", RS="RelBA",  # Competition
+             TEMP = nysy.run[,temp.col.ind], # hard-coded above
+             PRECIP = nysy.run[,precip.col.ind], FLOW="flow"
+             # TRANS="Site.Trans" # Habitat
+             )
> 
> ## Set bounds and initial search ranges within which to search for parameters
> ##   NOTE:  the s and sd parameters have to be greater than zero (algebraically)
> par_lo <-list(
+ 			  aa=0, ab=0, gmax=0,  # Autogenic
+               ca=0, cb=0, cc=0, cd=0, ce=0, cf=-100, cg=-1000, # Competition
+               # # ca=0, cb=0, cc=0, cd=0, cf=-100, cg=-200, # Competition
+               ta1=rep(250, length=length(temp.col.ind)), tb1=rep(0, length=length(temp.col.ind)),
+               pa1=rep(0, length=length(precip.col.ind)), pb1=rep(0, length=length(precip.col.ind)), pc1=0,
+ 			# ha=rep(0,3), # Habitat
+               sd=0.1)
> 
> 
> par_hi <-list(
+ 			  aa=1, ab=1000, gmax=10000, # Autogenic
+               ca=2000, cb=1000, cc=5, cd=5, ce=1000, cf=1000, cg=1000,	# Competition
+               # # ca=1000, cb=1000, cc=50, cd=5, cf=500, cg=1000,	# Competition
+               ta1=rep(325, length=length(temp.col.ind)), tb1=rep(500, length=length(temp.col.ind)),
+               pa1=rep(500, length=length(precip.col.ind)), pb1=rep(2000, length=length(precip.col.ind)), pc1=1,
+               # ha=rep(1,3), # Habitat
+               sd=1000)
> 
> ## Specify the dependent variable, and name it using whatever
> ##    argument name is used in the pdf ("x" in the normal.pdf function above)
> var$x<-"BAI"
> 
> ## predicted value in your PDF should be given the reserved name "predicted"
> ##   Anneal will use your scientific model and your data and calculate the
> ##   predicted value for each observation and store it internally in an object
> ##   called "predicted"
> var$mean<-"predicted"
> 
> ## Have it calculate log likelihood
> var$log<-TRUE
> 
> ##  now call the annealing algorithm, choosing which model to use
> #  "data" should be whatever the name of your dataframe is...
> results <- anneal(overall.model, par, var, nysy.run, par_lo, par_hi, dnorm, "BAI", hessian = T, slimit=1.92, max_iter=100000)
> 
> save(results,file=file.path("Outputs", paste( run.label, "_Results.Rdata", sep="")))
> 
> write_results(results,file.path("Outputs", paste( run.label, "_Results.txt", sep="")))
> 
> ## display some of the results in the console
> results$best_pars;
$aa
[1] 1

$ab
[1] 0.003311582

$gmax
[1] 8910.172

$ca
[1] 1998.747

$cb
[1] 1000

$cc
[1] 1.952239

$cd
[1] 0.01191406

$ce
[1] 1.092629e-245

$cf
[1] 868.215

$cg
[1] -990.549

$ta1
[1] 300.1795 283.2973 291.3306 253.8385 296.8677 286.4461

$tb1
[1]  10.600853   3.789472  16.182417 127.745698   6.930804   9.879325

$pa1
[1] 320.6087867  23.9403868  95.2892999 496.7295668 117.7038154   0.2209869

$pb1
[1]  300.00929  220.49015   80.25325 1187.54734   60.10143  780.01967

$pc1
[1] 8.862909e-05

$sd
[1] 79.41273

> results$max_likeli;
[1] -1402.095
> results$aic_corr ;
[1] 2889.186
> results$slope;
[1] 0.9979964
> results$R2
[1] 0.8586826
> 
> ####################################################################################################################
> ####################################################################################################################
> load(file=file.path("Outputs", paste( run.label, "_Results.Rdata", sep="")))
> 
> 
> # Looking at Residuals and Parameters
> #windows()
> plot(results$source_data$predicted,results$source_data$BAI,xlab="Predicted",ylab="Observed")
> abline(0,1,lwd=2,col="red")
> 
> results$source_data$residual <- results$source_data$BAI - results$source_data$predicted
> #windows()
> hist(results$source_data$residual)
> 
> 
> ##################################
> autogenic.effect <- function(SIZE,aa,ab) { (1 - aa*exp(-ab*SIZE))  }
> ##################################
> plot(BAI ~ BA.tree.cm2, data=results$source_data)
> plot(BAI ~ Age, data=results$source_data)
> plot(BA.tree.cm2 ~ Age, data=results$source_data)
> 
> summary(results$source_data$BA.tree.cm2)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  15.01   24.68   41.89   65.09   72.11  311.10 
> summary(results$source_data$Age)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  37.00   57.25   66.00   66.86   75.75  100.00 
> 
> # Effect of Tree Basal Area
> #windows()
> par(mar=c(5,5,4,2), mfrow=c(1,1))
> x <- seq(0,max(ceiling(results$source_data$BA.tree.cm2)),1)
> y <- autogenic.effect(x,results$best_pars$aa,results$best_pars$ab)
> 
> pdf(file.path("Figures", paste(run.label, " - Autogenic Scalar.pdf", sep="")))
> plot(x,y,ylim=c(0,1),xlab="Tree Basal Area (cm2)",ylab="Effect of Size on Growth",
+      cex.axis=1.25,cex.lab=1.5,type="l",lwd=2,main=run.label)
> dev.off()
pdf 
  2 
> 
> 
> #################################
> size.effect <- function(SIZE,ca,cb,cc) {ca*exp(-cb*(SIZE^cc))}
> comp.effect <- function(BA.PLOT,ce,cf,cg) {ce/1000 + ( (1-ce/1000)/(1+(BA.PLOT/cf)^cg))}
> comp.response <- function(SIZE,BA.PLOT,ca,cb,cc,cd,ce,cf,cg)
+   { size.effect <- ca*exp(-cb*(SIZE^cc))
+     comp.effect <- (ce/1000 + ( (1-ce/1000)/(1+(BA.PLOT/cf)^cg)))
+     comp.response <- exp(-size.effect*(comp.effect^cd)) }
> ##################################
> # Size Effect
> plot(BAI ~ RelBA, data=results$source_data)
> 
> par(mar=c(5,5,4,2))
> x <- seq(0,1,0.01)
> y <- size.effect(x,results$best_pars$ca, results$best_pars$cb,results$best_pars$cc)
> summary(y)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00    0.00    0.00   60.89    0.00 1999.00 
> 
> pdf(file.path("Figures", paste(run.label, " - Competition Size Effect.pdf", sep="")))
> plot(x,y,xlab="Relative Size",ylab="Size Effect",type="l",lwd=2,
+       cex.lab=1.5,cex.axis=1.25,main=run.label)
> #savePlot(file=paste("Competition Plot 1 ",run.label,".png",sep=""),type="png")
> dev.off()
pdf 
  2 
> 
> #####################
> # Plot BA effect
> plot(BAI ~ BA.m2ha.plot, data=results$source_data)
> 
> par(mar=c(5,5,4,2))
> x <- seq(0,60,0.1)
> y <- comp.effect(x, results$best_pars$ce, results$best_pars$cf,results$best_pars$cg)
> summary(y)
      Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
1.093e-248 1.093e-248 1.093e-248 1.093e-248 1.093e-248 1.093e-248 
> 
> pdf(file.path("Figures", paste(run.label, " - Competition Competitive Effect.pdf", sep="")))
> plot(x,y,ylim=c(0,1),xlab="Plot BA",ylab="Competitive Effect",type="l",lwd=2,
+        cex.lab=1.5,cex.axis=1.25,main=run.label)
> dev.off()
pdf 
  2 
> #savePlot(file=paste("Competition Plot 2 ",run.label,".png",sep=""),type="png")
> 
> #####################
> # Competition Response: Size vs. Response with different plot BA levels
> plot(BA.m2ha.plot~ RelBA, data=results$source_data)
> 
> 
> pdf(file.path("Figures", paste(run.label, " - Competition Response Scalar.pdf", sep="")))
> par(mar=c(5,5,4,2))
> colors <- c("red","orange","blue","cyan","green")
> x <- seq(0,1,0.01)
> y <- comp.response(SIZE=x, BA.PLOT=50, results$best_pars$ca, results$best_pars$cb, results$best_pars$cc, results$best_pars$cd, results$best_pars$ce, results$best_pars$cf, results$best_pars$cg)
> plot(x,y,ylim=c(0,1),xlab="Relative Size",ylab="Competition Scalar",type="l",col=colors[1],lwd=2,
+      cex.lab=1.5,cex.axis=1.25,main=run.label)
> y <- comp.response(SIZE=x, BA.PLOT=40, results$best_pars$ca, results$best_pars$cb, results$best_pars$cc, results$best_pars$cd, results$best_pars$ce, results$best_pars$cf, results$best_pars$cg)
> lines(x,y,col=colors[2],lwd=2)
> y <- comp.response(SIZE=x, BA.PLOT=30, results$best_pars$ca, results$best_pars$cb, results$best_pars$cc, results$best_pars$cd, results$best_pars$ce, results$best_pars$cf, results$best_pars$cg)
> lines(x,y,col=colors[3],lwd=2)
> y <- comp.response(SIZE=x, BA.PLOT=20, results$best_pars$ca, results$best_pars$cb, results$best_pars$cc, results$best_pars$cd, results$best_pars$ce, results$best_pars$cf, results$best_pars$cg)
> lines(x,y,col=colors[4],lwd=2)
> y <- comp.response(SIZE=x, BA.PLOT=10, results$best_pars$ca, results$best_pars$cb, results$best_pars$cc, results$best_pars$cd, results$best_pars$ce, results$best_pars$cf, results$best_pars$cg)
> lines(x,y,col=colors[5],lwd=2)
> lines(x,y,col=colors[6],lwd=2)
> legend("bottomright",legend=c(50,40,30,20,10),col=colors,bty="n",lwd=2,title="Plot\nBasal\nArea",cex=1.25)
> dev.off()
pdf 
  2 
> #savePlot(file=paste("Competition Plot 3 ",run.label,".png",sep=""),type="png")
> 
> 
> ##################################
> temp.effect <- function(TEMP,ta1,tb1)
+        { t(exp(-0.5*((t(TEMP)-ta1)/tb1)^2))  }
> 
> precip.effect <- function(PRECIP,FLOW,pa1,pb1,pc1)
+        { exp(-0.5*((t(PRECIP+pc1*FLOW*PRECIP)-pa1)/pb1)^2)) }
Error: unexpected ')' in:
"precip.effect <- function(PRECIP,FLOW,pa1,pb1,pc1)
       { exp(-0.5*((t(PRECIP+pc1*FLOW*PRECIP)-pa1)/pb1)^2))"
Execution halted
