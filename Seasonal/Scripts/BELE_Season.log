
R version 2.15.3 (2013-03-01) -- "Security Blanket"
Copyright (C) 2013 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ####################################################
> # BELE MODEL Autogenic x Competition x (Temp x Precip) :
> # Autogenic: Size/Age logistic scalar with Max potential growth for absolute values
> # Competition: Relative Size, Plot BA Scalars
> # Climate: 3-month means, prev Jun - current Nov
> #	-- Temp: Gaussian
> #	-- Precip: with flow Gaussian
> #
> ####################################################
> rm(list=ls())
> 
> data_directory <- "~/CARCA/Growth-Models/Seasonal/"
> #memory.size(4024)
> setwd(data_directory)
> library(likelihood)
Loading required package: nlme
> 
> # run.label <- "BELE_Full_Season"
> # load(file=paste( run.label, "_Results.Rdata", sep=""))
> 
> run.label <- "BELE_Full_Season"
> 
> #############
> # Reading in Test Data & some formating
> all.data <-read.csv("../RawInputs/CARCA_CoreData_Climate_Month_Wide.csv")
> all.data[,substr(names(all.data),1,4)=="Tavg"] <- all.data[,substr(names(all.data),1,4)=="Tavg"]+273.15
> all.data$BA.tree.cm2 <- all.data$BA.tree/100
> all.data$Site.Trans <- as.factor(substr(all.data$PlotID,1,4))
> summary(all.data)
      Year          PlotID           TreeID        Site       Trans     
 Min.   :1771   HNKC2  :  8505   BLDA101:   243   BLD:62694   A: 88452  
 1st Qu.:1831   FLTA1  :  7776   BLDA102:   243   FLT:49329   B: 93798  
 Median :1892   HIKA1  :  7290   BLDA103:   243   HIK:48357   C:106434  
 Mean   :1892   HNKB2  :  7290   BLDA104:   243   HNK:43983             
 3rd Qu.:1953   HNKA3  :  7047   BLDA105:   243   IRN:52245             
 Max.   :2013   BLDA2  :  6804   BLDA106:   243   MOR:32076             
                (Other):243972   (Other):287226                         
      Plot            BAI                 CoreID       Pith      
 Min.   :1.000   Min.   :    0.00   BLDA101HI:   243   N:211896  
 1st Qu.:1.000   1st Qu.:   84.36   BLDA102HI:   243   Y: 76788  
 Median :2.000   Median :  244.79   BLDA103HI:   243             
 Mean   :2.265   Mean   :  459.83   BLDA104HI:   243             
 3rd Qu.:3.000   3rd Qu.:  589.69   BLDA105HI:   243             
 Max.   :4.000   Max.   :18648.71   BLDA106HI:   243             
                 NA's   :202009     (Other)  :287226             
    Pith.Yr          Inner          Outer      Bark       Use       
 Min.   :1756    Min.   :1762   Min.   :1990   N:  6318   N:  4617  
 1st Qu.:1917    1st Qu.:1923   1st Qu.:2012   Y:282366   Y:284067  
 Median :1933    Median :1938   Median :2012                        
 Mean   :1936    Mean   :1939   Mean   :2012                        
 3rd Qu.:1953    3rd Qu.:1955   3rd Qu.:2012                        
 Max.   :2008    Max.   :2009   Max.   :2013                        
 NA's   :60021                                                      
                        Notes         Pith.offset         Tree      
 poor corr w/ master       :   972   Min.   : 0.00   Min.   : 1.00  
 poor correlation w/ master:   972   1st Qu.: 1.00   1st Qu.:10.00  
 1977 missing              :   486   Median : 2.00   Median :18.50  
 1986 missing              :   486   Mean   : 3.35   Mean   :20.86  
 1999 missing              :   486   3rd Qu.: 5.00   3rd Qu.:30.00  
 (Other)                   : 14094   Max.   :20.00   Max.   :84.00  
 NA's                      :271188   NA's   :60021                  
      Spp              Genus         Canopy         Live       
 ACRU   :71199   Quercus  :111294   C   :148230   DEAD:   243  
 QUPR   :50787   Acer     : 85779   D   :  8748   LIVE:288441  
 QURU   :43740   Nyssa    : 38880   I   : 86022                
 NYSY   :38880   Magnolia : 11421   U   : 45441                
 ACSA   :14580   Betula   :  8262   NA's:   243                
 MAAC   : 9720   Sassafras:  7776                              
 (Other):59778   (Other)  : 25272                              
      Age            BA.m2ha          BAI.filled          BA.tree      
 Min.   :  0.00   Min.   : 0.0000   Min.   :    0.00   Min.   :     0  
 1st Qu.: 19.00   1st Qu.: 0.0000   1st Qu.:    0.00   1st Qu.:     0  
 Median : 40.00   Median : 0.0000   Median :    0.00   Median :     0  
 Mean   : 44.55   Mean   : 0.1771   Mean   :  149.04   Mean   :  6106  
 3rd Qu.: 64.00   3rd Qu.: 0.0615   3rd Qu.:   74.84   3rd Qu.:  2007  
 Max.   :256.00   Max.   :11.8597   Max.   :18648.71   Max.   :462177  
 NA's   :195231   NA's   :1047      NA's   :985        NA's   :1047    
     Stems          Density.Ha     BAI.filled.plot      BA.plot       
 Min.   :0.0000   Min.   : 0.000   Min.   :    0.0   Min.   :    0.0  
 1st Qu.:0.0000   1st Qu.: 0.000   1st Qu.:    0.0   1st Qu.:    0.0  
 Median :0.0000   Median : 0.000   Median :  904.8   Median :  581.2  
 Mean   :0.3191   Mean   : 9.728   Mean   : 3899.5   Mean   : 2063.0  
 3rd Qu.:1.0000   3rd Qu.:31.831   3rd Qu.: 6247.5   3rd Qu.: 2866.9  
 Max.   :1.0000   Max.   :49.736   Max.   :38677.4   Max.   :23212.2  
                                   NA's   :1500      NA's   :1500     
  BA.m2ha.plot     Density.ha.plot     Stems.plot     BAI.m2ha.plot   
 Min.   : 0.0000   Min.   :   0.00   Min.   : 0.000   Min.   :0.0000  
 1st Qu.: 0.0000   1st Qu.:   0.00   1st Qu.: 0.000   1st Qu.:0.0000  
 Median : 0.0705   Median :  63.66   Median : 2.000   Median :0.0274  
 Mean   : 3.4704   Mean   : 268.53   Mean   : 8.898   Mean   :0.1135  
 3rd Qu.: 4.3534   3rd Qu.: 509.30   3rd Qu.:18.000   3rd Qu.:0.1935  
 Max.   :35.8804   Max.   :1432.39   Max.   :45.000   Max.   :1.0485  
 NA's   :1500      NA's   :1500      NA's   :1500     NA's   :1500    
 BA.m2ha.plot.live     RelBA          Site.Trans        Latitude     
 Min.   : 0.000    Min.   :0.00     BLDC   : 23814   Min.   :36.75   
 1st Qu.: 0.000    1st Qu.:0.05     IRNC   : 20898   1st Qu.:37.24   
 Median : 1.116    Median :0.17     HIKC   : 20169   Median :37.91   
 Mean   : 5.122    Mean   :0.30     BLDA   : 19926   Mean   :37.74   
 3rd Qu.: 6.584    3rd Qu.:0.46     BLDB   : 18954   3rd Qu.:38.32   
 Max.   :57.620    Max.   :1.00     IRNB   : 18711   Max.   :38.58   
 NA's   :985       NA's   :199115   (Other):166212   NA's   :154440  
   Longitude           elev             flow             TPI        
 Min.   :-81.31   Min.   : 666.9   Min.   :0.01     Min.   :-0.23   
 1st Qu.:-80.86   1st Qu.: 843.7   1st Qu.:0.01     1st Qu.:-0.10   
 Median :-79.85   Median : 952.4   Median :0.03     Median :-0.03   
 Mean   :-80.10   Mean   : 955.7   Mean   :0.12     Mean   : 0.01   
 3rd Qu.:-79.22   3rd Qu.:1098.3   3rd Qu.:0.06     3rd Qu.: 0.15   
 Max.   :-79.15   Max.   :1256.7   Max.   :1.42     Max.   : 0.30   
 NA's   :154440   NA's   :154440   NA's   :154440   NA's   :154440  
    Tavg.X01         Tavg.X02         Tavg.X03         Tavg.X04     
 Min.   :260.1    Min.   :262.9    Min.   :264.5    Min.   :274.6   
 1st Qu.:269.2    1st Qu.:270.3    1st Qu.:274.7    1st Qu.:280.5   
 Median :271.3    Median :272.4    Median :276.8    Median :282.4   
 Mean   :271.2    Mean   :272.2    Mean   :276.7    Mean   :282.2   
 3rd Qu.:273.2    3rd Qu.:274.2    3rd Qu.:278.8    3rd Qu.:284.0   
 Max.   :280.5    Max.   :278.5    Max.   :285.0    Max.   :287.7   
 NA's   :154440   NA's   :154440   NA's   :154440   NA's   :154440  
    Tavg.X05         Tavg.X06         Tavg.X07         Tavg.X08     
 Min.   :279.8    Min.   :284.9    Min.   :287.3    Min.   :285.8   
 1st Qu.:285.8    1st Qu.:290.0    1st Qu.:292.1    1st Qu.:291.3   
 Median :287.5    Median :291.4    Median :293.4    Median :292.7   
 Mean   :287.3    Mean   :291.1    Mean   :293.1    Mean   :292.5   
 3rd Qu.:289.0    3rd Qu.:292.5    3rd Qu.:294.3    3rd Qu.:293.8   
 Max.   :292.2    Max.   :296.2    Max.   :297.1    Max.   :297.3   
 NA's   :154440   NA's   :154440   NA's   :154440   NA's   :154440  
    Tavg.X09         Tavg.X10         Tavg.X11         Tavg.X12     
 Min.   :282.8    Min.   :276.6    Min.   :271.5    Min.   :263.8   
 1st Qu.:288.1    1st Qu.:282.2    1st Qu.:276.5    1st Qu.:271.3   
 Median :289.5    Median :283.7    Median :277.8    Median :273.1   
 Mean   :289.3    Mean   :283.5    Mean   :277.8    Mean   :273.0   
 3rd Qu.:290.7    3rd Qu.:285.0    3rd Qu.:279.1    3rd Qu.:274.8   
 Max.   :294.2    Max.   :288.6    Max.   :283.7    Max.   :279.9   
 NA's   :154440   NA's   :154440   NA's   :154440   NA's   :154440  
 Tavg.X01.prev    Tavg.X02.prev    Tavg.X03.prev    Tavg.X04.prev   
 Min.   :260.1    Min.   :262.9    Min.   :264.5    Min.   :274.6   
 1st Qu.:269.2    1st Qu.:270.3    1st Qu.:274.7    1st Qu.:280.5   
 Median :271.3    Median :272.4    Median :276.8    Median :282.4   
 Mean   :271.2    Mean   :272.1    Mean   :276.6    Mean   :282.2   
 3rd Qu.:273.2    3rd Qu.:274.2    3rd Qu.:278.7    3rd Qu.:284.0   
 Max.   :280.5    Max.   :278.5    Max.   :285.0    Max.   :287.7   
 NA's   :155628   NA's   :155628   NA's   :155628   NA's   :155628  
 Tavg.X05.prev    Tavg.X06.prev    Tavg.X07.prev    Tavg.X08.prev   
 Min.   :279.8    Min.   :284.9    Min.   :287.3    Min.   :285.8   
 1st Qu.:285.8    1st Qu.:290.0    1st Qu.:292.1    1st Qu.:291.3   
 Median :287.5    Median :291.4    Median :293.3    Median :292.7   
 Mean   :287.3    Mean   :291.1    Mean   :293.1    Mean   :292.5   
 3rd Qu.:288.9    3rd Qu.:292.5    3rd Qu.:294.2    3rd Qu.:293.8   
 Max.   :292.2    Max.   :296.2    Max.   :297.1    Max.   :297.3   
 NA's   :155628   NA's   :155628   NA's   :155628   NA's   :155628  
 Tavg.X09.prev    Tavg.X10.prev    Tavg.X11.prev    Tavg.X12.prev   
 Min.   :282.8    Min.   :276.6    Min.   :271.5    Min.   :263.8   
 1st Qu.:288.1    1st Qu.:282.2    1st Qu.:276.5    1st Qu.:271.2   
 Median :289.5    Median :283.7    Median :277.8    Median :273.1   
 Mean   :289.3    Mean   :283.5    Mean   :277.8    Mean   :272.9   
 3rd Qu.:290.7    3rd Qu.:285.0    3rd Qu.:279.1    3rd Qu.:274.8   
 Max.   :294.2    Max.   :288.6    Max.   :283.7    Max.   :279.9   
 NA's   :155628   NA's   :155628   NA's   :155628   NA's   :155628  
   Precip.X01       Precip.X02       Precip.X03       Precip.X04    
 Min.   :  9.06   Min.   :  7.21   Min.   :  0.15   Min.   : 14.74  
 1st Qu.: 56.47   1st Qu.: 49.54   1st Qu.: 70.19   1st Qu.: 61.82  
 Median : 77.95   Median : 71.53   Median : 95.96   Median : 87.82  
 Mean   : 83.89   Mean   : 75.98   Mean   : 99.47   Mean   : 91.25  
 3rd Qu.:102.79   3rd Qu.: 97.05   3rd Qu.:122.77   3rd Qu.:113.90  
 Max.   :276.20   Max.   :209.15   Max.   :272.97   Max.   :238.54  
 NA's   :154440   NA's   :154440   NA's   :154440   NA's   :154440  
   Precip.X05       Precip.X06       Precip.X07       Precip.X08    
 Min.   : 19.83   Min.   : 14.62   Min.   : 27.43   Min.   : 21.48  
 1st Qu.: 74.09   1st Qu.: 74.26   1st Qu.: 89.65   1st Qu.: 68.85  
 Median :104.65   Median :100.85   Median :112.71   Median : 95.89  
 Mean   :106.44   Mean   :107.63   Mean   :119.43   Mean   :105.77  
 3rd Qu.:135.01   3rd Qu.:131.03   3rd Qu.:142.94   3rd Qu.:129.40  
 Max.   :266.04   Max.   :296.69   Max.   :423.43   Max.   :421.09  
 NA's   :154440   NA's   :154440   NA's   :154440   NA's   :154440  
   Precip.X09       Precip.X10       Precip.X11       Precip.X12    
 Min.   :  2.37   Min.   :  1.06   Min.   :  9.25   Min.   :  2.49  
 1st Qu.: 52.19   1st Qu.: 44.08   1st Qu.: 45.03   1st Qu.: 56.20  
 Median : 79.54   Median : 73.11   Median : 71.98   Median : 75.57  
 Mean   : 90.54   Mean   : 82.99   Mean   : 76.45   Mean   : 82.37  
 3rd Qu.:117.18   3rd Qu.:114.42   3rd Qu.:100.25   3rd Qu.:103.91  
 Max.   :324.42   Max.   :319.10   Max.   :354.36   Max.   :252.11  
 NA's   :154440   NA's   :154440   NA's   :154440   NA's   :154440  
 Precip.X01.prev  Precip.X02.prev  Precip.X03.prev  Precip.X04.prev 
 Min.   :  9.06   Min.   :  7.21   Min.   :  0.15   Min.   : 14.74  
 1st Qu.: 56.43   1st Qu.: 49.65   1st Qu.: 70.01   1st Qu.: 62.00  
 Median : 77.95   Median : 71.83   Median : 95.76   Median : 87.89  
 Mean   : 83.96   Mean   : 76.17   Mean   : 99.26   Mean   : 91.32  
 3rd Qu.:103.33   3rd Qu.: 97.59   3rd Qu.:122.69   3rd Qu.:114.66  
 Max.   :276.20   Max.   :209.15   Max.   :272.97   Max.   :238.54  
 NA's   :155628   NA's   :155628   NA's   :155628   NA's   :155628  
 Precip.X05.prev  Precip.X06.prev  Precip.X07.prev  Precip.X08.prev 
 Min.   : 19.83   Min.   : 14.62   Min.   : 27.43   Min.   : 21.48  
 1st Qu.: 73.88   1st Qu.: 74.67   1st Qu.: 89.53   1st Qu.: 68.67  
 Median :104.37   Median :101.25   Median :112.71   Median : 95.82  
 Mean   :106.28   Mean   :108.04   Mean   :119.47   Mean   :105.70  
 3rd Qu.:134.94   3rd Qu.:131.58   3rd Qu.:143.14   3rd Qu.:129.38  
 Max.   :266.04   Max.   :296.69   Max.   :423.43   Max.   :421.09  
 NA's   :155628   NA's   :155628   NA's   :155628   NA's   :155628  
 Precip.X09.prev  Precip.X10.prev  Precip.X11.prev  Precip.X12.prev 
 Min.   :  2.37   Min.   :  1.06   Min.   :  9.25   Min.   :  2.49  
 1st Qu.: 51.94   1st Qu.: 43.92   1st Qu.: 45.68   1st Qu.: 56.30  
 Median : 79.03   Median : 73.60   Median : 72.17   Median : 76.78  
 Mean   : 90.18   Mean   : 83.27   Mean   : 76.91   Mean   : 82.60  
 3rd Qu.:115.57   3rd Qu.:114.60   3rd Qu.:100.41   3rd Qu.:104.91  
 Max.   :324.42   Max.   :319.10   Max.   :354.36   Max.   :252.11  
 NA's   :155628   NA's   :155628   NA's   :155628   NA's   :155628  
  BA.tree.cm2     
 Min.   :   0.00  
 1st Qu.:   0.00  
 Median :   0.00  
 Mean   :  61.06  
 3rd Qu.:  20.07  
 Max.   :4621.77  
 NA's   :1047     
> dim(all.data)
[1] 288684     90
> 
> #############
> # Subsetting just BELE data
> bele.all <- all.data[all.data$Spp=="BELE", ]
> summary(bele.all)
      Year          PlotID         TreeID      Site      Trans   
 Min.   :1771   IRNB3  :1458   BLDA333: 243   BLD:3402   A:2187  
 1st Qu.:1831   BLDA4  : 972   BLDA410: 243   FLT:   0   B:4374  
 Median :1892   BLDB3  : 972   BLDA413: 243   HIK:1701   C:1458  
 Mean   :1892   BLDB2  : 729   BLDA419: 243   HNK: 486           
 3rd Qu.:1953   HIKC2  : 729   BLDA431: 243   IRN:1944           
 Max.   :2013   BLDB1  : 486   BLDB133: 243   MOR: 486           
                (Other):2673   (Other):6561                      
      Plot            BAI                 CoreID     Pith        Pith.Yr    
 Min.   :1.000   Min.   :   2.639   BLDA333HI: 243   N:5103   Min.   :1799  
 1st Qu.:2.000   1st Qu.: 119.262   BLDA410HI: 243   Y:2916   1st Qu.:1921  
 Median :3.000   Median : 270.064   BLDA413HI: 243            Median :1951  
 Mean   :2.758   Mean   : 451.290   BLDA419HI: 243            Mean   :1941  
 3rd Qu.:3.000   3rd Qu.: 584.075   BLDA431HI: 243            3rd Qu.:1973  
 Max.   :4.000   Max.   :5718.124   BLDB133HI: 243            Max.   :1987  
                 NA's   :5573       (Other)  :6561            NA's   :1458  
     Inner          Outer      Bark     Use                      Notes     
 Min.   :1805   Min.   :2012   N:   0   N: 243   1988 almost missing: 243  
 1st Qu.:1913   1st Qu.:2012   Y:8019   Y:7776   2002 & 2003 missing: 243  
 Median :1944   Median :2012                     dots off on core   : 243  
 Mean   :1934   Mean   :2012                     false ring in 1952 : 243  
 3rd Qu.:1974   3rd Qu.:2012                     meaured            : 243  
 Max.   :1991   Max.   :2012                     (Other)            : 243  
                                                 NA's               :6561  
  Pith.offset        Tree            Spp            Genus      Canopy  
 Min.   :1.00   Min.   : 2.00   BELE   :8019   Betula  :8019   C:3645  
 1st Qu.:1.00   1st Qu.:10.00   ACRU   :   0   Acer    :   0   D: 243  
 Median :1.00   Median :19.00   ACSA   :   0   Carya   :   0   I:2673  
 Mean   :2.63   Mean   :19.06   BEPA   :   0   Castanea:   0   U:1458  
 3rd Qu.:4.00   3rd Qu.:29.00   CADE   :   0   Cornus  :   0           
 Max.   :9.00   Max.   :42.00   CAGL   :   0   Juglans :   0           
 NA's   :1458                   (Other):   0   (Other) :   0           
   Live           Age            BA.m2ha         BAI.filled    
 DEAD:   0   Min.   :  0.00   Min.   :0.0000   Min.   :   0.0  
 LIVE:8019   1st Qu.: 21.00   1st Qu.:0.0000   1st Qu.:   0.0  
             Median : 45.00   Median :0.0000   Median :   0.0  
             Mean   : 59.95   Mean   :0.2441   Mean   : 149.2  
             3rd Qu.: 84.00   3rd Qu.:0.1045   3rd Qu.: 119.1  
             Max.   :213.00   Max.   :4.7879   Max.   :5718.1  
             NA's   :5228     NA's   :36       NA's   :33      
    BA.tree           Stems          Density.Ha     BAI.filled.plot   
 Min.   :     0   Min.   :0.0000   Min.   : 0.000   Min.   :    0.00  
 1st Qu.:     0   1st Qu.:0.0000   1st Qu.: 0.000   1st Qu.:   71.06  
 Median :     0   Median :0.0000   Median : 0.000   Median : 1437.74  
 Mean   :  9523   Mean   :0.3296   Mean   : 9.955   Mean   : 4338.73  
 3rd Qu.:  3305   3rd Qu.:1.0000   3rd Qu.:31.831   3rd Qu.: 7710.74  
 Max.   :276409   Max.   :1.0000   Max.   :31.831   Max.   :35506.83  
 NA's   :36                                                           
    BA.plot          BA.m2ha.plot     Density.ha.plot     Stems.plot    
 Min.   :    0.00   Min.   : 0.0000   Min.   :   0.00   Min.   : 0.000  
 1st Qu.:   59.84   1st Qu.: 0.0021   1st Qu.:  31.83   1st Qu.: 1.000  
 Median : 1015.45   Median : 0.4847   Median : 127.32   Median : 5.000  
 Mean   : 2495.51   Mean   : 3.9889   Mean   : 288.23   Mean   : 9.442  
 3rd Qu.: 3745.08   3rd Qu.: 5.3680   3rd Qu.: 604.79   3rd Qu.:19.000  
 Max.   :22046.63   Max.   :35.7168   Max.   :1336.90   Max.   :42.000  
                                                                        
 BAI.m2ha.plot      BA.m2ha.plot.live     RelBA         Site.Trans  
 Min.   :0.000000   Min.   : 0.0000   Min.   :0.000   BLDB   :2187  
 1st Qu.:0.002104   1st Qu.: 0.0000   1st Qu.:0.076   IRNB   :1458  
 Median :0.043487   Median : 0.8282   Median :0.401   BLDA   :1215  
 Mean   :0.127840   Mean   : 5.3328   Mean   :0.421   HIKC   :1215  
 3rd Qu.:0.236279   3rd Qu.: 7.3319   3rd Qu.:0.658   HIKA   : 243  
 Max.   :1.048530   Max.   :38.7400   Max.   :1.000   HIKB   : 243  
                    NA's   :33        NA's   :5422    (Other):1458  
    Latitude       Longitude           elev             flow      
 Min.   :36.75   Min.   :-81.31   Min.   : 744.2   Min.   :0.006  
 1st Qu.:37.72   1st Qu.:-80.11   1st Qu.: 907.0   1st Qu.:0.013  
 Median :37.92   Median :-79.84   Median :1022.4   Median :0.032  
 Mean   :37.79   Mean   :-80.03   Mean   :1017.1   Mean   :0.040  
 3rd Qu.:38.31   3rd Qu.:-79.24   3rd Qu.:1146.9   3rd Qu.:0.035  
 Max.   :38.57   Max.   :-79.15   Max.   :1250.8   Max.   :0.225  
 NA's   :4290    NA's   :4290     NA's   :4290     NA's   :4290   
      TPI            Tavg.X01        Tavg.X02        Tavg.X03    
 Min.   :-0.157   Min.   :260.3   Min.   :263.1   Min.   :264.5  
 1st Qu.:-0.096   1st Qu.:269.1   1st Qu.:270.0   1st Qu.:274.1  
 Median :-0.019   Median :271.2   Median :272.2   Median :276.7  
 Mean   : 0.012   Mean   :271.1   Mean   :272.0   Mean   :276.3  
 3rd Qu.: 0.173   3rd Qu.:273.1   3rd Qu.:274.1   3rd Qu.:278.8  
 Max.   : 0.287   Max.   :280.2   Max.   :278.2   Max.   :284.7  
 NA's   :4290     NA's   :4290    NA's   :4290    NA's   :4290   
    Tavg.X04        Tavg.X05        Tavg.X06        Tavg.X07    
 Min.   :274.7   Min.   :280.0   Min.   :285.1   Min.   :287.5  
 1st Qu.:279.9   1st Qu.:285.3   1st Qu.:289.4   1st Qu.:291.7  
 Median :282.3   Median :287.2   Median :291.1   Median :293.1  
 Mean   :281.8   Mean   :286.9   Mean   :290.7   Mean   :292.7  
 3rd Qu.:283.8   3rd Qu.:288.6   3rd Qu.:292.2   3rd Qu.:293.9  
 Max.   :287.0   Max.   :291.4   Max.   :295.3   Max.   :296.5  
 NA's   :4290    NA's   :4290    NA's   :4290    NA's   :4290   
    Tavg.X08        Tavg.X09        Tavg.X10        Tavg.X11    
 Min.   :286.0   Min.   :283.0   Min.   :276.7   Min.   :271.5  
 1st Qu.:290.7   1st Qu.:287.6   1st Qu.:281.8   1st Qu.:276.1  
 Median :292.5   Median :289.3   Median :283.5   Median :277.6  
 Mean   :292.1   Mean   :288.9   Mean   :283.2   Mean   :277.6  
 3rd Qu.:293.5   3rd Qu.:290.5   3rd Qu.:284.9   3rd Qu.:279.0  
 Max.   :296.4   Max.   :293.6   Max.   :288.3   Max.   :283.5  
 NA's   :4290    NA's   :4290    NA's   :4290    NA's   :4290   
    Tavg.X12     Tavg.X01.prev   Tavg.X02.prev   Tavg.X03.prev  
 Min.   :264.1   Min.   :260.3   Min.   :263.1   Min.   :264.5  
 1st Qu.:271.1   1st Qu.:269.1   1st Qu.:269.9   1st Qu.:274.1  
 Median :273.0   Median :271.2   Median :272.2   Median :276.6  
 Mean   :272.8   Mean   :271.1   Mean   :271.9   Mean   :276.3  
 3rd Qu.:274.7   3rd Qu.:273.1   3rd Qu.:274.1   3rd Qu.:278.7  
 Max.   :279.6   Max.   :280.2   Max.   :278.2   Max.   :284.7  
 NA's   :4290    NA's   :4323    NA's   :4323    NA's   :4323   
 Tavg.X04.prev   Tavg.X05.prev   Tavg.X06.prev   Tavg.X07.prev  
 Min.   :274.7   Min.   :280.0   Min.   :285.1   Min.   :287.5  
 1st Qu.:279.9   1st Qu.:285.3   1st Qu.:289.4   1st Qu.:291.6  
 Median :282.3   Median :287.2   Median :291.1   Median :293.1  
 Mean   :281.8   Mean   :286.9   Mean   :290.7   Mean   :292.6  
 3rd Qu.:283.8   3rd Qu.:288.6   3rd Qu.:292.2   3rd Qu.:293.9  
 Max.   :287.0   Max.   :291.4   Max.   :295.3   Max.   :296.5  
 NA's   :4323    NA's   :4323    NA's   :4323    NA's   :4323   
 Tavg.X08.prev   Tavg.X09.prev   Tavg.X10.prev   Tavg.X11.prev  
 Min.   :286.0   Min.   :283.0   Min.   :276.7   Min.   :271.5  
 1st Qu.:290.7   1st Qu.:287.6   1st Qu.:281.8   1st Qu.:276.2  
 Median :292.5   Median :289.3   Median :283.5   Median :277.6  
 Mean   :292.1   Mean   :288.9   Mean   :283.3   Mean   :277.6  
 3rd Qu.:293.5   3rd Qu.:290.5   3rd Qu.:284.9   3rd Qu.:279.1  
 Max.   :296.4   Max.   :293.6   Max.   :288.3   Max.   :283.5  
 NA's   :4323    NA's   :4323    NA's   :4323    NA's   :4323   
 Tavg.X12.prev     Precip.X01       Precip.X02       Precip.X03     
 Min.   :264.1   Min.   :  9.06   Min.   :  7.21   Min.   :  0.154  
 1st Qu.:271.1   1st Qu.: 57.77   1st Qu.: 49.54   1st Qu.: 71.090  
 Median :272.9   Median : 81.87   Median : 72.93   Median : 97.120  
 Mean   :272.8   Mean   : 86.70   Mean   : 77.09   Mean   :101.672  
 3rd Qu.:274.7   3rd Qu.:105.23   3rd Qu.: 98.01   3rd Qu.:126.560  
 Max.   :279.6   Max.   :276.20   Max.   :209.15   Max.   :246.540  
 NA's   :4323    NA's   :4290     NA's   :4290     NA's   :4290     
   Precip.X04       Precip.X05       Precip.X06       Precip.X07    
 Min.   : 14.74   Min.   : 19.83   Min.   : 14.62   Min.   : 27.43  
 1st Qu.: 63.57   1st Qu.: 76.40   1st Qu.: 76.44   1st Qu.: 91.69  
 Median : 89.44   Median :105.42   Median :103.75   Median :114.53  
 Mean   : 93.02   Mean   :108.39   Mean   :110.76   Mean   :121.78  
 3rd Qu.:115.49   3rd Qu.:136.13   3rd Qu.:135.49   3rd Qu.:145.87  
 Max.   :238.54   Max.   :266.04   Max.   :296.69   Max.   :423.43  
 NA's   :4290     NA's   :4290     NA's   :4290     NA's   :4290    
   Precip.X08       Precip.X09       Precip.X10       Precip.X11    
 Min.   : 21.48   Min.   :  2.37   Min.   :  1.06   Min.   :  9.25  
 1st Qu.: 71.62   1st Qu.: 53.70   1st Qu.: 45.13   1st Qu.: 45.77  
 Median : 97.67   Median : 81.46   Median : 76.32   Median : 76.21  
 Mean   :108.40   Mean   : 93.36   Mean   : 86.46   Mean   : 79.69  
 3rd Qu.:130.24   3rd Qu.:120.18   3rd Qu.:118.14   3rd Qu.:104.20  
 Max.   :421.09   Max.   :324.42   Max.   :319.10   Max.   :354.36  
 NA's   :4290     NA's   :4290     NA's   :4290     NA's   :4290    
   Precip.X12     Precip.X01.prev  Precip.X02.prev  Precip.X03.prev  
 Min.   :  3.96   Min.   :  9.06   Min.   :  7.21   Min.   :  0.154  
 1st Qu.: 58.01   1st Qu.: 57.63   1st Qu.: 49.71   1st Qu.: 71.090  
 Median : 77.58   Median : 81.99   Median : 73.44   Median : 96.490  
 Mean   : 84.36   Mean   : 86.78   Mean   : 77.35   Mean   :101.461  
 3rd Qu.:106.19   3rd Qu.:105.23   3rd Qu.: 98.31   3rd Qu.:126.120  
 Max.   :252.11   Max.   :276.20   Max.   :209.15   Max.   :246.540  
 NA's   :4290     NA's   :4323     NA's   :4323     NA's   :4323     
 Precip.X04.prev  Precip.X05.prev  Precip.X06.prev  Precip.X07.prev 
 Min.   : 14.74   Min.   : 19.83   Min.   : 14.62   Min.   : 27.43  
 1st Qu.: 63.57   1st Qu.: 76.17   1st Qu.: 77.05   1st Qu.: 91.29  
 Median : 89.45   Median :105.38   Median :104.73   Median :114.53  
 Mean   : 93.13   Mean   :108.25   Mean   :111.14   Mean   :121.83  
 3rd Qu.:116.28   3rd Qu.:136.47   3rd Qu.:135.49   3rd Qu.:146.91  
 Max.   :238.54   Max.   :266.04   Max.   :296.69   Max.   :423.43  
 NA's   :4323     NA's   :4323     NA's   :4323     NA's   :4323    
 Precip.X08.prev  Precip.X09.prev  Precip.X10.prev  Precip.X11.prev 
 Min.   : 21.48   Min.   :  2.37   Min.   :  1.06   Min.   :  9.25  
 1st Qu.: 71.61   1st Qu.: 53.13   1st Qu.: 45.13   1st Qu.: 47.78  
 Median : 96.60   Median : 81.07   Median : 76.34   Median : 76.73  
 Mean   :108.29   Mean   : 93.01   Mean   : 86.75   Mean   : 80.16  
 3rd Qu.:129.40   3rd Qu.:119.71   3rd Qu.:118.28   3rd Qu.:104.20  
 Max.   :421.09   Max.   :324.42   Max.   :319.10   Max.   :354.36  
 NA's   :4323     NA's   :4323     NA's   :4323     NA's   :4323    
 Precip.X12.prev   BA.tree.cm2     
 Min.   :  3.96   Min.   :   0.00  
 1st Qu.: 58.01   1st Qu.:   0.00  
 Median : 77.80   Median :   0.00  
 Mean   : 84.59   Mean   :  95.23  
 3rd Qu.:106.31   3rd Qu.:  33.05  
 Max.   :252.11   Max.   :2764.09  
 NA's   :4323     NA's   :36       
> dim(bele.all)
[1] 8019   90
> 
> # Subsetting only complete cases & a small range of years
> bele.run <- bele.all[complete.cases(bele.all) & bele.all$Year>=1990 & bele.all$Year<=2011,]
> summary(bele.run)
      Year          PlotID       TreeID    Site    Trans       Plot    
 Min.   :1990   HIKC2  :44   BLDA410:22   BLD:44   A:44   Min.   :1.0  
 1st Qu.:1995   BLDA4  :22   BLDB133:22   FLT: 0   B:22   1st Qu.:2.0  
 Median :2000   BLDB1  :22   HIKC202:22   HIK:44   C:44   Median :2.0  
 Mean   :2000   MORA2  :22   HIKC206:22   HNK: 0          Mean   :2.2  
 3rd Qu.:2006   BLDA1  : 0   MORA222:22   IRN: 0          3rd Qu.:2.0  
 Max.   :2011   BLDA2  : 0   BLDA101: 0   MOR:22          Max.   :4.0  
                (Other): 0   (Other): 0                                
      BAI                CoreID   Pith      Pith.Yr         Inner     
 Min.   :  2.639   BLDA410HI:22   N:44   Min.   :1809   Min.   :1815  
 1st Qu.: 51.272   BLDB133HI:22   Y:66   1st Qu.:1939   1st Qu.:1940  
 Median :101.791   HIKC202HI:22          Median :1954   Median :1955  
 Mean   :141.364   HIKC206HI:22          Mean   :1931   Mean   :1933  
 3rd Qu.:187.996   MORA222HI:22          3rd Qu.:1969   3rd Qu.:1970  
 Max.   :870.213   BLDA101HI: 0          Max.   :1982   Max.   :1983  
                   (Other)  : 0                                       
     Outer      Bark    Use                    Notes     Pith.offset
 Min.   :2012   N:  0   N:22   2002 & 2003 missing:22   Min.   :1   
 1st Qu.:2012   Y:110   Y:88   dots off on core   :22   1st Qu.:1   
 Median :2012                  false ring in 1952 :22   Median :1   
 Mean   :2012                  meaured            :22   Mean   :2   
 3rd Qu.:2012                  poor corr w/ master:22   3rd Qu.:1   
 Max.   :2012                  1931 missing       : 0   Max.   :6   
                               (Other)            : 0               
      Tree           Spp           Genus     Canopy   Live          Age        
 Min.   : 2.0   BELE   :110   Betula  :110   C:22   DEAD:  0   Min.   :  8.00  
 1st Qu.: 6.0   ACRU   :  0   Acer    :  0   D: 0   LIVE:110   1st Qu.: 28.00  
 Median :10.0   ACSA   :  0   Carya   :  0   I:66              Median : 46.50  
 Mean   :14.6   BEPA   :  0   Castanea:  0   U:22              Mean   : 69.90  
 3rd Qu.:22.0   CADE   :  0   Cornus  :  0                     3rd Qu.: 66.75  
 Max.   :33.0   CAGL   :  0   Juglans :  0                     Max.   :202.00  
                (Other):  0   (Other) :  0                                     
    BA.m2ha           BAI.filled         BA.tree            Stems  
 Min.   :0.009333   Min.   :  2.639   Min.   :  293.2   Min.   :1  
 1st Qu.:0.122187   1st Qu.: 51.272   1st Qu.: 3838.7   1st Qu.:1  
 Median :0.155496   Median :101.791   Median : 4885.2   Median :1  
 Mean   :0.633262   Mean   :141.364   Mean   :19895.1   Mean   :1  
 3rd Qu.:0.188737   3rd Qu.:187.996   3rd Qu.: 5929.5   3rd Qu.:1  
 Max.   :2.731994   Max.   :870.213   Max.   :85830.8   Max.   :1  
                                                                   
   Density.Ha    BAI.filled.plot    BA.plot       BA.m2ha.plot  
 Min.   :31.83   Min.   : 9110   Min.   : 5307   Min.   :13.23  
 1st Qu.:31.83   1st Qu.:12622   1st Qu.: 7891   1st Qu.:18.14  
 Median :31.83   Median :14550   Median : 9317   Median :22.02  
 Mean   :31.83   Mean   :14833   Mean   : 9254   Mean   :23.45  
 3rd Qu.:31.83   3rd Qu.:17569   3rd Qu.:10715   3rd Qu.:28.94  
 Max.   :31.83   Max.   :22904   Max.   :12803   Max.   :35.42  
                                                                
 Density.ha.plot    Stems.plot    BAI.m2ha.plot    BA.m2ha.plot.live
 Min.   : 700.3   Min.   :22.00   Min.   :0.2900   Min.   :14.42    
 1st Qu.: 795.8   1st Qu.:25.00   1st Qu.:0.4018   1st Qu.:22.47    
 Median : 827.6   Median :26.00   Median :0.4632   Median :27.53    
 Mean   : 847.6   Mean   :26.63   Mean   :0.4721   Mean   :27.04    
 3rd Qu.: 859.4   3rd Qu.:27.00   3rd Qu.:0.5592   3rd Qu.:31.39    
 Max.   :1018.6   Max.   :32.00   Max.   :0.7290   Max.   :38.38    
                                                                    
     RelBA            Site.Trans    Latitude       Longitude     
 Min.   :0.004402   HIKC   :44   Min.   :37.72   Min.   :-80.11  
 1st Qu.:0.023887   BLDA   :22   1st Qu.:37.92   1st Qu.:-79.85  
 Median :0.063685   BLDB   :22   Median :37.92   Median :-79.84  
 Mean   :0.129723   MORA   :22   Mean   :38.14   Mean   :-79.62  
 3rd Qu.:0.083103   BLDC   : 0   3rd Qu.:38.57   3rd Qu.:-79.15  
 Max.   :0.540835   FLTA   : 0   Max.   :38.57   Max.   :-79.15  
                    (Other): 0                                   
      elev             flow               TPI              Tavg.X01    
 Min.   : 834.4   Min.   :0.007416   Min.   :-0.10184   Min.   :267.0  
 1st Qu.: 834.4   1st Qu.:0.013427   1st Qu.:-0.10184   1st Qu.:270.2  
 Median : 885.9   Median :0.032113   Median : 0.02124   Median :272.1  
 Mean   : 939.1   Mean   :0.047361   Mean   : 0.04542   Mean   :272.1  
 3rd Qu.: 994.1   3rd Qu.:0.091924   3rd Qu.: 0.17304   3rd Qu.:273.9  
 Max.   :1146.9   Max.   :0.091924   Max.   : 0.23650   Max.   :276.7  
                                                                       
    Tavg.X02        Tavg.X03        Tavg.X04        Tavg.X05    
 Min.   :268.1   Min.   :272.7   Min.   :278.4   Min.   :282.9  
 1st Qu.:272.1   1st Qu.:276.0   1st Qu.:282.2   1st Qu.:286.2  
 Median :273.7   Median :277.7   Median :283.1   Median :287.6  
 Mean   :273.5   Mean   :277.5   Mean   :283.1   Mean   :287.5  
 3rd Qu.:275.2   3rd Qu.:279.0   3rd Qu.:284.2   3rd Qu.:288.7  
 Max.   :277.8   Max.   :280.9   Max.   :286.0   Max.   :291.2  
                                                                
    Tavg.X06        Tavg.X07        Tavg.X08        Tavg.X09    
 Min.   :288.3   Min.   :290.1   Min.   :289.9   Min.   :286.6  
 1st Qu.:290.9   1st Qu.:292.7   1st Qu.:292.3   1st Qu.:288.8  
 Median :291.8   Median :293.6   Median :293.2   Median :289.6  
 Mean   :291.7   Mean   :293.5   Mean   :293.1   Mean   :289.6  
 3rd Qu.:292.4   3rd Qu.:294.4   3rd Qu.:294.0   3rd Qu.:290.3  
 Max.   :294.3   Max.   :295.5   Max.   :295.2   Max.   :292.3  
                                                                
    Tavg.X10        Tavg.X11        Tavg.X12     Tavg.X01.prev  
 Min.   :281.3   Min.   :274.4   Min.   :267.6   Min.   :267.0  
 1st Qu.:283.1   1st Qu.:277.1   1st Qu.:272.4   1st Qu.:270.5  
 Median :283.6   Median :278.9   Median :274.0   Median :272.5  
 Mean   :283.8   Mean   :278.7   Mean   :273.9   Mean   :272.4  
 3rd Qu.:284.8   3rd Qu.:280.2   3rd Qu.:276.1   3rd Qu.:274.2  
 Max.   :287.5   Max.   :281.7   Max.   :277.6   Max.   :276.7  
                                                                
 Tavg.X02.prev   Tavg.X03.prev   Tavg.X04.prev   Tavg.X05.prev  
 Min.   :268.1   Min.   :272.7   Min.   :278.4   Min.   :282.9  
 1st Qu.:272.0   1st Qu.:276.0   1st Qu.:282.0   1st Qu.:286.1  
 Median :273.7   Median :277.8   Median :283.0   Median :287.3  
 Mean   :273.5   Mean   :277.6   Mean   :282.9   Mean   :287.3  
 3rd Qu.:275.2   3rd Qu.:279.3   3rd Qu.:284.1   3rd Qu.:288.5  
 Max.   :277.8   Max.   :280.9   Max.   :286.0   Max.   :291.2  
                                                                
 Tavg.X06.prev   Tavg.X07.prev   Tavg.X08.prev   Tavg.X09.prev  
 Min.   :288.3   Min.   :290.1   Min.   :289.9   Min.   :286.6  
 1st Qu.:290.9   1st Qu.:292.6   1st Qu.:292.3   1st Qu.:288.8  
 Median :291.8   Median :293.4   Median :293.1   Median :289.6  
 Mean   :291.6   Mean   :293.4   Mean   :293.0   Mean   :289.6  
 3rd Qu.:292.4   3rd Qu.:294.1   3rd Qu.:294.0   3rd Qu.:290.3  
 Max.   :294.3   Max.   :295.5   Max.   :295.2   Max.   :292.3  
                                                                
 Tavg.X10.prev   Tavg.X11.prev   Tavg.X12.prev     Precip.X01    
 Min.   :281.3   Min.   :274.4   Min.   :266.1   Min.   : 22.78  
 1st Qu.:283.1   1st Qu.:277.1   1st Qu.:271.8   1st Qu.: 53.30  
 Median :283.7   Median :278.6   Median :273.8   Median : 76.67  
 Mean   :283.9   Mean   :278.6   Mean   :273.5   Mean   : 84.84  
 3rd Qu.:284.8   3rd Qu.:280.1   3rd Qu.:275.6   3rd Qu.: 98.44  
 Max.   :287.5   Max.   :281.7   Max.   :277.6   Max.   :205.65  
                                                                 
   Precip.X02       Precip.X03       Precip.X04       Precip.X05    
 Min.   : 13.73   Min.   : 30.45   Min.   : 28.32   Min.   : 32.40  
 1st Qu.: 41.66   1st Qu.: 81.62   1st Qu.: 64.67   1st Qu.: 77.05  
 Median : 63.20   Median :104.71   Median : 98.33   Median :108.02  
 Mean   : 67.13   Mean   :105.83   Mean   : 95.27   Mean   :112.97  
 3rd Qu.: 77.62   3rd Qu.:123.64   3rd Qu.:121.06   3rd Qu.:145.32  
 Max.   :170.66   Max.   :198.21   Max.   :198.22   Max.   :240.60  
                                                                    
   Precip.X06       Precip.X07       Precip.X08       Precip.X09    
 Min.   : 25.00   Min.   : 30.30   Min.   : 32.19   Min.   :  3.68  
 1st Qu.: 61.95   1st Qu.: 84.92   1st Qu.: 68.43   1st Qu.: 57.31  
 Median : 89.39   Median :107.38   Median : 87.83   Median : 84.71  
 Mean   : 98.67   Mean   :114.15   Mean   : 88.88   Mean   :104.67  
 3rd Qu.:118.05   3rd Qu.:141.25   3rd Qu.:108.89   3rd Qu.:134.46  
 Max.   :247.88   Max.   :292.53   Max.   :164.82   Max.   :324.42  
                                                                    
   Precip.X10       Precip.X11       Precip.X12     Precip.X01.prev 
 Min.   :  2.42   Min.   : 10.18   Min.   : 38.78   Min.   : 28.39  
 1st Qu.: 40.60   1st Qu.: 60.89   1st Qu.: 58.01   1st Qu.: 56.73  
 Median : 57.70   Median : 85.75   Median : 81.31   Median : 76.67  
 Mean   : 74.28   Mean   : 84.73   Mean   : 85.56   Mean   : 86.55  
 3rd Qu.:104.97   3rd Qu.:108.36   3rd Qu.:102.03   3rd Qu.: 98.44  
 Max.   :239.31   Max.   :172.10   Max.   :180.88   Max.   :205.65  
                                                                    
 Precip.X02.prev  Precip.X03.prev  Precip.X04.prev  Precip.X05.prev 
 Min.   : 13.73   Min.   : 30.45   Min.   : 28.32   Min.   : 32.40  
 1st Qu.: 42.13   1st Qu.: 77.09   1st Qu.: 64.67   1st Qu.: 77.05  
 Median : 63.56   Median :104.52   Median : 98.15   Median :108.02  
 Mean   : 68.71   Mean   :104.89   Mean   : 92.05   Mean   :114.07  
 3rd Qu.: 77.91   3rd Qu.:119.70   3rd Qu.:116.40   3rd Qu.:146.24  
 Max.   :170.66   Max.   :198.21   Max.   :146.05   Max.   :240.60  
                                                                    
 Precip.X06.prev  Precip.X07.prev  Precip.X08.prev  Precip.X09.prev 
 Min.   : 25.00   Min.   : 30.30   Min.   : 32.19   Min.   :  3.68  
 1st Qu.: 62.45   1st Qu.: 88.58   1st Qu.: 73.14   1st Qu.: 57.31  
 Median : 93.04   Median :110.11   Median : 89.52   Median : 84.71  
 Mean   :102.60   Mean   :118.69   Mean   : 92.43   Mean   :106.24  
 3rd Qu.:128.93   3rd Qu.:144.76   3rd Qu.:110.18   3rd Qu.:136.56  
 Max.   :247.88   Max.   :292.53   Max.   :184.86   Max.   :324.42  
                                                                    
 Precip.X10.prev  Precip.X11.prev  Precip.X12.prev   BA.tree.cm2     
 Min.   :  2.42   Min.   : 10.18   Min.   : 38.78   Min.   :  2.932  
 1st Qu.: 40.60   1st Qu.: 60.89   1st Qu.: 56.32   1st Qu.: 38.387  
 Median : 57.70   Median : 81.88   Median : 77.58   Median : 48.852  
 Mean   : 75.34   Mean   : 83.78   Mean   : 83.24   Mean   :198.951  
 3rd Qu.:106.76   3rd Qu.:106.78   3rd Qu.: 99.80   3rd Qu.: 59.295  
 Max.   :239.31   Max.   :172.10   Max.   :180.88   Max.   :858.308  
                                                                     
> dim(bele.run)
[1] 110  90
> 
> #############
> # Vector with names of Months of the year
> months <- c("X01", "X02", "X03", "X04", "X05", "X06", "X07", "X08", "X09", "X10", "X11", "X12")
> 
> # Selecting which previous and current year months to include in model
> months.prev <- paste(months[6:12], "prev", sep=".") # Previous June through December
> months.curr <- paste(months[1:10], sep=".") # Current Junuary through October
> months.use <- c(months.prev, months.curr)
> 
> seasons <- c("pX06.pX08", "pX09.pX11", "pX12.X02", "X03.X05", "X06.X08", "X09.X11")
> seasons
[1] "pX06.pX08" "pX09.pX11" "pX12.X02"  "X03.X05"   "X06.X08"   "X09.X11"  
> 
> bele.run$Tavg.pX06.pX08 <- rowMeans(bele.run[,c("Tavg.X06.prev", "Tavg.X07.prev", "Tavg.X08.prev")])
> bele.run$Tavg.pX09.pX11 <- rowMeans(bele.run[,c("Tavg.X09.prev", "Tavg.X10.prev", "Tavg.X11.prev")])
> bele.run$Tavg.pX12.X02 <- rowMeans(bele.run[,c("Tavg.X12.prev", "Tavg.X01", "Tavg.X02")])
> bele.run$Tavg.X03.X05 <- rowMeans(bele.run[,c("Tavg.X03", "Tavg.X04", "Tavg.X05")])
> bele.run$Tavg.X06.X08 <- rowMeans(bele.run[,c("Tavg.X06", "Tavg.X07", "Tavg.X08")])
> bele.run$Tavg.X09.X11 <- rowMeans(bele.run[,c("Tavg.X09", "Tavg.X10", "Tavg.X11")])
> 
> bele.run$Precip.pX06.pX08 <- rowMeans(bele.run[,c("Precip.X06.prev", "Precip.X07.prev", "Precip.X08.prev")])
> bele.run$Precip.pX09.pX11 <- rowMeans(bele.run[,c("Precip.X09.prev", "Precip.X10.prev", "Precip.X11.prev")])
> bele.run$Precip.pX12.X02 <- rowMeans(bele.run[,c("Precip.X12.prev", "Precip.X01", "Precip.X02")])
> bele.run$Precip.X03.X05 <- rowMeans(bele.run[,c("Precip.X03", "Precip.X04", "Precip.X05")])
> bele.run$Precip.X06.X08 <- rowMeans(bele.run[,c("Precip.X06", "Precip.X07", "Precip.X08")])
> bele.run$Precip.X09.X11 <- rowMeans(bele.run[,c("Precip.X09", "Precip.X10", "Precip.X11")])
> 
> 
> # Making vectors with the column names of the temp & precip months of interest
> temp.col <- paste("Tavg", seasons, sep=".")
> precip.col <- paste("Precip", seasons, sep=".")
> 
> # Column numbers of temp & precip months of interest
> temp.col.ind <- which(names(bele.run) %in% c(temp.col))
> precip.col.ind <- which(names(bele.run) %in% c(precip.col))
> summary(bele.run[,temp.col.ind])
 Tavg.pX06.pX08  Tavg.pX09.pX11  Tavg.pX12.X02    Tavg.X03.X05  
 Min.   :290.2   Min.   :281.8   Min.   :269.4   Min.   :279.3  
 1st Qu.:292.2   1st Qu.:283.3   1st Qu.:271.8   1st Qu.:281.8  
 Median :292.7   Median :284.0   Median :273.4   Median :282.9  
 Mean   :292.7   Mean   :284.0   Mean   :273.1   Mean   :282.7  
 3rd Qu.:293.3   3rd Qu.:284.6   3rd Qu.:274.2   3rd Qu.:283.6  
 Max.   :294.7   Max.   :285.6   Max.   :275.8   Max.   :285.4  
  Tavg.X06.X08    Tavg.X09.X11  
 Min.   :290.2   Min.   :281.8  
 1st Qu.:292.2   1st Qu.:283.4  
 Median :292.7   Median :284.0  
 Mean   :292.7   Mean   :284.0  
 3rd Qu.:293.4   3rd Qu.:284.7  
 Max.   :294.7   Max.   :285.6  
> summary(bele.run[,precip.col.ind])
 Precip.pX06.pX08 Precip.pX09.pX11 Precip.pX12.X02  Precip.X03.X05  
 Min.   : 56.16   Min.   : 25.07   Min.   : 31.93   Min.   : 58.91  
 1st Qu.: 84.30   1st Qu.: 60.67   1st Qu.: 60.99   1st Qu.: 89.43  
 Median : 97.22   Median : 89.76   Median : 73.58   Median :105.79  
 Mean   :104.57   Mean   : 88.45   Mean   : 78.41   Mean   :104.69  
 3rd Qu.:120.33   3rd Qu.:112.18   3rd Qu.: 96.18   3rd Qu.:118.96  
 Max.   :167.41   Max.   :158.02   Max.   :134.40   Max.   :159.48  
 Precip.X06.X08   Precip.X09.X11  
 Min.   : 56.16   Min.   : 25.07  
 1st Qu.: 80.18   1st Qu.: 60.67  
 Median : 95.67   Median : 89.76  
 Mean   :100.57   Mean   : 87.89  
 3rd Qu.:118.80   3rd Qu.:109.66  
 Max.   :163.01   Max.   :158.02  
> length(temp.col.ind)
[1] 6
> 
> # bele.run$Tavg.yr <- rowMeans(bele.run[,temp.col.ind])
> # bele.run$Precip.yr <- rowSums(bele.run[,precip.col.ind])
> 
> write.csv(bele.run, "Inputs/BELE_AllSites_1990-2011.csv", row.names=F)
> 
> #############
> # Reading in Data
> bele.run <- read.csv("Inputs/BELE_AllSites_1990-2011.csv")
> summary(bele.run)
      Year        PlotID       TreeID    Site    Trans       Plot    
 Min.   :1990   BLDA4:22   BLDA410:22   BLD:44   A:44   Min.   :1.0  
 1st Qu.:1995   BLDB1:22   BLDB133:22   HIK:44   B:22   1st Qu.:2.0  
 Median :2000   HIKC2:44   HIKC202:22   MOR:22   C:44   Median :2.0  
 Mean   :2000   MORA2:22   HIKC206:22                   Mean   :2.2  
 3rd Qu.:2006              MORA222:22                   3rd Qu.:2.0  
 Max.   :2011                                           Max.   :4.0  
      BAI                CoreID   Pith      Pith.Yr         Inner     
 Min.   :  2.639   BLDA410HI:22   N:44   Min.   :1809   Min.   :1815  
 1st Qu.: 51.272   BLDB133HI:22   Y:66   1st Qu.:1939   1st Qu.:1940  
 Median :101.791   HIKC202HI:22          Median :1954   Median :1955  
 Mean   :141.364   HIKC206HI:22          Mean   :1931   Mean   :1933  
 3rd Qu.:187.996   MORA222HI:22          3rd Qu.:1969   3rd Qu.:1970  
 Max.   :870.213                         Max.   :1982   Max.   :1983  
     Outer      Bark    Use                    Notes     Pith.offset
 Min.   :2012   Y:110   N:22   2002 & 2003 missing:22   Min.   :1   
 1st Qu.:2012           Y:88   dots off on core   :22   1st Qu.:1   
 Median :2012                  false ring in 1952 :22   Median :1   
 Mean   :2012                  meaured            :22   Mean   :2   
 3rd Qu.:2012                  poor corr w/ master:22   3rd Qu.:1   
 Max.   :2012                                           Max.   :6   
      Tree        Spp         Genus     Canopy   Live          Age        
 Min.   : 2.0   BELE:110   Betula:110   C:22   LIVE:110   Min.   :  8.00  
 1st Qu.: 6.0                           I:66              1st Qu.: 28.00  
 Median :10.0                           U:22              Median : 46.50  
 Mean   :14.6                                             Mean   : 69.90  
 3rd Qu.:22.0                                             3rd Qu.: 66.75  
 Max.   :33.0                                             Max.   :202.00  
    BA.m2ha           BAI.filled         BA.tree            Stems  
 Min.   :0.009333   Min.   :  2.639   Min.   :  293.2   Min.   :1  
 1st Qu.:0.122187   1st Qu.: 51.272   1st Qu.: 3838.7   1st Qu.:1  
 Median :0.155496   Median :101.791   Median : 4885.2   Median :1  
 Mean   :0.633262   Mean   :141.364   Mean   :19895.1   Mean   :1  
 3rd Qu.:0.188737   3rd Qu.:187.996   3rd Qu.: 5929.5   3rd Qu.:1  
 Max.   :2.731994   Max.   :870.213   Max.   :85830.8   Max.   :1  
   Density.Ha    BAI.filled.plot    BA.plot       BA.m2ha.plot  
 Min.   :31.83   Min.   : 9110   Min.   : 5307   Min.   :13.23  
 1st Qu.:31.83   1st Qu.:12622   1st Qu.: 7891   1st Qu.:18.14  
 Median :31.83   Median :14550   Median : 9317   Median :22.02  
 Mean   :31.83   Mean   :14833   Mean   : 9254   Mean   :23.45  
 3rd Qu.:31.83   3rd Qu.:17569   3rd Qu.:10715   3rd Qu.:28.94  
 Max.   :31.83   Max.   :22904   Max.   :12803   Max.   :35.42  
 Density.ha.plot    Stems.plot    BAI.m2ha.plot    BA.m2ha.plot.live
 Min.   : 700.3   Min.   :22.00   Min.   :0.2900   Min.   :14.42    
 1st Qu.: 795.8   1st Qu.:25.00   1st Qu.:0.4018   1st Qu.:22.47    
 Median : 827.6   Median :26.00   Median :0.4632   Median :27.53    
 Mean   : 847.6   Mean   :26.63   Mean   :0.4721   Mean   :27.04    
 3rd Qu.: 859.4   3rd Qu.:27.00   3rd Qu.:0.5592   3rd Qu.:31.39    
 Max.   :1018.6   Max.   :32.00   Max.   :0.7290   Max.   :38.38    
     RelBA          Site.Trans    Latitude       Longitude     
 Min.   :0.004402   BLDA:22    Min.   :37.72   Min.   :-80.11  
 1st Qu.:0.023887   BLDB:22    1st Qu.:37.92   1st Qu.:-79.85  
 Median :0.063685   HIKC:44    Median :37.92   Median :-79.84  
 Mean   :0.129723   MORA:22    Mean   :38.14   Mean   :-79.62  
 3rd Qu.:0.083103              3rd Qu.:38.57   3rd Qu.:-79.15  
 Max.   :0.540835              Max.   :38.57   Max.   :-79.15  
      elev             flow               TPI              Tavg.X01    
 Min.   : 834.4   Min.   :0.007416   Min.   :-0.10184   Min.   :267.0  
 1st Qu.: 834.4   1st Qu.:0.013427   1st Qu.:-0.10184   1st Qu.:270.2  
 Median : 885.9   Median :0.032113   Median : 0.02124   Median :272.1  
 Mean   : 939.1   Mean   :0.047361   Mean   : 0.04542   Mean   :272.1  
 3rd Qu.: 994.1   3rd Qu.:0.091924   3rd Qu.: 0.17304   3rd Qu.:273.9  
 Max.   :1146.9   Max.   :0.091924   Max.   : 0.23650   Max.   :276.7  
    Tavg.X02        Tavg.X03        Tavg.X04        Tavg.X05    
 Min.   :268.1   Min.   :272.7   Min.   :278.4   Min.   :282.9  
 1st Qu.:272.1   1st Qu.:276.0   1st Qu.:282.2   1st Qu.:286.2  
 Median :273.7   Median :277.7   Median :283.1   Median :287.6  
 Mean   :273.5   Mean   :277.5   Mean   :283.1   Mean   :287.5  
 3rd Qu.:275.2   3rd Qu.:279.0   3rd Qu.:284.2   3rd Qu.:288.7  
 Max.   :277.8   Max.   :280.9   Max.   :286.0   Max.   :291.2  
    Tavg.X06        Tavg.X07        Tavg.X08        Tavg.X09    
 Min.   :288.3   Min.   :290.1   Min.   :289.9   Min.   :286.6  
 1st Qu.:290.9   1st Qu.:292.7   1st Qu.:292.3   1st Qu.:288.8  
 Median :291.8   Median :293.6   Median :293.2   Median :289.6  
 Mean   :291.7   Mean   :293.5   Mean   :293.1   Mean   :289.6  
 3rd Qu.:292.4   3rd Qu.:294.4   3rd Qu.:294.0   3rd Qu.:290.3  
 Max.   :294.3   Max.   :295.5   Max.   :295.2   Max.   :292.3  
    Tavg.X10        Tavg.X11        Tavg.X12     Tavg.X01.prev  
 Min.   :281.3   Min.   :274.4   Min.   :267.6   Min.   :267.0  
 1st Qu.:283.1   1st Qu.:277.1   1st Qu.:272.4   1st Qu.:270.5  
 Median :283.6   Median :278.9   Median :274.0   Median :272.5  
 Mean   :283.8   Mean   :278.7   Mean   :273.9   Mean   :272.4  
 3rd Qu.:284.8   3rd Qu.:280.2   3rd Qu.:276.1   3rd Qu.:274.2  
 Max.   :287.5   Max.   :281.7   Max.   :277.6   Max.   :276.7  
 Tavg.X02.prev   Tavg.X03.prev   Tavg.X04.prev   Tavg.X05.prev  
 Min.   :268.1   Min.   :272.7   Min.   :278.4   Min.   :282.9  
 1st Qu.:272.0   1st Qu.:276.0   1st Qu.:282.0   1st Qu.:286.1  
 Median :273.7   Median :277.8   Median :283.0   Median :287.3  
 Mean   :273.5   Mean   :277.6   Mean   :282.9   Mean   :287.3  
 3rd Qu.:275.2   3rd Qu.:279.3   3rd Qu.:284.1   3rd Qu.:288.5  
 Max.   :277.8   Max.   :280.9   Max.   :286.0   Max.   :291.2  
 Tavg.X06.prev   Tavg.X07.prev   Tavg.X08.prev   Tavg.X09.prev  
 Min.   :288.3   Min.   :290.1   Min.   :289.9   Min.   :286.6  
 1st Qu.:290.9   1st Qu.:292.6   1st Qu.:292.3   1st Qu.:288.8  
 Median :291.8   Median :293.4   Median :293.1   Median :289.6  
 Mean   :291.6   Mean   :293.4   Mean   :293.0   Mean   :289.6  
 3rd Qu.:292.4   3rd Qu.:294.1   3rd Qu.:294.0   3rd Qu.:290.3  
 Max.   :294.3   Max.   :295.5   Max.   :295.2   Max.   :292.3  
 Tavg.X10.prev   Tavg.X11.prev   Tavg.X12.prev     Precip.X01    
 Min.   :281.3   Min.   :274.4   Min.   :266.1   Min.   : 22.78  
 1st Qu.:283.1   1st Qu.:277.1   1st Qu.:271.8   1st Qu.: 53.30  
 Median :283.7   Median :278.6   Median :273.8   Median : 76.67  
 Mean   :283.9   Mean   :278.6   Mean   :273.5   Mean   : 84.84  
 3rd Qu.:284.8   3rd Qu.:280.1   3rd Qu.:275.6   3rd Qu.: 98.44  
 Max.   :287.5   Max.   :281.7   Max.   :277.6   Max.   :205.65  
   Precip.X02       Precip.X03       Precip.X04       Precip.X05    
 Min.   : 13.73   Min.   : 30.45   Min.   : 28.32   Min.   : 32.40  
 1st Qu.: 41.66   1st Qu.: 81.62   1st Qu.: 64.67   1st Qu.: 77.05  
 Median : 63.20   Median :104.71   Median : 98.33   Median :108.02  
 Mean   : 67.13   Mean   :105.83   Mean   : 95.27   Mean   :112.97  
 3rd Qu.: 77.62   3rd Qu.:123.64   3rd Qu.:121.06   3rd Qu.:145.32  
 Max.   :170.66   Max.   :198.21   Max.   :198.22   Max.   :240.60  
   Precip.X06       Precip.X07       Precip.X08       Precip.X09    
 Min.   : 25.00   Min.   : 30.30   Min.   : 32.19   Min.   :  3.68  
 1st Qu.: 61.95   1st Qu.: 84.92   1st Qu.: 68.43   1st Qu.: 57.31  
 Median : 89.39   Median :107.38   Median : 87.83   Median : 84.71  
 Mean   : 98.67   Mean   :114.15   Mean   : 88.88   Mean   :104.67  
 3rd Qu.:118.05   3rd Qu.:141.25   3rd Qu.:108.89   3rd Qu.:134.46  
 Max.   :247.88   Max.   :292.53   Max.   :164.82   Max.   :324.42  
   Precip.X10       Precip.X11       Precip.X12     Precip.X01.prev 
 Min.   :  2.42   Min.   : 10.18   Min.   : 38.78   Min.   : 28.39  
 1st Qu.: 40.60   1st Qu.: 60.89   1st Qu.: 58.01   1st Qu.: 56.73  
 Median : 57.70   Median : 85.75   Median : 81.31   Median : 76.67  
 Mean   : 74.28   Mean   : 84.73   Mean   : 85.56   Mean   : 86.55  
 3rd Qu.:104.97   3rd Qu.:108.36   3rd Qu.:102.03   3rd Qu.: 98.44  
 Max.   :239.31   Max.   :172.10   Max.   :180.88   Max.   :205.65  
 Precip.X02.prev  Precip.X03.prev  Precip.X04.prev  Precip.X05.prev 
 Min.   : 13.73   Min.   : 30.45   Min.   : 28.32   Min.   : 32.40  
 1st Qu.: 42.13   1st Qu.: 77.09   1st Qu.: 64.67   1st Qu.: 77.05  
 Median : 63.56   Median :104.52   Median : 98.15   Median :108.02  
 Mean   : 68.71   Mean   :104.89   Mean   : 92.05   Mean   :114.07  
 3rd Qu.: 77.91   3rd Qu.:119.70   3rd Qu.:116.40   3rd Qu.:146.24  
 Max.   :170.66   Max.   :198.21   Max.   :146.05   Max.   :240.60  
 Precip.X06.prev  Precip.X07.prev  Precip.X08.prev  Precip.X09.prev 
 Min.   : 25.00   Min.   : 30.30   Min.   : 32.19   Min.   :  3.68  
 1st Qu.: 62.45   1st Qu.: 88.58   1st Qu.: 73.14   1st Qu.: 57.31  
 Median : 93.04   Median :110.11   Median : 89.52   Median : 84.71  
 Mean   :102.60   Mean   :118.69   Mean   : 92.43   Mean   :106.24  
 3rd Qu.:128.93   3rd Qu.:144.76   3rd Qu.:110.18   3rd Qu.:136.56  
 Max.   :247.88   Max.   :292.53   Max.   :184.86   Max.   :324.42  
 Precip.X10.prev  Precip.X11.prev  Precip.X12.prev   BA.tree.cm2     
 Min.   :  2.42   Min.   : 10.18   Min.   : 38.78   Min.   :  2.932  
 1st Qu.: 40.60   1st Qu.: 60.89   1st Qu.: 56.32   1st Qu.: 38.387  
 Median : 57.70   Median : 81.88   Median : 77.58   Median : 48.852  
 Mean   : 75.34   Mean   : 83.78   Mean   : 83.24   Mean   :198.951  
 3rd Qu.:106.76   3rd Qu.:106.78   3rd Qu.: 99.80   3rd Qu.: 59.295  
 Max.   :239.31   Max.   :172.10   Max.   :180.88   Max.   :858.308  
 Tavg.pX06.pX08  Tavg.pX09.pX11  Tavg.pX12.X02    Tavg.X03.X05  
 Min.   :290.2   Min.   :281.8   Min.   :269.4   Min.   :279.3  
 1st Qu.:292.2   1st Qu.:283.3   1st Qu.:271.8   1st Qu.:281.8  
 Median :292.7   Median :284.0   Median :273.4   Median :282.9  
 Mean   :292.7   Mean   :284.0   Mean   :273.1   Mean   :282.7  
 3rd Qu.:293.3   3rd Qu.:284.6   3rd Qu.:274.2   3rd Qu.:283.6  
 Max.   :294.7   Max.   :285.6   Max.   :275.8   Max.   :285.4  
  Tavg.X06.X08    Tavg.X09.X11   Precip.pX06.pX08 Precip.pX09.pX11
 Min.   :290.2   Min.   :281.8   Min.   : 56.16   Min.   : 25.07  
 1st Qu.:292.2   1st Qu.:283.4   1st Qu.: 84.30   1st Qu.: 60.67  
 Median :292.7   Median :284.0   Median : 97.22   Median : 89.76  
 Mean   :292.7   Mean   :284.0   Mean   :104.57   Mean   : 88.45  
 3rd Qu.:293.4   3rd Qu.:284.7   3rd Qu.:120.33   3rd Qu.:112.18  
 Max.   :294.7   Max.   :285.6   Max.   :167.41   Max.   :158.02  
 Precip.pX12.X02  Precip.X03.X05   Precip.X06.X08   Precip.X09.X11  
 Min.   : 31.93   Min.   : 58.91   Min.   : 56.16   Min.   : 25.07  
 1st Qu.: 60.99   1st Qu.: 89.43   1st Qu.: 80.18   1st Qu.: 60.67  
 Median : 73.58   Median :105.79   Median : 95.67   Median : 89.76  
 Mean   : 78.41   Mean   :104.69   Mean   :100.57   Mean   : 87.89  
 3rd Qu.: 96.18   3rd Qu.:118.96   3rd Qu.:118.80   3rd Qu.:109.66  
 Max.   :134.40   Max.   :159.48   Max.   :163.01   Max.   :158.02  
> 
> # Loading previous runs
> #load(file="Test results for BELE 4 - All Sites 1990-2011.Rdata")
> 
> 
> ####################################################################################################################
> overall.model <- function(
+ 							   SIZE,aa,ab, gmax,             # Autogenic (a) -- ABSOLUTE UNITS (from gmax)
+                             BA.PLOT,RS,ca,cb,cc,cd,ce,cf,cg, # Competition (c) -- scalar
+                             # # BA.PLOT,RS,ca,cb,cc,cd,cf,cg, # Competition (c) -- scalar, removed intercept
+                             TEMP,ta1,tb1,					 # Temperature (t) -- scalar
+                             PRECIP,FLOW,pa1,pb1,pc1         		 # Preciptiation (p) -- scalar
+                             # TRANS, ha		             	 # Habitat (h) -- scalar
+                             )
+ 	{
+ 	################
+ 	# Autogenic Growth: 0-1 * gmax (max possible growth, absolute units)
+ 	################
+ 	autogenic.effect <- gmax*(1 - aa*exp(-ab*SIZE))   
+ 	# autogenic.effect <- gmax*(1-aa*exp(-ab*SIZE))   
+ 
+ 
+ 	################
+ 	# Competition Effect: 0-1 
+ 	################
+ 	size.effect <- ca*exp(-cb*(RS^cc))
+ 	comp.effect <- (ce/1000 + ( (1-ce/1000)/(1+(BA.PLOT/cf)^cg)))
+ 	# comp.effect <- (1/(1+(BA.PLOT/cf)^cg))
+ 	comp.response <- exp(-size.effect*(comp.effect^cd))
+ 
+  	################
+ 	# Climate Effect: Now Scalar
+ 	################
+ 	
+ 	#Temp on scale 0-1
+     temp.effect <- t(exp(-0.5*((t(TEMP)-ta1)/tb1)^2))
+ 
+     # Precip on scale 0-1
+     # precip.effect <- t(1/(1+(t(PRECIP)/pa1)^pb1))
+ 	precip.effect <- t(exp(-0.5*((t(PRECIP+pc1*FLOW*PRECIP)-pa1)/pb1)^2)) # Gaussian Data Frame
+ 
+ 	# Multiplying temp & precip together
+     climate.effect <- temp.effect * precip.effect
+ 	 
+ 	 ### LEM: do row sums
+ 	 ##### CRR note: I think this should be on a scale from 0-1; 
+      # climate.effect <- colSums(climate.effect) 
+ 	 climate.effect2 <- apply(climate.effect, 1, FUN=prod)
+ 	
+ 
+ 	################
+ 	# Habitat Effect: 0-1
+ 	# Note: removed from model for the moment, may add Topographic position or upslope area later
+ 	################
+ 	# habitat.effect <- ha[TRANS]
+ 
+ 	# comp.response <- 1
+ 	habitat.effect <- 1
+ 	# climate.effect2 <- precip.effect
+ 
+ 	autogenic.effect*comp.response*habitat.effect*climate.effect2
+ 	
+ 
+ 	}
> 
> 
> ####################################################################################################################
> ####################################################################################################################
> ### setting up annealing
> 
> # par <- results$best_par
> 
> # need a list that gives initial values for all of the "parameters"
> par<-list(
+ 		  aa=0.8705, ab=806.17, gmax=10000,  	# Autogenic
+           ca=2000, cb=961.71, cc=3.37, cd=2.95, ce=85.58, cf=994.3, cg=-56.53,  # Competition
+           ta1=c(271.3,	262.0,	276.39,	305.53,	301.6,	278.0), 
+           tb1=c(312.0,	12.3,	492.0,	432.12,	7.64,	315.04),
+           pa1=c(312.02,	5.0,		104.75,	30.23,	0.13,	58.56), 
+           pb1=c(177.53,	1706.55,41.40,	1464.7,	1458.26,81.186), 
+           pc1=0.281, 
+           # # ha=rep(0.5,3),  # Habitat
+           sd=89.84)
> 
> # also need a list that identifies the independent variables
> var <- list(SIZE = "BA.tree.cm2",  # Autogenic
+             BA.PLOT="BA.m2ha.plot.live", RS="RelBA",  # Competition
+             TEMP = bele.run[,temp.col.ind], # hard-coded above
+             PRECIP = bele.run[,precip.col.ind], FLOW="flow"
+             # TRANS="Site.Trans" # Habitat
+             )
> 
> ## Set bounds and initial search ranges within which to search for parameters
> ##   NOTE:  the s and sd parameters have to be greater than zero (algebraically)
> par_lo <-list(
+ 			  aa=0, ab=0, gmax=0,  # Autogenic
+               ca=0, cb=0, cc=0, cd=0, ce=0, cf=-100, cg=-1000, # Competition
+               # # ca=0, cb=0, cc=0, cd=0, cf=-100, cg=-200, # Competition
+               ta1=rep(250, length=length(temp.col.ind)), tb1=rep(0, length=length(temp.col.ind)),
+               pa1=rep(0, length=length(precip.col.ind)), pb1=rep(0, length=length(precip.col.ind)), pc1=0,
+ 			# ha=rep(0,3), # Habitat
+               sd=0.1)
> 
> 
> par_hi <-list(
+ 			  aa=1, ab=1000, gmax=10000, # Autogenic
+               ca=2000, cb=1000, cc=5, cd=5, ce=1000, cf=1000, cg=1000,	# Competition
+               # # ca=1000, cb=1000, cc=50, cd=5, cf=500, cg=1000,	# Competition
+               ta1=rep(325, length=length(temp.col.ind)), tb1=rep(500, length=length(temp.col.ind)),
+               pa1=rep(500, length=length(precip.col.ind)), pb1=rep(2000, length=length(precip.col.ind)), pc1=1,
+               # ha=rep(1,3), # Habitat
+               sd=1000)
> 
> ## Specify the dependent variable, and name it using whatever
> ##    argument name is used in the pdf ("x" in the normal.pdf function above)
> var$x<-"BAI"
> 
> ## predicted value in your PDF should be given the reserved name "predicted"
> ##   Anneal will use your scientific model and your data and calculate the
> ##   predicted value for each observation and store it internally in an object
> ##   called "predicted"
> var$mean<-"predicted"
> 
> ## Have it calculate log likelihood
> var$log<-TRUE
> 
> ##  now call the annealing algorithm, choosing which model to use
> #  "data" should be whatever the name of your dataframe is...
> results <- anneal(overall.model, par, var, bele.run, par_lo, par_hi, dnorm, "BAI", hessian = T, slimit=1.92, max_iter=100000)
> 
> save(results,file=file.path("Outputs", paste( run.label, "_Results.Rdata", sep="")))
> 
> write_results(results,file.path("Outputs", paste( run.label, "_Results.txt", sep="")))
> 
> ## display some of the results in the console
> results$best_pars;
$aa
[1] 0.8672795

$ab
[1] 0.1902302

$gmax
[1] 10000

$ca
[1] 80.40784

$cb
[1] 25.73278

$cc
[1] 3.26507

$cd
[1] 0.005532581

$ce
[1] 9.529044e-320

$cf
[1] 311.8725

$cg
[1] -298.8825

$ta1
[1] 307.7608 280.4469 250.0000 283.5347 301.3426 250.9069

$tb1
[1]  16.222264   4.079866  39.726828   2.313876   5.528088 339.915449

$pa1
[1] 1.275108e+02 4.754619e+02 1.061342e+02 3.182733e-03 3.622787e+02
[6] 7.656040e+01

$pb1
[1]  49.34461 862.72621  50.87848 616.23083 776.19945  57.26319

$pc1
[1] 0.008153213

$sd
[1] 78.3437

> results$max_likeli;
[1] -634.5625
> results$aic_corr ;
[1] 1377.618
> results$slope;
[1] 1.011272
> results$R2
[1] 0.7058615
> 
> ####################################################################################################################
> ####################################################################################################################
> load(file=file.path("Outputs", paste( run.label, "_Results.Rdata", sep="")))
> 
> 
> # Looking at Residuals and Parameters
> #windows()
> plot(results$source_data$predicted,results$source_data$BAI,xlab="Predicted",ylab="Observed")
> abline(0,1,lwd=2,col="red")
> 
> results$source_data$residual <- results$source_data$BAI - results$source_data$predicted
> #windows()
> hist(results$source_data$residual)
> 
> 
> ##################################
> autogenic.effect <- function(SIZE,aa,ab) { (1 - aa*exp(-ab*SIZE))  }
> ##################################
> plot(BAI ~ BA.tree.cm2, data=results$source_data)
> plot(BAI ~ Age, data=results$source_data)
> plot(BA.tree.cm2 ~ Age, data=results$source_data)
> 
> summary(results$source_data$BA.tree.cm2)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  2.932  38.390  48.850 199.000  59.300 858.300 
> summary(results$source_data$Age)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   8.00   28.00   46.50   69.90   66.75  202.00 
> 
> # Effect of Tree Basal Area
> #windows()
> par(mar=c(5,5,4,2), mfrow=c(1,1))
> x <- seq(0,max(ceiling(results$source_data$BA.tree.cm2)),1)
> y <- autogenic.effect(x,results$best_pars$aa,results$best_pars$ab)
> 
> pdf(file.path("Figures", paste(run.label, " - Autogenic Scalar.pdf", sep="")))
> plot(x,y,ylim=c(0,1),xlab="Tree Basal Area (cm2)",ylab="Effect of Size on Growth",
+      cex.axis=1.25,cex.lab=1.5,type="l",lwd=2,main=run.label)
> dev.off()
pdf 
  2 
> 
> 
> #################################
> size.effect <- function(SIZE,ca,cb,cc) {ca*exp(-cb*(SIZE^cc))}
> comp.effect <- function(BA.PLOT,ce,cf,cg) {ce/1000 + ( (1-ce/1000)/(1+(BA.PLOT/cf)^cg))}
> comp.response <- function(SIZE,BA.PLOT,ca,cb,cc,cd,ce,cf,cg)
+   { size.effect <- ca*exp(-cb*(SIZE^cc))
+     comp.effect <- (ce/1000 + ( (1-ce/1000)/(1+(BA.PLOT/cf)^cg)))
+     comp.response <- exp(-size.effect*(comp.effect^cd)) }
> ##################################
> # Size Effect
> plot(BAI ~ RelBA, data=results$source_data)
> 
> par(mar=c(5,5,4,2))
> x <- seq(0,1,0.01)
> y <- size.effect(x,results$best_pars$ca, results$best_pars$cb,results$best_pars$cc)
> summary(y)
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
 0.00000  0.00344  5.53100 26.79000 60.87000 80.41000 
> 
> pdf(file.path("Figures", paste(run.label, " - Competition Size Effect.pdf", sep="")))
> plot(x,y,xlab="Relative Size",ylab="Size Effect",type="l",lwd=2,
+       cex.lab=1.5,cex.axis=1.25,main=run.label)
> #savePlot(file=paste("Competition Plot 1 ",run.label,".png",sep=""),type="png")
> dev.off()
pdf 
  2 
> 
> #####################
> # Plot BA effect
> plot(BAI ~ BA.m2ha.plot, data=results$source_data)
> 
> par(mar=c(5,5,4,2))
> x <- seq(0,60,0.1)
> y <- comp.effect(x, results$best_pars$ce, results$best_pars$cf,results$best_pars$cg)
> summary(y)
      Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
 0.000e+00  0.000e+00  0.000e+00 4.770e-217  0.000e+00 1.128e-214 
> 
> pdf(file.path("Figures", paste(run.label, " - Competition Competitive Effect.pdf", sep="")))
> plot(x,y,ylim=c(0,1),xlab="Plot BA",ylab="Competitive Effect",type="l",lwd=2,
+        cex.lab=1.5,cex.axis=1.25,main=run.label)
> dev.off()
pdf 
  2 
> #savePlot(file=paste("Competition Plot 2 ",run.label,".png",sep=""),type="png")
> 
> #####################
> # Competition Response: Size vs. Response with different plot BA levels
> plot(BA.m2ha.plot~ RelBA, data=results$source_data)
> 
> 
> pdf(file.path("Figures", paste(run.label, " - Competition Response Scalar.pdf", sep="")))
> par(mar=c(5,5,4,2))
> colors <- c("red","orange","blue","cyan","green")
> x <- seq(0,1,0.01)
> y <- comp.response(SIZE=x, BA.PLOT=50, results$best_pars$ca, results$best_pars$cb, results$best_pars$cc, results$best_pars$cd, results$best_pars$ce, results$best_pars$cf, results$best_pars$cg)
> plot(x,y,ylim=c(0,1),xlab="Relative Size",ylab="Competition Scalar",type="l",col=colors[1],lwd=2,
+      cex.lab=1.5,cex.axis=1.25,main=run.label)
> y <- comp.response(SIZE=x, BA.PLOT=40, results$best_pars$ca, results$best_pars$cb, results$best_pars$cc, results$best_pars$cd, results$best_pars$ce, results$best_pars$cf, results$best_pars$cg)
> lines(x,y,col=colors[2],lwd=2)
> y <- comp.response(SIZE=x, BA.PLOT=30, results$best_pars$ca, results$best_pars$cb, results$best_pars$cc, results$best_pars$cd, results$best_pars$ce, results$best_pars$cf, results$best_pars$cg)
> lines(x,y,col=colors[3],lwd=2)
> y <- comp.response(SIZE=x, BA.PLOT=20, results$best_pars$ca, results$best_pars$cb, results$best_pars$cc, results$best_pars$cd, results$best_pars$ce, results$best_pars$cf, results$best_pars$cg)
> lines(x,y,col=colors[4],lwd=2)
> y <- comp.response(SIZE=x, BA.PLOT=10, results$best_pars$ca, results$best_pars$cb, results$best_pars$cc, results$best_pars$cd, results$best_pars$ce, results$best_pars$cf, results$best_pars$cg)
> lines(x,y,col=colors[5],lwd=2)
> lines(x,y,col=colors[6],lwd=2)
> legend("bottomright",legend=c(50,40,30,20,10),col=colors,bty="n",lwd=2,title="Plot\nBasal\nArea",cex=1.25)
> dev.off()
pdf 
  2 
> #savePlot(file=paste("Competition Plot 3 ",run.label,".png",sep=""),type="png")
> 
> 
> ##################################
> temp.effect <- function(TEMP,ta1,tb1)
+        { t(exp(-0.5*((t(TEMP)-ta1)/tb1)^2))  }
> 
> precip.effect <- function(PRECIP,FLOW,pa1,pb1,pc1)
+        { exp(-0.5*((t(PRECIP+pc1*FLOW*PRECIP)-pa1)/pb1)^2)) }
Error: unexpected ')' in:
"precip.effect <- function(PRECIP,FLOW,pa1,pb1,pc1)
       { exp(-0.5*((t(PRECIP+pc1*FLOW*PRECIP)-pa1)/pb1)^2))"
Execution halted
